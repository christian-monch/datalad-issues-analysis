{"url": "https://api.github.com/repos/datalad/datalad/issues/2186", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2186/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2186/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2186/events", "html_url": "https://github.com/datalad/datalad/issues/2186", "id": 297852822, "node_id": "MDU6SXNzdWUyOTc4NTI4MjI=", "number": 2186, "title": "datalad publish does not initialize submodule upon publishing recursively", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-16T16:57:09Z", "updated_at": "2018-02-16T17:01:59Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\nThat might be one of the issues leading to non-initialized submodules/subdatasets (ref: #2184, #2171)\r\n\r\n#### What steps will reproduce the problem?\r\n\r\n```shell\r\n$> datalad create-test-dataset --spec 2 testds  \r\n[INFO   ] Generating repo of class <class 'datalad.support.annexrepo.AnnexRepo'> under /tmp/testds \r\n                                                                                                                                                        [INFO   ] Generating repo of class <class 'datalad.support.gitrepo.GitRepo'> under /tmp/testds/d0/d1/d2/r0 \r\n                                                                                                                                                        [INFO   ] Generating repo of class <class 'datalad.support.annexrepo.AnnexRepo'> under /tmp/testds/d0/d1/d2/r1 \r\n3 installed items are available at                                                                                                                      \r\n/tmp/testds\r\n/tmp/testds/d0/d1/d2/r0\r\n/tmp/testds/d0/d1/d2/r1\r\n\r\n$> cd testds\r\nd0/  file562.dat\r\n\r\n$> datalad create-sibling -s published -r localhost:/tmp/testds-published        \r\n[INFO   ] Connecting ... \r\n[INFO   ] Considering to create a target dataset /tmp/testds at /tmp/testds-published of localhost \r\n[INFO   ] Updating dataset '/tmp/testds' ... \r\n.: published(+) [localhost:/tmp/testds-published (git)]\r\n[INFO   ] Adjusting remote git configuration \r\n[INFO   ] Enabling git post-update hook ... \r\n[INFO   ] Considering to create a target dataset /tmp/testds/d0/d1/d2/r0 at /tmp/testds-published/d0/d1/d2/r0 of localhost \r\n[INFO   ] Updating dataset '/tmp/testds/d0/d1/d2/r0' ... \r\n.: published(?) [localhost:/tmp/testds-published/d0/d1/d2/r0 (git)]\r\n[INFO   ] Adjusting remote git configuration \r\n[INFO   ] Enabling git post-update hook ... \r\n[INFO   ] Considering to create a target dataset /tmp/testds/d0/d1/d2/r1 at /tmp/testds-published/d0/d1/d2/r1 of localhost \r\n[INFO   ] Updating dataset '/tmp/testds/d0/d1/d2/r1' ... \r\n.: published(+) [localhost:/tmp/testds-published/d0/d1/d2/r1 (git)]\r\n[INFO   ] Adjusting remote git configuration \r\n[INFO   ] Enabling git post-update hook ... \r\n[INFO   ] Running post-update hooks in all created siblings \r\ncreate_sibling(ok): d0/d1/d2/r1 (dataset)\r\ncreate_sibling(ok): d0/d1/d2/r0 (dataset)\r\ncreate_sibling(ok): . (dataset)\r\naction summary:\r\n  create_sibling (ok: 3)\r\n\r\n$> git -C /tmp/testds-published submodule status --recursive\r\n\r\n$> datalad publish --to published -r                                     \r\n[INFO   ] Publishing <Dataset path=/tmp/testds/d0/d1/d2/r1> to published \r\npublish(ok): d0/d1/d2/r1 (dataset) [pushed to published: ['f56c65d..515f7c8', '[new branch]']]\r\n[INFO   ] Publishing <Dataset path=/tmp/testds/d0/d1/d2/r0> to published \r\npublish(ok): d0/d1/d2/r0 (dataset) [pushed to published: ['[new branch]']]\r\n[INFO   ] Publishing <Dataset path=/tmp/testds> to published \r\npublish(ok): . (dataset) [pushed to published: ['31ddac0..859fbb5', '[new branch]']]\r\naction summary:\r\n  publish (ok: 3)\r\n\r\n$> git -C /tmp/testds-published submodule status --recursive\r\n-8dbf23f759bd9f8d6fb4177b301c18c147a75936 d0/d1/d2/r0\r\n-f96a346c5782b34fb2380e70daa37f3893f34bf1 d0/d1/d2/r1\r\n```\r\n\r\nThat explains uninitialized subdatasets on datasets.datalad.org and possibly some (but not all) on smaug (I probably published some into our collection from original location)\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad plugin wtf`)?\r\n\r\ncurrent bleeding edge master 0.9.1.dev1 ;-)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2186/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2186/timeline", "performed_via_github_app": null}