{"url": "https://api.github.com/repos/datalad/datalad/issues/1940", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1940/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1940/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1940/events", "html_url": "https://github.com/datalad/datalad/issues/1940", "id": 269634374, "node_id": "MDU6SXNzdWUyNjk2MzQzNzQ=", "number": 1940, "title": "datalad's getpwd vs os.getcwd", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-10-30T15:06:50Z", "updated_at": "2021-03-09T07:00:41Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nAwhile back we introduced `getpwd` with a hope to workaround the issue of `getcwd` dereferencing symlink'ed directories (actually IIRC not even knowing the symlinked path) by first checking 'PWD' env variable, and if set, returning that one (instead of os.getcwd).  We also complemented it with `chpwd` class/context manager for convenience.  Everything works very smooth as long as user stays with our `datalad.utils.chpwd` instead of `os.chdir`.  But ppl do not know about this aspect, and do use it rightfully so. See e.g. https://github.com/nipy/heudiconv/pull/101#issuecomment-340082059\r\n\r\nWhat should we do?\r\n- monkey patching os.chdir sounds evil and we could be late to the game anyways (if someone `from os import chdir` first before importing datalad\r\n- ???\r\n\r\nFor users we could \r\n- instruct to use our `chpwd`\r\n- provide full paths when installing if they cd'ed somewhere\r\n\r\nbut all of the above sounds very suboptimal...", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1940/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1940/timeline", "performed_via_github_app": null}