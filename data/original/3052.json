{"url": "https://api.github.com/repos/datalad/datalad/issues/3052", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3052/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3052/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3052/events", "html_url": "https://github.com/datalad/datalad/issues/3052", "id": 387075269, "node_id": "MDU6SXNzdWUzODcwNzUyNjk=", "number": 3052, "title": "test_run_procedure.py:test_invalid_call  tries to sense my precious code git repo", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-12-04T01:11:18Z", "updated_at": "2019-01-28T23:45:08Z", "closed_at": "2019-01-28T23:45:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Similarly to the issue @kyleam fixed recently for download_url, it seems other functionality/tests sample current repo and blow whenever the absent support (thanks! ;)) for worktrees kicks in:\r\n\r\n```shell\r\n$> venvs/dev/bin/python -m nose -s -v datalad/interface/tests/test_run_procedure.py:test_invalid_call\r\ndatalad.interface.tests.test_run_procedure.test_invalid_call ... ERROR\r\nVersions: appdirs=1.4.3 boto=2.44.0 cmd:annex=7.20181121+git58-gbc4aa3f0e-1~ndall+1 cmd:git=2.19.2 cmd:system-git=2.19.1 cmd:system-ssh=7.6p1 exifread=2.1.2 git=git gitdb=2.0.3 humanize=0.5.1 iso8601=0.1.11 keyring=16.0.0 keyrings.alt=3.1 msgpack=0.5.6 mutagen=1.40.0 requests=2.18.4 scrapy=1.5.0 six=1.11.0 tqdm=4.19.5 wrapt=1.9.0\r\nObscure filename: str= \"';a&b&c\u0394\u0419\u05e7\u0645\u0e57\u3042 `|  repr=u' \"\\';a&b&c\\u0394\\u0419\\u05e7\\u0645\\u0e57\\u3042 `| '\r\nEncodings: default='ascii' filesystem='UTF-8' locale.prefered='UTF-8'\r\nEnvironment: GIT_PYTHON_GIT_EXECUTABLE='/usr/lib/git-annex.linux/git' LANG='en_US.utf8' GIT_PAGER='less --no-init --quit-if-one-screen' PATH='/home/yoh/proj/datalad/datalad-master/venvs/dev3/bin:/home/yoh/gocode/bin:/home/yoh/gocode/bin:/home/yoh/bin:/home/yoh/.local/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/snap/bin:/sbin:/usr/sbin:/usr/local/sbin'\r\n\r\n======================================================================\r\nERROR: datalad.interface.tests.test_run_procedure.test_invalid_call\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/tests/test_run_procedure.py\", line 39, in test_invalid_call\r\n    res = run_procedure('unknown', on_failure='ignore')\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 479, in eval_func\r\n    return return_func(generator_func)(*args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 467, in return_func\r\n    results = list(results)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 422, in generator_func\r\n    result_renderer, result_xfm, _result_filter, **_kwargs):\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 509, in _process_results\r\n    for res in results:\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/run_procedure.py\", line 395, in __call__\r\n    next(_get_procedure_implementation(name, ds=ds))\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/run_procedure.py\", line 128, in _get_procedure_implementation\r\n    ds.config.obtain('datalad.locations.dataset-procedures'))\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/distribution/dataset.py\", line 315, in config\r\n    if self.repo is None:\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/distribution/dataset.py\", line 235, in repo\r\n    self._repo.is_with_annex():\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/gitrepo.py\", line 968, in is_with_annex\r\n    for b in self.get_remote_branches())) or \\\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/gitrepo.py\", line 1559, in get_remote_branches\r\n    for remote in self.repo.remotes:\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/gitrepo.py\", line 747, in repo\r\n    self._repo = self.cmd_call_wrapper(Repo, self.path)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/cmd.py\", line 189, in __call__\r\n    return self.call(cmd, *args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/cmd.py\", line 570, in call\r\n    return f(*args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/gitrepo.py\", line 403, in Repo\r\n    return gitpy.Repo(*args, **kwargs)\r\n  File \"/home/yoh/deb/gits/python-git/git/repo/base.py\", line 147, in __init__\r\n    sm_gitpath = find_submodule_git_dir(dotgit)\r\n  File \"/home/yoh/deb/gits/python-git/git/repo/fun.py\", line 72, in find_submodule_git_dir\r\n    if is_git_dir(d):\r\n  File \"/home/yoh/deb/gits/python-git/git/repo/fun.py\", line 47, in is_git_dir\r\n    raise WorkTreeRepositoryUnsupported(d)\r\nWorkTreeRepositoryUnsupported: /home/yoh/proj/datalad/datalad-master/.git\r\n-------------------- >> begin captured logging << --------------------\r\ndatalad.utils: Level 5: Importing datalad.utils\r\ndatalad.utils: DEBUG: Maximal length of cmdline string (adjusted for safety margin): 1048576\r\ndatalad.utils: Level 5: Done importing datalad.utils\r\ndatalad.cmd: Level 9: Will use git under '/usr/lib/git-annex.linux' (no adjustments to PATH if empty string)\r\ndatalad.cmd: Level 9: Running: ['git', 'version']\r\ndatalad.cmd: Level 8: Finished running ['git', 'version'] with status 0\r\ndatalad.cmd: Level 9: Running: ['git', 'config', '-z', '-l', '--show-origin']\r\ndatalad.cmd: Level 8: Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0\r\ndatalad.ui: Level 5: Starting importing ui\r\ndatalad.ui.dialog: Level 5: Starting importing ui.dialog\r\ndatalad.ui.dialog: Level 5: Done importing ui.dialog\r\ndatalad.ui: Level 5: Initiating UI switcher\r\ndatalad.ui: DEBUG: UI set to DialogUI(out=<file>)\r\ndatalad.ui: Level 5: Done importing ui\r\n--------------------- >> end captured logging << ---------------------\r\n\r\n```", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3052/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3052/timeline", "performed_via_github_app": null}