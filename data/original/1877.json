{"url": "https://api.github.com/repos/datalad/datalad/issues/1877", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1877/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1877/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1877/events", "html_url": "https://github.com/datalad/datalad/issues/1877", "id": 263167533, "node_id": "MDU6SXNzdWUyNjMxNjc1MzM=", "number": 1877, "title": "datalad save -d subds -S manages to save its top dataset where it is not even registered", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-05T15:25:18Z", "updated_at": "2019-05-15T06:55:52Z", "closed_at": "2019-05-15T06:55:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "so, running this in /tmp\r\n```shell\r\n$> datalad create 123; datalad create 123/subds; cd 123/subds; touch 1; git add 1; builtin cd ../; datalad save -d subds -S -m savingunder; git log; git status                                                                                                                                                 [INFO   ] Creating a new annex repo at /tmp/123 \r\ncreate(ok): /tmp/123 (dataset)                                                                                                                          \r\n[INFO   ] Creating a new annex repo at /tmp/123/subds \r\ncreate(ok): /tmp/123/subds (dataset)                                                                                                                    \r\nsave(ok): /tmp/123/subds (dataset)\r\nsave(notneeded): /tmp/123 (dataset)\r\naction summary:\r\n  save (notneeded: 1, ok: 1)\r\ncommit 78aa4de1ae9e737e5f9cba41a36777753afb1107 (HEAD -> master)\r\nAuthor: Yaroslav Halchenko <debian@onerussian.com>\r\nDate:   Thu Oct 5 11:17:22 2017 -0400\r\n\r\n    [DATALAD] new dataset\r\n\r\ncommit b917f2b9a6980b29d4507a5887ef5c4372c1ffe6\r\nAuthor: Yaroslav Halchenko <debian@onerussian.com>\r\nDate:   Thu Oct 5 11:17:22 2017 -0400\r\n\r\n    [DATALAD] Set default backend for all files to be MD5E\r\nOn branch master\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n\r\n\tsubds/\r\n```\r\neverything is kosher -- subds isn't added etc.   But then if I run it again while under 123, some weird stuff happens -- that 123/123 does get saved (although shouldn't since it doesn't have 123/subds registered) and git log --stat within 123/123 reports tracking subds/'s content!\r\n\r\n```\r\n(git-annex)hopa:/tmp/123/123[master]git-annex\r\n$> git log --stat\r\ncommit c82e8c26e282bf214a6e9dc7ddf7ca18c8b5189e (HEAD -> master)\r\nAuthor: Yaroslav Halchenko <debian@onerussian.com>\r\nDate:   Thu Oct 5 11:21:44 2017 -0400\r\n\r\n    saveingunder\r\n\r\n subds/.datalad/.gitattributes | 3 +++\r\n subds/.datalad/config         | 2 ++\r\n subds/.gitattributes          | 1 +\r\n subds/1                       | 0\r\n 4 files changed, 6 insertions(+)\r\n```", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1877/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1877/timeline", "performed_via_github_app": null}