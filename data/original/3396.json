{"url": "https://api.github.com/repos/datalad/datalad/issues/3396", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3396/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3396/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3396/events", "html_url": "https://github.com/datalad/datalad/pull/3396", "id": 441441963, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc2NzY4NDI5", "number": 3396, "title": "Make progress bar \"backend\" configurable, use the \"log\" one during tests", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/60", "html_url": "https://github.com/datalad/datalad/milestone/60", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/60/labels", "id": 4073134, "node_id": "MDk6TWlsZXN0b25lNDA3MzEzNA==", "number": 60, "title": "0.11.x", "description": "To collect issues/PRs targetting 0.11.x development line", "creator": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 27, "state": "closed", "created_at": "2019-02-20T15:10:42Z", "updated_at": "2020-03-06T19:55:16Z", "due_on": null, "closed_at": "2020-03-06T19:55:16Z"}, "comments": 8, "created_at": "2019-05-07T20:54:36Z", "updated_at": "2019-06-03T22:56:18Z", "closed_at": "2019-05-13T14:54:21Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/3396", "html_url": "https://github.com/datalad/datalad/pull/3396", "diff_url": "https://github.com/datalad/datalad/pull/3396.diff", "patch_url": "https://github.com/datalad/datalad/pull/3396.patch"}, "body": "Closes #3393\r\n\r\nAdds `LogProgressBar` which logs completion (possibly partial) for the item.\r\n\r\n<details>\r\n<summary>Here are examples on how reporting looks like with `log` with some being interrupted or completed fully</summary>\r\n\r\n```shell\r\n$> sudo rm -rf QA simon ds00* face_place dartmouth-phantoms; DATALAD_UI_PROGRESSBAR=log datalad install -g ///openfmri/ds000105\r\n[INFO   ] Cloning http://datasets.datalad.org/openfmri/ds000105 [1 other candidates] into '/tmp/ds000105' \r\n[INFO   ]  Cloning (counting objects) 100 objects done in 0 sec at 1880853 objects/sec \r\n[INFO   ]  Cloning (compressing objects) 68466 objects done in 0.001 sec at 52508176 objects/sec \r\n[INFO   ]  Cloning (receiving objects) 152614 objects done in 6 seconds at 25248 objects/sec \r\n[INFO   ]  Cloning (resolving stuff) 80063 objects done in 0.003 sec at 23785845 objects/sec \r\n[INFO   ] access to dataset sibling \"datalad\" not auto-enabled, enable with:\r\n| \t\tdatalad siblings -d \"/tmp/ds000105\" enable -s datalad \r\ninstall(ok): /tmp/ds000105 (dataset)\r\n[INFO   ]  derivatives/mriqc/anatomical_sub-3.pdf 63.2 kB done in 0.172 sec at 366.9 kB/sec \r\n[INFO   ]  derivatives/mriqc/anatomical_sub-4.pdf 63.5 kB done in 0.13 sec at 490.0 kB/sec \r\n[INFO   ]  derivatives/mriqc/functional_group.pdf 182.8 kB done in 0.045 sec at 4.1 MB/sec \r\n[INFO   ]  derivatives/mriqc/funcMRIQC.csv 29.0 kB done in 0.198 sec at 146.6 kB/sec \r\n^C[WARNING] Still have 4 active progress bars when stopping \r\n[INFO   ]  Total partially (1.38% of 1.9 GB) done in 17 seconds at 1.5 MB/sec \r\n[INFO   ]  sub-1/anat/sub-1_T1w.nii.gz partially (84.71% of 6.0 MB) done in 15 seconds at 319.8 kB/sec \r\n[INFO   ]  sub-1/func/sub-1_task-objectviewing_run-02_bold.nii.gz partially (22.58% of 25.8 MB) done in 15 seconds at 373.5 kB/sec \r\n[INFO   ]  sub-1/func/sub-1_task-objectviewing_run-01_bold.nii.gz partially (28.36% of 25.7 MB) done in 15 seconds at 478.3 kB/sec \r\n[INFO   ]  sub-1/func/sub-1_task-objectviewing_run-03_bold.nii.gz partially (24.89% of 25.8 MB) done in 14 seconds at 428.5 kB/sec \r\nERROR: \r\nInterrupted by user while doing magic: KeyboardInterrupt() [cmd.py:_process_one_line:358]\r\nDATALAD_UI_PROGRESSBAR=log datalad install -g ///openfmri/ds000105  6.27s user 2.08s system 24% cpu 34.728 total\r\n\r\n$> sudo rm -rf QA simon dartmouth-phantoms velasco; DATALAD_UI_PROGRESSBAR=log datalad install -g ///labs/tarr/face_place      \r\n[INFO   ] Cloning http://datasets.datalad.org/labs/tarr/face_place [1 other candidates] into '/tmp/face_place' \r\n[INFO   ]  Cloning (counting objects) 100 objects done in 0 sec at 2853268 objects/sec \r\n[INFO   ]  Cloning (compressing objects) 28649 objects done in 0.001 sec at 38002092 objects/sec \r\n[INFO   ]  Cloning (receiving objects) 31593 objects done in 1.418 sec at 22275 objects/sec \r\n[INFO   ]  Cloning (resolving stuff) 387 objects done in 0.003 sec at 137477 objects/sec \r\ninstall(ok): /tmp/face_place (dataset)\r\n[INFO   ] To obtain some keys we need to fetch an archive of size 42.5 MB \r\n[INFO   ]  MD5E-s42453590--70418661c05ac77945454b58f7a02789.zip 42.5 MB done in 32 seconds at 1.3 MB/sec \r\n[INFO   ] To obtain some keys we need to fetch an archive of size 28.8 MB \r\n^C[WARNING] Still have 1 active progress bars when stopping \r\n[INFO   ]  Total possibly partially done in 46 seconds at 1.3 MB/sec \r\n[INFO   ]  MD5E-s28831000--2d7e46964c86637e36c26745b8455aea.zip partially (28.79% of 28.8 MB) done in 6 seconds at 1.2 MB/sec \r\nERROR: \r\nInterrupted by user while doing magic: KeyboardInterrupt() [cmd.py:_process_one_line:358]\r\nDATALAD_UI_PROGRESSBAR=log datalad install -g ///labs/tarr/face_place  10.14s user 2.26s system 20% cpu 1:00.97 total\r\n\r\n$> sudo rm -rf QA simon dartmouth-phantoms velasco; DATALAD_UI_PROGRESSBAR=log datalad install -g ///labs/tarr/face_place\r\n[INFO   ] To obtain some keys we need to fetch an archive of size 28.8 MB \r\n[INFO   ]  MD5E-s28831000--2d7e46964c86637e36c26745b8455aea.zip 28.8 MB done in 14 seconds at 2.0 MB/sec \r\n[INFO   ] To obtain some keys we need to fetch an archive of size 118.2 MB \r\n[INFO   ]  MD5E-s118229974--970c5c314ec41a2950e98aeefb2faf44.zip 118.2 MB done in a minute at 1.1 MB/sec \r\n[INFO   ] To obtain some keys we need to fetch an archive of size 16.7 MB \r\n[INFO   ]  MD5E-s16663731--4735c5882fd6736c1b0829c428a40503.zip 16.7 MB done in 11 seconds at 1.4 MB/sec \r\n[INFO   ] To obtain some keys we need to fetch an archive of size 16.3 MB \r\n[INFO   ]  MD5E-s16251761--d049c7c7316b38e847833f574a1ba2ad.zip 16.3 MB done in 13 seconds at 1.2 MB/sec \r\n[INFO   ]  Total 40.8 MB done in 2 minutes at 233.6 kB/sec \r\naction summary:\r\n  get (ok: 5290)\r\n  install (notneeded: 1)\r\nDATALAD_UI_PROGRESSBAR=log datalad install -g ///labs/tarr/face_place  69.89s user 21.58s system 50% cpu 3:02.77 total\r\n```\r\n</details>\r\n\r\nIdeally should have dedicated test(s) but not sure if I would have juice for that ATM, but let's see if some bugs get revealed by just using it through the tests", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3396/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3396/timeline", "performed_via_github_app": null}