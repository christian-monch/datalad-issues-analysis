{"url": "https://api.github.com/repos/datalad/datalad/issues/5327", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5327/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5327/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5327/events", "html_url": "https://github.com/datalad/datalad/issues/5327", "id": 785328971, "node_id": "MDU6SXNzdWU3ODUzMjg5NzE=", "number": 5327, "title": "update -d . --recursive --follow parentds --merge ff-only  generates recursive merge commits", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}, {"id": 2767213993, "node_id": "MDU6TGFiZWwyNzY3MjEzOTkz", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-update", "name": "cmd-update", "color": "FEF2C0", "default": false, "description": "Issues relates to update functionality"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-01-13T18:16:33Z", "updated_at": "2021-02-23T23:32:25Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nThe idea behind `--follow parentds --merge ff-only ` tandem was to provide update mechanism which would just follow \"upstream\" without introducing any local commits. \r\n\r\n#### What steps will reproduce the problem?\r\n\r\n I have neither pinned down nor managed to produce reproducer for this, but it is happening for me with http://github.com/CONP-PCNO/conp-dataset  which I try to \"mirror\" to http://datasets.datalad.org/?dir=/conp-dataset .\r\n\r\nSo for now I am just making a record of the \"discovery\" that even with such invocation I do manage ending up with such commits\r\n\r\n```\r\n$> git show --stat 348003c \r\ncommit 348003c2183b122a024c8477f2fc71788a795074 (HEAD -> master)\r\nMerge: f1aea15 f425f14\r\nAuthor: Yaroslav Halchenko <debian@onerussian.com>\r\nDate:   Wed Jan 13 12:46:24 2021 -0500\r\n\r\n    Merge branch 'refs/heads/synced/master'\r\n    \r\n    * refs/heads/synced/master:\r\n      [DATALAD] Save updated subdatasets\r\n\r\n projects/PERFORM_Dataset__one_control_subject | 2 +-\r\n 1 file changed, 1 insertion(+), 1 deletion(-)\r\n```\r\n\r\n```\r\n$> git diff 348003c^..348003c\r\ndiff --git a/projects/PERFORM_Dataset__one_control_subject b/projects/PERFORM_Dataset__one_control_subject\r\nindex 972b3bb..81af795 160000\r\n--- a/projects/PERFORM_Dataset__one_control_subject\r\n+++ b/projects/PERFORM_Dataset__one_control_subject\r\n@@ -1 +1 @@\r\n-Subproject commit 972b3bb8beaf4ea6417f44d0c2cefb52ac451384\r\n+Subproject commit 81af795fe2d1d24f940cfb5817956a6602af1b8a\r\n```\r\n\r\n<details>\r\n<summary>and this attempted reproducer does not reproduce it</summary> \r\n\r\n```shell\r\n#!/bin/bash\r\n\r\nexport PS4='> '\r\n\r\nset -eu\r\ncd \"$(mktemp -d ${TMPDIR:-/tmp}/dl-XXXXXXX)\"\r\ntopd=`pwd`\r\n\r\ndatalad install http://github.com/CONP-PCNO/conp-dataset\r\n(\r\ncd conp-dataset\r\ndatalad install projects/PERFORM_Dataset__one_control_subject\r\ndatalad update --recursive --follow parentds --merge ff-only\r\n\r\ngit show\r\n)\r\n```\r\n</details>\r\n\r\nso need to analyze more\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\n\r\nstill 0.13.5 in that env, but I have not spotted `update` being mentioned since then in CHANGELOG\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5327/timeline", "performed_via_github_app": null}