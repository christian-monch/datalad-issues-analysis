{"url": "https://api.github.com/repos/datalad/datalad/issues/2807", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2807/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2807/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2807/events", "html_url": "https://github.com/datalad/datalad/issues/2807", "id": 358304691, "node_id": "MDU6SXNzdWUzNTgzMDQ2OTE=", "number": 2807, "title": "Query flyweight collection of repos to precommit them while rmtree", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 188141023, "node_id": "MDU6TGFiZWwxODgxNDEwMjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/platform-windows", "name": "platform-windows", "color": "0052cc", "default": false, "description": "Issue concerned with Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-08T15:28:24Z", "updated_at": "2020-10-08T17:17:46Z", "closed_at": "2020-10-05T08:44:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As noted also in the comment within the code: https://github.com/datalad/datalad/pull/2806/files#diff-31ee38bd569c9911a55587f967c2828bR329\r\n\r\nThis problem arises on Windows while frequently creating and removing temporary repositories.  There could remain some batch processes lingering around ran from the repository directory, and that causes Windows to become unhappy.  For now it is resolved by ad-hoc execution of `.precommit` within the tests where necessary, but ideally IMHO we should get some \"registry\" of used repositories probably as a weakref dictionary, which gets populated by our flyweight repo constructor, so `rmtree` could verify that the path to be removed does not contain any of them, and if it does, call its `.precommit`\r\n\r\n", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2807/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2807/timeline", "performed_via_github_app": null}