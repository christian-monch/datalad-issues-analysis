{"url": "https://api.github.com/repos/datalad/datalad/issues/3953", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3953/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3953/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3953/events", "html_url": "https://github.com/datalad/datalad/issues/3953", "id": 541184624, "node_id": "MDU6SXNzdWU1NDExODQ2MjQ=", "number": 3953, "title": "Silent failures due to interaction between custom_result_renderer() and log.result-level", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390153891, "node_id": "MDU6TGFiZWwzOTAxNTM4OTE=", "url": "https://api.github.com/repos/datalad/datalad/labels/UX", "name": "UX", "color": "0052cc", "default": false, "description": "user experience"}, {"id": 1782622781, "node_id": "MDU6TGFiZWwxNzgyNjIyNzgx", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-important", "name": "severity-important", "color": "cc0000", "default": false, "description": "major effect on the usability of a package, without rendering it completely unusable to everyone"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-20T20:27:13Z", "updated_at": "2020-01-12T11:19:39Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Some of our `custom_result_renderer` definitions return early if a `status` other than \"ok\" is encountered.  For example, here's the beginning of the `RunProcedure.custom_result_renderer`:\r\n\r\nhttps://github.com/datalad/datalad/blob/b1f33d17bd2630bf202dcf584d94acb9670c6cd1/datalad/interface/run_procedure.py#L468-L474\r\n\r\nAs the comment suggests, these checks exist to avoid double reporting of errors and warnings, things like\r\n\r\n```\r\n$ datalad run-procedure not-there\r\n[WARNING] Cannot find procedure with name 'not-there' [run_procedure(not-there)]\r\nrun_procedure(impossible): not-there [Cannot find procedure with name 'not-there']\r\n```\r\n\r\nIn response to the same double reporting concern, 60d088feb (ENH: Introduce datalad.log.result-level config switch, 2019-10-06) made it easy to demote the logging messages.  While both the `custom_result_renderer` check and `log.result-level` seem fine enough on their own, they can squelch all messages when combined.  To continue with `run_procedure` as an example, running\r\n\r\n```sh\r\n#!/bin/sh\r\nset -eu\r\ncd \"$(mktemp -d --tmpdir dl-XXXXXXX)\"\r\ndatalad create >/dev/null 2>&1\r\n\r\ngit config datalad.log.result-level debug\r\ndatalad run-procedure not-there\r\n```\r\n\r\nleads to no log message being shown and no result being rendered.\r\n\r\nWith the introduction of `log.result-level`, we should revisit these `custom_result_renderer` checks.\r\n\r\n---\r\n\r\nBased on some quick grepping, here's a list of commands with a `custom_result_renderer` that returns early when given a status other than \"ok\":\r\n\r\n- `metadata`\r\n- `run_procedure`\r\n- `siblings`\r\n- `status` (also used by `diff`)\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3953/timeline", "performed_via_github_app": null}