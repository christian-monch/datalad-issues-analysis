{"url": "https://api.github.com/repos/datalad/datalad/issues/5070", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5070/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5070/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5070/events", "html_url": "https://github.com/datalad/datalad/pull/5070", "id": 727392222, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA4MjkzNjMz", "number": 5070, "title": "OPT+BF: annotate read_only git/annex invocations, thread lock read-write git/annex and git-config invocations", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 289240596, "node_id": "MDU6TGFiZWwyODkyNDA1OTY=", "url": "https://api.github.com/repos/datalad/datalad/labels/performance", "name": "performance", "color": "f4b2d8", "default": false, "description": "Improve performance of an existing feature"}, {"id": 379953235, "node_id": "MDU6TGFiZWwzNzk5NTMyMzU=", "url": "https://api.github.com/repos/datalad/datalad/labels/do-in-parallel", "name": "do-in-parallel", "color": "ffda63", "default": false, "description": ""}, {"id": 1746781627, "node_id": "MDU6TGFiZWwxNzQ2NzgxNjI3", "url": "https://api.github.com/repos/datalad/datalad/labels/merge-if-ok", "name": "merge-if-ok", "color": "fbca04", "default": false, "description": "OP considers this work done, and requests review/merge"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/75", "html_url": "https://github.com/datalad/datalad/milestone/75", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/75/labels", "id": 5395092, "node_id": "MDk6TWlsZXN0b25lNTM5NTA5Mg==", "number": 75, "title": "0.14.0", "description": "", "creator": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 31, "state": "closed", "created_at": "2020-05-07T17:48:31Z", "updated_at": "2021-08-05T15:29:32Z", "due_on": null, "closed_at": "2021-08-05T15:29:32Z"}, "comments": 29, "created_at": "2020-10-22T13:30:41Z", "updated_at": "2020-12-04T14:35:51Z", "closed_at": "2020-12-03T16:58:42Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5070", "html_url": "https://github.com/datalad/datalad/pull/5070", "diff_url": "https://github.com/datalad/datalad/pull/5070.diff", "patch_url": "https://github.com/datalad/datalad/pull/5070.patch"}, "body": "old description which got it going:  While looking at py-spy stack from long running status I noticed that majority\r\nof time is spent on git config call, triggered by checking for fake dates\r\nconfig setting. AFAIK for read-only operations, which cannot produce a commit,\r\nit might benefit to skip that check. And _call_git already has that kwarg,\r\nbut it is not proxied by \"higher-level\" helpers.  To avoid breeding workarounds\r\n(like the one RFed within this commit) I decided that we might benefit from\r\nexposing that option in higher-level helpers as well. Then \"read-only\" invocations could set it to False and we might avoid needless  config read in some cases (I have not done any timing on any prototypical use case which might benefit from this, but I would assume that status or diff might).\r\n\r\nWhat is in the PR\r\n- RF to make possible to make \"lean\" `call_git` read only invocations which would not even read config since not needed\r\n- BF add thread locking non-read-only invocations of git/annex -- in `GitRepo.call_git` and `ConfigManager._run`.  That closes #5131 .  Now you can really animate your terminals with something like `datalad install -r -J50 /// ` ;-)", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5070/timeline", "performed_via_github_app": null}