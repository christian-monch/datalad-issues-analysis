{"url": "https://api.github.com/repos/datalad/datalad/issues/2841", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2841/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2841/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2841/events", "html_url": "https://github.com/datalad/datalad/issues/2841", "id": 361109430, "node_id": "MDU6SXNzdWUzNjExMDk0MzA=", "number": 2841, "title": "subdataset's children record is not aggregated into superdataset's", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 700886055, "node_id": "MDU6TGFiZWw3MDA4ODYwNTU=", "url": "https://api.github.com/repos/datalad/datalad/labels/metadata", "name": "metadata", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-18T02:14:03Z", "updated_at": "2018-11-27T03:26:37Z", "closed_at": "2018-11-27T03:26:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\nI am trying to aggregate metadata for a freshly added physionet.  When I am attempting to aggregate physinet subdataset's metadata it doesn't include physionet's subdataset's (`eegmmidb`) metadata:\r\n\r\n```shell\r\n(git)smaug:/mnt/btrfs/datasets/datalad/crawl[master]\r\n$> datalad aggregate-metadata --update-mode all --incremental physionet\r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/physionet \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl \r\n[INFO   ] Update aggregate metadata in dataset at: /mnt/btrfs/datasets/datalad/crawl/physionet \r\naggregate_metadata(ok): /mnt/btrfs/datasets/datalad/crawl/physionet (dataset)\r\n[INFO   ] Update aggregate metadata in dataset at: /mnt/btrfs/datasets/datalad/crawl \r\naggregate_metadata(ok): /mnt/btrfs/datasets/datalad/crawl (dataset)\r\n[INFO   ] Attempting to save 1058 files/datasets \r\nsave(notneeded): /mnt/btrfs/datasets/datalad/crawl/physionet (dataset)\r\nsave(notneeded): /mnt/btrfs/datasets/datalad/crawl (dataset)\r\naction summary:\r\n  aggregate_metadata (ok: 2)\r\n  save (notneeded: 2)\r\ndatalad aggregate-metadata --update-mode all --incremental physionet  15.82s user 32.13s system 130% cpu 36.641 total\r\n(dev) 1 12262.....................................:Mon 17 Sep 2018 10:08:58 PM EDT:.\r\n(git)smaug:/mnt/btrfs/datasets/datalad/crawl[master]\r\n$> cat physionet/.datalad/metadata/aggregate_v1.json \r\n{\r\n\".\":\r\n{\r\n\"content_info\":\r\n\"objects/99/cn-07e4520ee3f835ced0b044bb9baf2f.xz\",\r\n\"datalad_version\":\r\n\"0.10.2.dev243\",\r\n\"dataset_info\":\r\n\"objects/99/ds-07e4520ee3f835ced0b044bb9baf2f\",\r\n\"extractors\":\r\n[\r\n\"datalad_core\",\r\n\"annex\"\r\n],\r\n\"id\":\r\n\"42dbd700-ba9c-11e8-86a9-002590f97d84\",\r\n\"refcommit\":\r\n\"91cbd9eba120d21c7fbfafe6ae8543dcf4f38b74\"\r\n},\r\n\"eegmmidb\":\r\n{\r\n\"content_info\":\r\n\"objects/27/cn-77b6ef3ca7dfa82a1650867317dd2f.xz\",\r\n\"datalad_version\":\r\n\"0.10.2.dev243\",\r\n\"dataset_info\":\r\n\"objects/27/ds-77b6ef3ca7dfa82a1650867317dd2f\",\r\n\"extractors\":\r\n[\r\n\"datalad_core\",\r\n\"annex\"\r\n],\r\n\"id\":\r\n\"fd406800-ba96-11e8-86a0-002590f97d84\",\r\n\"refcommit\":\r\n\"35131e32d0ac795211b440cdd336deaa14ce7711\"\r\n}\r\n}%                                                                                                              (dev) 1 12263.....................................:Mon 17 Sep 2018 10:09:17 PM EDT:.\r\n(git)smaug:/mnt/btrfs/datasets/datalad/crawl[master]\r\n$> grep physionet .datalad/metadata/aggregate_v1.json         \r\n\"physionet\":\r\n\r\n$> datalad --version\r\ndatalad 0.10.2.dev243\r\n\r\n```\r\nand if I add `--recursive` flag  - it starts going through all subdatasets of the root superdataset, even though I've provided physionet as the argument, so assumed it would be only that one recursed:\r\n```shell\r\n$> datalad aggregate-metadata --update-mode all --incremental -r physionet\r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/physionet \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/physionet/eegmmidb \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/abide \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/abide/Derivatives \r\n[INFO   ] Aggregate metadata for dataset /mnt/btrfs/datasets/datalad/crawl/abide/Derivatives/ccs_nofilt_global \r\n^C\r\n````", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2841/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2841/timeline", "performed_via_github_app": null}