{"url": "https://api.github.com/repos/datalad/datalad/issues/1862", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1862/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1862/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1862/events", "html_url": "https://github.com/datalad/datalad/issues/1862", "id": 261533475, "node_id": "MDU6SXNzdWUyNjE1MzM0NzU=", "number": 1862, "title": "Remove/uninstall not working on madness dataset", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-09-29T05:12:57Z", "updated_at": "2019-10-01T11:23:08Z", "closed_at": "2019-10-01T11:23:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Had no chance to investigate yet, but the dirty copy of our dataset that I was given is a though riddle...\r\n```\r\nmih@smaug ~/fullcopy/abide (git)-[master] % ls\r\nDerivatives/  PhenotypicData/  RawData/  RawDataBIDS/  Resources/\r\nmih@smaug ~/fullcopy/abide (git)-[master] % rm Derivatives\r\nrm: cannot remove 'Derivatives': Is a directory\r\n1 mih@smaug ~/fullcopy/abide (git)-[master] % rmdir Derivatives\r\nrmdir: failed to remove 'Derivatives': Directory not empty\r\n1 mih@smaug ~/fullcopy/abide (git)-[master] % datalad remove -d Derivatives\r\nremove(notneeded): .\r\nmih@smaug ~/fullcopy/abide (git)-[master] % ls\r\nDerivatives/  PhenotypicData/  RawData/  RawDataBIDS/  Resources/\r\nmih@smaug ~/fullcopy/abide (git)-[master] % ls -l Derivatives\r\ntotal 0\r\ndrwx--S--- 1 mih datalad 8 Sep 29 01:08 ccs_nofilt_global/\r\ndrwx--S--- 1 mih datalad 8 Sep 29 01:08 cpac_nofilt_global/\r\nmih@smaug ~/fullcopy/abide (git)-[master] % datalad remove -d Derivatives -r\r\nremove(notneeded): .\r\nmih@smaug ~/fullcopy (git)-[master] % datalad uninstall princeton-dataspace --nocheck\r\nuninstall(impossible): /home/mih/fullcopy/princeton-dataspace (directory) [can only uninstall datasets (consider the `drop` command)]\r\n1 mih@smaug ~/fullcopy (git)-[master] % datalad uninstall princeton-dataspace --nocheck -r\r\nuninstall(impossible): /home/mih/fullcopy/princeton-dataspace (directory) [can only uninstall datasets (consider the `drop` command)]\r\n\r\ndatalad uninstall princeton-dataspace --nocheck -r  6.00s user 2.16s system 102% cpu 7.984 total\r\n1 mih@smaug ~/fullcopy (git)-[master] % \r\n1 mih@smaug ~/fullcopy (git)-[master] % ls\r\nabide/    crcns/            devel/   hbnssi/  labs/        openfmri/\r\nadhd200/  datapackage.json  dicoms/  indi/    neurovault/  princeton-dataspace/\r\ncorr/     dbic/             hbn/     kaggle/  nidm/        workshops/\r\nmih@smaug ~/fullcopy (git)-[master] % datalad uninstall princeton-dataspace --nocheck -r\r\nuninstall(impossible): /home/mih/fullcopy/princeton-dataspace (directory) [can only uninstall datasets (consider the `drop` command)]\r\ndatalad uninstall princeton-dataspace --nocheck -r  5.98s user 2.24s system 102% cpu 8.052 total\r\n1 mih@smaug ~/fullcopy (git)-[master] % datalad uninstall -d princeton-dataspace --nocheck -r\r\n[ERROR  ] path not part of the reference dataset at /home/mih/fullcopy/princeton-dataspace [uninstall(/home/mih/fullcopy/princeton-dataspace)] \r\nuninstall(error): . (directory) [path not part of the reference dataset at /home/mih/fullcopy/princeton-dataspace]\r\n```\r\nAfter some playing around even Git is giving up. Not sure what forces created this dataset (pay attention to princeton-dataspace):\r\n\r\n```\r\nmih@smaug ~/fullcopy (git)-[master] % ls\r\nabide/    crcns/            devel/   hbnssi/  labs/        openfmri/\r\nadhd200/  datapackage.json  dicoms/  indi/    neurovault/  princeton-dataspace/\r\ncorr/     dbic/             hbn/     kaggle/  nidm/        workshops/\r\nmih@smaug ~/fullcopy (git)-[master] % git status\r\nOn branch master\r\nYour branch is ahead of 'datalad-public/master' by 5 commits.\r\n  (use \"git push\" to publish your local commits)\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n\r\n        abide/\r\n        hbn/\r\n\r\nnothing added to commit but untracked files present (use \"git add\" to track)\r\ngit status  1.94s user 3.60s system 154% cpu 3.593 total\r\nmih@smaug ~/fullcopy (git)-[master] % ls princeton-dataspace\r\nPrinceton_Neuroscience_Institute/\r\nmih@smaug ~/fullcopy (git)-[master] % datalad subdatasets\r\nsubdataset(ok): adhd200 (dataset)\r\nsubdataset(ok): corr (dataset)\r\nsubdataset(ok): crcns (dataset)\r\nsubdataset(ok): dbic (dataset)\r\nsubdataset(ok): devel (dataset)\r\nsubdataset(ok): dicoms (dataset)\r\nsubdataset(ok): hbnssi (dataset)\r\nsubdataset(ok): indi (dataset)\r\nsubdataset(ok): kaggle (dataset)\r\nsubdataset(ok): labs (dataset)\r\nsubdataset(ok): neurovault (dataset)\r\nsubdataset(ok): nidm (dataset)\r\nsubdataset(ok): openfmri (dataset)\r\nsubdataset(ok): workshops (dataset)\r\naction summary:\r\n  subdataset (ok: 14)\r\n```\r\n\r\nSo princeton-dataspace is not empty, not untracked, not a submodule (because not in .gitmodules). If datalad somehow managed to cause this mess (I don't see how it could have), we better prevent this.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1862/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1862/timeline", "performed_via_github_app": null}