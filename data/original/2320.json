{"url": "https://api.github.com/repos/datalad/datalad/issues/2320", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2320/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2320/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2320/events", "html_url": "https://github.com/datalad/datalad/issues/2320", "id": 306151694, "node_id": "MDU6SXNzdWUzMDYxNTE2OTQ=", "number": 2320, "title": "(Singularity) test failures due to configuration", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-17T12:12:11Z", "updated_at": "2020-04-29T02:51:27Z", "closed_at": "2020-04-29T02:51:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Only two failures remaining for me when testing todays singularity image. FTR:\r\n```\r\n======================================================================\r\nERROR: datalad.plugin.tests.test_metadata.test_error\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/tests/utils.py\", line 664, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/plugin/tests/test_metadata.py\", line 39, in test_error\r\n    files=[testpath])\r\n  File \"/usr/local/lib/python3.5/dist-packages/wrapt/wrappers.py\", line 523, in __call__\r\n    args, kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/interface/utils.py\", line 470, in eval_func\r\n    return return_func(generator_func)(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/wrapt/wrappers.py\", line 523, in __call__\r\n    args, kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/interface/utils.py\", line 458, in return_func\r\n    results = list(results)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/interface/utils.py\", line 414, in generator_func\r\n    result_renderer, result_xfm, _result_filter, **_kwargs):\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/interface/utils.py\", line 482, in _process_results\r\n    for res in results:\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/plugin/extract_metadata.py\", line 90, in __call__\r\n    paths=files)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/metadata/metadata.py\", line 443, in _get_metadata\r\n    package=extractors.__package__)\r\n  File \"/usr/lib/python3.5/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 986, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 969, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 956, in _find_and_load_unlocked\r\nImportError: No module named 'datalad.metadata.extractors.bogus__'\r\n\r\n======================================================================\r\nFAIL: datalad.tests.test_config.test_something\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/tests/utils.py\", line 494, in newfunc\r\n    return t(*(arg + (d,)), **kw)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/tests/utils.py\", line 664, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/usr/local/lib/python3.5/dist-packages/datalad/tests/test_config.py\", line 56, in test_something\r\n    assert_false(len(cfg))\r\nAssertionError: 1 is not false\r\n\r\n----------------------------------------------------------------------\r\nRan 857 tests in 3021.078s\r\n\r\nFAILED (SKIP=76, errors=1, failures=1)\r\ndatalad -c datalad.runtime.raiseonerror=yes test -v  635.89s user 1094.34s system 57% cpu 50:26.32 total\r\n```\r\n\r\nBoth are an artifact of me running it is `datalad -c datalad.runtime.raiseonerror=yes ...`, which clearly should make the cfg non empty, and also causes the test of a bogus extractor import to blow up and not just error calmly.\r\n\r\nSuggestions on how these tests could be made more robust? In general using to flag by default would help debugging test failures, as it will point to the true source of an issue.", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2320/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2320/timeline", "performed_via_github_app": null}