{"url": "https://api.github.com/repos/datalad/datalad/issues/3073", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3073/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3073/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3073/events", "html_url": "https://github.com/datalad/datalad/issues/3073", "id": 388663997, "node_id": "MDU6SXNzdWUzODg2NjM5OTc=", "number": 3073, "title": "RF? .git/ symlink \"support\"", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-07T13:53:51Z", "updated_at": "2020-01-15T13:59:20Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "We have been coming back to this topic and I failed to find a dedicated to it issue, so cannot remember all details now, thus decided to reincarnate the discussion and document all the pros/cons from either of the approaches\r\n\r\nSome known aspects:\r\n\r\n- We had been forcing subdatasets/submodules to have their own .git/ directory\r\n- git by default uses a .git file with `gitdir: superds/.git/modules/module`\r\n   - git doesn't even look for supers/module/.git when cloning recursively from http (try `git clone --recurse http://datasets.datalad.org/labs/gobbini/.git`)\r\n- git-annex, if finds gitdir file replaces it with a symlink (on linux at least, didn't check behavior on windows)\r\n\r\n... TODO...\r\n\r\nWith \r\n```patch\r\ndiff --git a/datalad/support/gitrepo.py b/datalad/support/gitrepo.py\r\nindex d86eb8d7..c458400d 100644\r\n--- a/datalad/support/gitrepo.py\r\n+++ b/datalad/support/gitrepo.py\r\n@@ -2649,6 +2649,7 @@ def _fixup_submodule_dotgit_setup(ds, relativepath):\r\n     Each subdataset/module has its own .git directory where a standalone\r\n     repository would have it. No gitdir files, no symlinks.\r\n     \"\"\"\r\n+    return  # TEMP\r\n     # move .git to superrepo's .git/modules, remove .git, create\r\n     # .git-file\r\n     path = opj(ds.path, relativepath)\r\n```\r\nI still have got all the tests passed locally", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3073/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3073/timeline", "performed_via_github_app": null}