{"url": "https://api.github.com/repos/datalad/datalad/issues/5987", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5987/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5987/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5987/events", "html_url": "https://github.com/datalad/datalad/issues/5987", "id": 998094655, "node_id": "I_kwDOANZqws47fbc_", "number": 5987, "title": "How to reconfigure authentication from deprecated user/password to token?", "user": {"login": "adswa", "id": 29738718, "node_id": "MDQ6VXNlcjI5NzM4NzE4", "avatar_url": "https://avatars.githubusercontent.com/u/29738718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adswa", "html_url": "https://github.com/adswa", "followers_url": "https://api.github.com/users/adswa/followers", "following_url": "https://api.github.com/users/adswa/following{/other_user}", "gists_url": "https://api.github.com/users/adswa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adswa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adswa/subscriptions", "organizations_url": "https://api.github.com/users/adswa/orgs", "repos_url": "https://api.github.com/users/adswa/repos", "events_url": "https://api.github.com/users/adswa/events{/privacy}", "received_events_url": "https://api.github.com/users/adswa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-09-16T11:20:15Z", "updated_at": "2021-10-08T09:47:42Z", "closed_at": "2021-10-08T08:08:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I saw this in the context of trying out @mih's PR #5949 and its probably a really stupid question.\r\nMy setup is as follows: I have a configured for GitHub user and password in my keyring.\r\nI also have a configured Github token (I left a comment in #5949 that this token is identified as \"datalad-None\" in my keyring). It works fine, it queries interactively for the token, and succeeds in creating a GitHub sibling.\r\n\r\nWhen I push to this sibling, ``push`` seems to fall back to user password authentication. This fails due to deprecation:\r\n\r\n```\r\n(handbook2) adina@muninn in /tmp/ds on git:master\r\n\u2771 datalad create-sibling-github new-create-sibling-command-gh          \r\ncreate_sibling_github(ok): [sibling repository 'github' created at https://github.com/adswa/new-create-sibling-command-gh]\r\nconfigure-sibling(ok): . (sibling)\r\naction summary:\r\n  configure-sibling (ok: 1)\r\n  create_sibling_github (ok: 1)\r\n(handbook2) adina@muninn in /tmp/ds on git:master\r\n\u2771 datalad push --to github\r\nUpdate availability for 'github':  75%|\u258a| 3.00/4.00 [00:00<00:00, 14.7k Steps/s]Username for 'https://github.com': adswa\r\nPassword for 'https://adswa@github.com': <mypw>\r\nCommandError: 'git -c diff.ignoreSubmodules=none push --progress --porcelain github master:master' failed with exitcode 128 under /tmp/ds\r\nremote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.\r\nremote: Please see https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/ for more information.\r\nfatal: Authentication failed for 'https://github.com/adswa/new-create-sibling-command-gh.git/'\r\n```\r\n\r\nCounter-intuitively for most people, it would work when instead of supplying user name and password the token is given:\r\n\r\n```\r\n(handbook2) adina@muninn in /tmp/ds on git:master\r\n\u2771 datalad push --to github                                          \r\nUpdate availability for 'github':  75%|\u258a| 3.00/4.00 [00:00<00:00, 31.1k Steps/s]\r\nUsername for 'https://github.com': <mytoken>\r\nPassword for 'https://<mytoken>@github.com': <mytoken>                                                                               \r\nUsername for 'https://github.com': <mytoken>      \r\nPassword for 'https://<mytoken>@github.com': \r\npublish(ok): . (dataset) [refs/heads/master->github:refs/heads/master [new branch]]                                                                             \r\npublish(ok): . (dataset) [refs/heads/git-annex->github:refs/heads/git-annex [new branch]]\r\naction summary:                                                                 \r\n  publish (ok: 2)\r\n```\r\nBut how can I get it to prompt for token authentication?\r\nIf I remove all github related passwords and user names from my keyring, it still tries to go with user password. \r\n", "closed_by": {"login": "adswa", "id": 29738718, "node_id": "MDQ6VXNlcjI5NzM4NzE4", "avatar_url": "https://avatars.githubusercontent.com/u/29738718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adswa", "html_url": "https://github.com/adswa", "followers_url": "https://api.github.com/users/adswa/followers", "following_url": "https://api.github.com/users/adswa/following{/other_user}", "gists_url": "https://api.github.com/users/adswa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adswa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adswa/subscriptions", "organizations_url": "https://api.github.com/users/adswa/orgs", "repos_url": "https://api.github.com/users/adswa/repos", "events_url": "https://api.github.com/users/adswa/events{/privacy}", "received_events_url": "https://api.github.com/users/adswa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5987/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5987/timeline", "performed_via_github_app": null}