{"url": "https://api.github.com/repos/datalad/datalad/issues/4772", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4772/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4772/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4772/events", "html_url": "https://github.com/datalad/datalad/issues/4772", "id": 666441649, "node_id": "MDU6SXNzdWU2NjY0NDE2NDk=", "number": 4772, "title": "We are not capturing/displaying stderr from git/ssh invocation(s) ?", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-27T16:56:31Z", "updated_at": "2021-03-04T19:03:17Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "If I try to ssh to unknown host ssh (to stderr) pukes:\r\n```\r\n$> ssh datalad-test ls\r\nssh: Could not resolve hostname datalad-test: Name or service not known\r\n```\r\n\r\nif I try to `git clone` -- that is displayed as well\r\n```\r\n$> git clone --progress datalad-test:/tmp/ /home/yoh/proj/datalad/datalad-maint/tmp\r\nCloning into '/home/yoh/proj/datalad/datalad-maint/tmp'...\r\nssh: Could not resolve hostname datalad-test: Name or service not known\r\nfatal: Could not read from remote repository.\r\n\r\nPlease make sure you have the correct access rights\r\nand the repository exists.\r\n```\r\nbut if I try to \r\n```$> datalad clone datalad-test:/tmp/\r\n[ERROR  ] Failed to clone from any candidate source URL. Encountered errors per each url were:                   \r\n| - datalad-test:/tmp/\r\n  CommandError: 'git clone --progress datalad-test:/tmp/ /home/yoh/proj/datalad/datalad-maint/tmp' failed with exitcode 128 [err: 'Cloning into '/home/yoh/proj/datalad/datalad-maint/tmp'...\r\nfatal: '/tmp/' does not appear to be a git repository\r\nCommandError: 'ssh -o ControlPath=/home/yoh/.cache/datalad/sockets/1c0831ad datalad-test 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git-upload-pack '\"'\"'/tmp/'\"'\"''' failed with exitcode 128\r\nfatal: Could not read from remote repository.\r\n\r\nPlease make sure you have the correct access rights\r\nand the repository exists.'] [install(/home/yoh/proj/datalad/datalad-maint/tmp)] \r\ninstall(error): /home/yoh/proj/datalad/datalad-maint/tmp (dataset) [Failed to clone from any candidate source URL. Encountered errors per each url were:\r\n- datalad-test:/tmp/\r\n  CommandError: 'git clone --progress datalad-test:/tmp/ /home/yoh/proj/datalad/datalad-maint/tmp' failed with exitcode 128 [err: 'Cloning into '/home/yoh/proj/datalad/datalad-maint/tmp'...\r\nfatal: '/tmp/' does not appear to be a git repository\r\nCommandError: 'ssh -o ControlPath=/home/yoh/.cache/datalad/sockets/1c0831ad datalad-test 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git-upload-pack '\"'\"'/tmp/'\"'\"''' failed with exitcode 128\r\nfatal: Could not read from remote repository.\r\n\r\nPlease make sure you have the correct access rights\r\nand the repository exists.']]\r\n```\r\nthat message is nowhere there... moreover -- in our sshconnector when we try to establish socket:\r\n\r\n```shell\r\n(git)lena:~datalad/datalad-maint[pull/origin/4762/head]git\r\n$> DATALAD_TESTS_SSH=1 python -m nose -s -v --with-doctest datalad/support/tests/test_sshconnector.py:test_ssh_close_target      \r\ndatalad.support.tests.test_sshconnector.test_ssh_close_target ... > /home/yoh/proj/datalad/datalad-maint/datalad/support/sshconnector.py(275)open()\r\n-> proc = Popen(cmd)\r\n(Pdb) n\r\n> /home/yoh/proj/datalad/datalad-maint/datalad/support/sshconnector.py(276)open()\r\n-> stdout, stderr = proc.communicate(input=\"\\n\")  # why the f.. this is necessary?\r\n(Pdb) ssh: Could not resolve hostname datalad-test: Name or service not known\r\nn\r\n> /home/yoh/proj/datalad/datalad-maint/datalad/support/sshconnector.py(280)open()\r\n-> exit_code = proc.wait()\r\n(Pdb) p stdout, stderr\r\n(None, None)\r\n```\r\nyou can see that it is just dumped to the screen instead of being captured in `stderr` as code suggests.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4772/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4772/timeline", "performed_via_github_app": null}