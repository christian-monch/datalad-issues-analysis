{"url": "https://api.github.com/repos/datalad/datalad/issues/2711", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2711/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2711/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2711/events", "html_url": "https://github.com/datalad/datalad/issues/2711", "id": 344040464, "node_id": "MDU6SXNzdWUzNDQwNDA0NjQ=", "number": 2711, "title": "WSL: datalad test errors and failures", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 188141023, "node_id": "MDU6TGFiZWwxODgxNDEwMjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/platform-windows", "name": "platform-windows", "color": "0052cc", "default": false, "description": "Issue concerned with Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-24T13:37:08Z", "updated_at": "2020-01-06T19:21:22Z", "closed_at": "2020-01-06T19:21:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nIn general it seems that Windows Subsytem for Linux (WSL, Windows 10 Enterprise, version 1709 build 16299.125) might be ready to be used \"in production\" with datalad!  while running `datalad test` under two environments (Debian stretch and Ubuntu xenial) some tests have errorred (the same badname we yet to resolve is among them) or failed, here are the full logs:\r\nhttp://www.onerussian.com/tmp/datalad-0.10.2-tests-wsl-stretch-1.log\r\nhttp://www.onerussian.com/tmp/datalad-0.10.2-tests-wsl-xenial-1.log\r\n\r\nhere is some worth first looking at and present in both envs:\r\n\r\n- [ ] locking\r\n```\r\n======================================================================\r\nFAIL: datalad.interface.tests.test_unlock.test_unlock\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/utils.py\", line 854, in newfunc\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/utils.py\", line 762, in newfunc\r\n    t(*(arg + (uri,)), **kw)\r\n  File \"/usr/lib/python3/dist-packages/datalad/interface/tests/test_unlock.py\", line 121, in test_unlock\r\n    assert_raises(IOError, open, opj(path, 'test-annex.dat'), \"w\")\r\nAssertionError: OSError not raised by open\r\n\r\n======================================================================\r\nFAIL: datalad.support.tests.test_locking.test_lock_if_check_fails\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/utils.py\", line 587, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/usr/lib/python3/dist-packages/datalad/support/tests/test_locking.py\", line 71, in test_lock_if_check_fails\r\n    assert q.get() is False\r\nAssertionError: \r\n-------------------- >> begin captured logging << --------------------\r\nfasteners.process_lock: Level 5: Acquired file lock `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.lck` after waiting 0.000s [1 attempts were required]\r\nfasteners.process_lock: Level 5: Unlocked and closed file lock open on `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.lck`\r\nfasteners.process_lock: Level 5: Acquired file lock `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.get-lck` after waiting 0.000s [1 attempts were required]\r\nfasteners.process_lock: Level 5: Unlocked and closed file lock open on `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.get-lck`\r\nfasteners.process_lock: Level 5: Acquired file lock `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.lck` after waiting 0.000s [1 attempts were required]\r\nfasteners.process_lock: Level 5: Unlocked and closed file lock open on `/mnt/c/tmp/ubuntu/datalad_temp_test_lock_if_check_failsvx7hq7st.lck`\r\n--------------------- >> end captured logging << ---------------------\r\n```\r\n\r\n- [ ] RO\r\n\r\n```\r\n======================================================================\r\nFAIL: datalad.tests.test_utils.test_rotree\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/utils.py\", line 587, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/test_utils.py\", line 143, in test_rotree\r\n    assert_raises(OSError, os.unlink, f)\r\nAssertionError: OSError not raised by unlink\r\n```\r\n\r\n- [ ] unicode \r\n\r\n```\r\n======================================================================\r\nFAIL: datalad.tests.test_tests_utils.test_get_most_obscure_supported_name\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/nose/case.py\", line 198, in runTest\r\n    self.test(*self.arg)\r\n  File \"/usr/lib/python3/dist-packages/datalad/tests/test_tests_utils.py\", line 206, in test_get_most_obscure_supported_name\r\n    eq_(n, OBSCURE_PREFIX + OBSCURE_FILENAMES[1])\r\nAssertionError: ' ;abc\u256c\u0424\u2568\u0429\u256b\u0437\u2518\u0415\u0440\u2563\u0427\u0443\u0411\u0412 ' != ' \"\\';a&b&c\u256c\u0424\u2568\u0429\u256b\u0437\u2518\u0415\u0440\u2563\u0427\u0443\u0411\u0412 `| '\r\n```\r\n\r\nMeanwhile I will setup development environment in that brand new Windows VM we have on smaug for datalad\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\n0.10.2\r\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2711/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2711/timeline", "performed_via_github_app": null}