{"url": "https://api.github.com/repos/datalad/datalad/issues/2127", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2127/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2127/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2127/events", "html_url": "https://github.com/datalad/datalad/pull/2127", "id": 295984945, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY4MzIyNzI1", "number": 2127, "title": "\"Old\" and new search in one command", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-02-09T19:27:48Z", "updated_at": "2018-07-15T04:01:25Z", "closed_at": "2018-02-10T12:33:55Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/2127", "html_url": "https://github.com/datalad/datalad/pull/2127", "diff_url": "https://github.com/datalad/datalad/pull/2127.diff", "patch_url": "https://github.com/datalad/datalad/pull/2127.patch"}, "body": "This PR RFs the `search` command to be able to handle multiple search modes. Currently supported are:\r\n\r\n- `autofield`: this is what used to be the new search (two-pass, autodiscover schema, files and datasets)\r\n- `default`: this is some some ways the old search, in some ways not\r\n\r\nThe new default behavior is to works on datasets only (but it has the ability to do files as well, unlike the old command). All metadata is currently coerced into a single string using a default whoosh text analyzer. Unit tests document what kind of searches work.\r\n\r\nAdditional metadata homogenization could be supported by introducing custom mappings (e.g. for neuro* datasets, etc.). This would be necessary to support the previously available 'search by field' in the old command. The current aggregated metadata has no homogenized fields, hence such thing is impossible without a known mapping.\r\n\r\nPerformance: I can generate a search index for a datasets that contains aggregated metadata from two subdatasets with 36k files each in under a second.\r\n\r\nMultiple concurrent search indices for the respective search modes are supported too.\r\n\r\nThis is the end of the road folks... @datalad/developers \r\n\r\nAs before, the buildbots cannot succeed, because the lack a suitable pybids version for the tests.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2127/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2127/timeline", "performed_via_github_app": null}