{"url": "https://api.github.com/repos/datalad/datalad/issues/5345", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5345/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5345/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5345/events", "html_url": "https://github.com/datalad/datalad/pull/5345", "id": 789632740, "node_id": "MDExOlB1bGxSZXF1ZXN0NTU3OTQ5NzA0", "number": 5345, "title": "BF+RF: Consistent and more \"thorough\" handling of fake HOMEs (including Windows)", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-01-20T05:00:39Z", "updated_at": "2021-02-02T17:42:19Z", "closed_at": "2021-02-02T17:42:19Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5345", "html_url": "https://github.com/datalad/datalad/pull/5345", "diff_url": "https://github.com/datalad/datalad/pull/5345.diff", "patch_url": "https://github.com/datalad/datalad/pull/5345.patch"}, "body": "Windows brings us many joys, including also having not just USERPROFILE but also HOMEDRIVE and HOMEPATH, so resetting USERPROFILE itself is not totally kosher alone.  Also, we could have PATH (e.g. in git shell) defined too even on Windows, so it is not sufficient to just reset USERPROFILE.\r\n\r\nSo in the first commit I have added a function to set only the variables known to current os.environ, and use of that one instead of hardcoded use of USERPROFILE vs HOME in test_clone seems to make that test pass for me for both py 3.7 and 3.8 on windows.  If confirmed that other Windows gurus are happy, then Closes #5338 (merge conflict will be minimal when merging into master for that test, didn't check overall though).   I have tuned up a few other tests where I found `HOME` to be used without paying due respect to glorious Windows land, so hopefully it would make it all a bit more consistent.\r\n\r\nWhile at it I also made handling of memoized env variables in setup/teardown more consistent and concise. It is a separate commit, so if any objections -- could probably later do it against master", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5345/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5345/timeline", "performed_via_github_app": null}