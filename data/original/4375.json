{"url": "https://api.github.com/repos/datalad/datalad/issues/4375", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4375/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4375/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4375/events", "html_url": "https://github.com/datalad/datalad/pull/4375", "id": 592823661, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzk3NzMyNjEx", "number": 4375, "title": "BF: gitrepo: Revert changes to store branch in .gitmodules", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/73", "html_url": "https://github.com/datalad/datalad/milestone/73", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/73/labels", "id": 5272227, "node_id": "MDk6TWlsZXN0b25lNTI3MjIyNw==", "number": 73, "title": "0.12.6", "description": "", "creator": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 15, "state": "closed", "created_at": "2020-04-03T18:47:30Z", "updated_at": "2020-05-13T19:30:07Z", "due_on": null, "closed_at": "2020-05-13T19:30:07Z"}, "comments": 4, "created_at": "2020-04-02T18:00:28Z", "updated_at": "2020-06-06T08:57:32Z", "closed_at": "2020-04-03T19:20:43Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4375", "html_url": "https://github.com/datalad/datalad/pull/4375", "diff_url": "https://github.com/datalad/datalad/pull/4375.diff", "patch_url": "https://github.com/datalad/datalad/pull/4375.patch"}, "body": "As of v0.12.0, specifically 2fda83e2ca (ENH: Record the active branch\r\nof a subdataset in the parent, 2019-10-20, gh-3817), we record the\r\ncurrent branch in the _parent_ repository as the value for\r\n`submodule.<name>.branch` in .gitmodules when saving a new submodule.\r\n\r\nThere are a few problems with this:\r\n\r\n  * The current branch in the parent is recorded.  It seems unlikely\r\n    that that was the intent because there is no reason to assume a\r\n    branch with that name exists in the submodule repository or, if it\r\n    does, to assume that the parent and submodule branches are\r\n    necessarily coupled.  2fda83e2ca mentions gh-1424\r\n    (`Datalad.recall_state()` -> `load` command) as the motivation,\r\n    which makes it seem likely the current branch in the submodule,\r\n    not the parent, was supposed be recorded.\r\n\r\n    This was mentioned in a currently open PR:\r\n    <https://github.com/datalad/datalad/pull/4275#discussion_r390596089>\r\n\r\n  * Discussion of recording the branch at gh-1424 suggests that the\r\n    idea is to record this information with every save, but 2fda83e2ca\r\n    records it only when the submodule is initially added.  2fda83e2ca\r\n    doesn't say explicitly that its intent was to do it with every\r\n    save (just that the change moves in the direction of gh-1424), but\r\n    still it doesn't seem a particularly useful incremental step to\r\n    have a one-shot record of the current branch at the time the\r\n    submodule is added.\r\n\r\n  * It's not clear that `submodule.<name>.branch` is a good spot to\r\n    record the branch information required by gh-1424.\r\n    `submodule.<name>.branch` is about which _remote_ branch is used\r\n    when `--remote` is passed to `submodule update`.  The goal in\r\n    gh-1424 seems to be tracking what the current _local_ branch was\r\n    at the time of a save.  Given these different purposes, it seems\r\n    like it'd be a good idea to track this information in a different\r\n    way (perhaps an entry in .gitmodules with a different key).\r\n\r\nGiven these issues, let's revert the changes from 2fda83e2ca, along\r\nwith the changes from the follow-up commit ee5010713f (BF: Do not\r\nrecord adjust branch in submodule config, 2019-10-21).\r\n\r\nFixes #4373.", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4375/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4375/timeline", "performed_via_github_app": null}