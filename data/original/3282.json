{"url": "https://api.github.com/repos/datalad/datalad/issues/3282", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3282/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3282/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3282/events", "html_url": "https://github.com/datalad/datalad/issues/3282", "id": 426931072, "node_id": "MDU6SXNzdWU0MjY5MzEwNzI=", "number": 3282, "title": "Code/semantics homogenization of dataset/path argument resolution", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-29T10:58:54Z", "updated_at": "2019-03-29T19:09:45Z", "closed_at": "2019-03-29T19:09:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is connected to various issues (#3230, #2589, #3242), but is also focused on the flow with which command should process and resolve arguments. We should have a standard, documented way (if possible) to reduce the heterogeneity across commands that contributes to the issues listed above.\r\n\r\nHere is a pattern proposal (not a description of the status quo):\r\n\r\n### Dataset resolution\r\n\r\nDetermine which dataset to operate on (if needed). All relevant commands get a `dataset` argument, and we can use `require_dataset()` to get a `ds` Dataset instance. It is important to maintain the pristine `dataset` argument value for path resolution (below), or in case further commands need to be called, so that argument semantics stay constant.\r\nBesides normal dataset path specification like absolute/relative paths, this **could** support special symbols like `^` and/or `^^` to indicate the root of the dataset immediately containing CWD, or the topmost dataset respectively.\r\n\r\n### Path argument resolution\r\n\r\nThe goal is to turn all arguments into absolute paths. The challenge is to make the semantics sensible for both cmdline and Python API.\r\nIn the cmdline the CWD is an important and highly visible anchor. Interpretation of nifty things like `--dataset ^^ --path here/below` is relatively clear (the topmost dataset, and $PWD/here/below).\r\n\r\nThe same things in Python with bound methods: `topmost.cmd('here/below')` is not at all saying the same (rather path relative to the dataset).\r\n\r\nWe also support `cmd(dataset='^^', path='here/below')`, which could mean any of the those interpretations from my POV.\r\n\r\nProposal:\r\n\r\n1. if the `dataset` argument (not the resolved `ds`) is a `Dataset` instance: any relative path argument is interpreted relative to that dataset (this covers the bound-method case).\r\n2. If the `dataset` argument is anything else (`None`, or any path specification, including magic symbols): any relative path is interpreted relative to CWD\r\n3. There is no difference in semantics between \"explicit\" relative paths (`./here/below`) and relative paths (`here/below`)", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3282/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3282/timeline", "performed_via_github_app": null}