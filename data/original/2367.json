{"url": "https://api.github.com/repos/datalad/datalad/issues/2367", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2367/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2367/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2367/events", "html_url": "https://github.com/datalad/datalad/pull/2367", "id": 310099512, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc4NTg0OTc5", "number": 2367, "title": "Make --show-keys more useful - report stats", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-03-30T15:49:59Z", "updated_at": "2018-07-15T05:31:09Z", "closed_at": "2018-03-31T08:02:30Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/2367", "html_url": "https://github.com/datalad/datalad/pull/2367", "diff_url": "https://github.com/datalad/datalad/pull/2367.diff", "patch_url": "https://github.com/datalad/datalad/pull/2367.patch"}, "body": "I bet there is a better/proper way but I could not think about one... I thought that may be `metadata` call on the superdataset could just report those aggregated unique values but I was not smart enough to figure out if that was possible.\r\n\r\nThis pull request proposes to make --show-keys more versatile and report statistics on the key values since they are known at no additional cost while listing them.  My original goal was to check what unique values for dicom fields we collected and in how many datasets.  While still waiting (for an hour now) for output of (a more informative, since provides pairs)\r\n```shell\r\n\r\n$> datalad -f '{metadata[dicom][Manufacturer]}: {metadata[dicom][ManufacturerModelName]}  Version(s):{metadata[dicom][SoftwareVersions]}' --report-type file search --max-nresult=0 --mode=autofield 'dicom.Manufacturer:*' -f > /tmp/allhits\r\n```\r\nI achieved following with the suggested here changes:\r\n```shell\r\n$> datalad --dbg search --show-keys=full | grep -A2 dicom.Manufa\r\ndicom.Manufacturer\r\n in  16 datasets\r\n has 3 unique values: u'SIEMENS', u'GE MEDICAL SYSTEMS', u'Philips Medical Systems'\r\ndicom.ManufacturerModelName\r\n in  16 datasets\r\n has 7 unique values: u'Prisma', u'SIGNA HDx', u'DISCOVERY MR750', u'Achieva', u'TrioTim', u'Prisma_fit', u'Intera'\r\n\r\n$> datalad --dbg search --show-keys=short | grep -A2 dicom.Manufa    \r\ndicom.Manufacturer\r\n in  16 datasets\r\n has 3 unique values: u'SIEMENS', u'GE MEDICAL SYSTEMS', u'Philips Medical Systems'\r\ndicom.ManufacturerModelName\r\n in  16 datasets\r\n has 7 unique values: u'Prisma', u'SIGNA HDx', u'DISCOVERY MR750', u'Achieva', u'TrioTim', u'Prisma_f ....\r\n\r\n$> datalad --dbg search --show-keys=name | grep -A2 dicom.Manufa     \r\ndicom.Manufacturer\r\ndicom.ManufacturerModelName\r\ndicom.MedicalAlerts\r\ndicom.Modality\r\n```\r\n\r\nFeel free to scrape it especially if above results could be obtained in some different, smoother way\r\n\r\n### Changes\r\n- [x] This change is complete\r\n\r\nPlease have a look @datalad/developers\r\n", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2367/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2367/timeline", "performed_via_github_app": null}