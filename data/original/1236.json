{"url": "https://api.github.com/repos/datalad/datalad/issues/1236", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1236/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1236/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1236/events", "html_url": "https://github.com/datalad/datalad/issues/1236", "id": 203805655, "node_id": "MDU6SXNzdWUyMDM4MDU2NTU=", "number": 1236, "title": "SSHManager is claiming to close connections that aren't open", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}, {"id": 447185719, "node_id": "MDU6TGFiZWw0NDcxODU3MTk=", "url": "https://api.github.com/repos/datalad/datalad/labels/regression", "name": "regression", "color": "fc8387", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-01-28T12:49:02Z", "updated_at": "2017-02-13T23:39:47Z", "closed_at": "2017-02-13T23:39:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This demo dataset has two configured remotes (both via SSH), but I only publish to one. However, the other (non-existing) control master \"github\" appears in several commands, and is also claimed to be closed at the end. This is confusing and should not happen. If there is an actual connection attempt (that I cannot see ATM), it would even worse.\r\n\r\nThis is something that already came up in #530 -- a long time ago in a galaxy far far away.\r\n\r\n````\r\n% datalad -l debug publish --to kumo \r\n[DEBUG  ] Resolved input path arguments: [] \r\n[DEBUG  ] Evaluating 1 dataset publication candidate(s) \r\n[DEBUG  ] Attempt to publish 1 datasets \r\n[DEBUG  ] Try starting control master by calling:\r\n| ['ssh', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/kumo', 'kumo', 'exit'] \r\n[DEBUG  ] Running: ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'sync', '--debug', '-c', 'remote.kumo.annex-ssh-options=-o ControlMaster=auto -S /home/mih/.cache/datalad/sockets/kumo', '-c', 'remote.github.annex-ssh-options=-o ControlMaster=auto -S /home/mih/.cache/datalad/sockets/github.com']\r\n| cwd: /tmp/demoannex \r\n[DEBUG  ] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/kumo', 'kumo']\r\n| cwd: None \r\n[INFO   ] [up to date]\r\n|  \r\n[INFO   ] Publishing <Dataset path=/tmp/demoannex> to kumo \r\n[DEBUG  ] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/kumo', 'kumo']\r\n| cwd: None \r\nNo handlers could be found for logger \"git.remote\"\r\n|  \r\n[INFO   ] Publishing data of dataset <Dataset path=/tmp/demoannex> ... \r\n[DEBUG  ] Running: ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'copy', '--debug', '-c', 'remote.kumo.annex-ssh-options=-o ControlMaster=auto -S /home/mih/.cache/datalad/sockets/kumo', '-c', 'remote.github.annex-ssh-options=-o ControlMaster=auto -S /home/mih/.cache/datalad/sockets/github.com', '--to=kumo']\r\n| cwd: /tmp/demoannex \r\n1 item was published:\r\nDataset: /tmp/demoannex\r\n\r\n[DEBUG  ] Closing 2 SSH connections... \r\n[DEBUG  ] Running: ['ssh', '-O', 'stop', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/github.com', 'github.com']\r\n| cwd: None \r\n[DEBUG  ] Running: ['ssh', '-O', 'stop', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/kumo', 'kumo']\r\n| cwd: None \r\n````", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1236/timeline", "performed_via_github_app": null}