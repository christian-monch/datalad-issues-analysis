{"url": "https://api.github.com/repos/datalad/datalad/issues/4338", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4338/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4338/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4338/events", "html_url": "https://github.com/datalad/datalad/pull/4338", "id": 586980476, "node_id": "MDExOlB1bGxSZXF1ZXN0MzkzMDA3NzI1", "number": 4338, "title": "ENH: Capture hints from Git", "user": {"login": "adswa", "id": 29738718, "node_id": "MDQ6VXNlcjI5NzM4NzE4", "avatar_url": "https://avatars.githubusercontent.com/u/29738718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adswa", "html_url": "https://github.com/adswa", "followers_url": "https://api.github.com/users/adswa/followers", "following_url": "https://api.github.com/users/adswa/following{/other_user}", "gists_url": "https://api.github.com/users/adswa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adswa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adswa/subscriptions", "organizations_url": "https://api.github.com/users/adswa/orgs", "repos_url": "https://api.github.com/users/adswa/repos", "events_url": "https://api.github.com/users/adswa/events{/privacy}", "received_events_url": "https://api.github.com/users/adswa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-24T13:58:56Z", "updated_at": "2020-12-18T07:32:08Z", "closed_at": "2020-03-26T06:18:53Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4338", "html_url": "https://github.com/datalad/datalad/pull/4338", "diff_url": "https://github.com/datalad/datalad/pull/4338.diff", "patch_url": "https://github.com/datalad/datalad/pull/4338.patch"}, "body": "Sometimes, Git has \"hints\" why pushing fails. \r\nFor example, if I attempt a push without integrating remote changes, it says\r\n\r\n```\r\nerror: failed to push some refs to 'git@github.com:datalad-handbook/DataLad-101.git'\r\nhint: Updates were rejected because the tip of your current branch is behind\r\nhint: its remote counterpart. Integrate the remote changes (e.g.\r\nhint: 'git pull ...') before pushing again.\r\nhint: See the 'Note about fast-forwards' in 'git push --help' for details.\r\n```\r\n\r\n`datalad push` swallowed these hints. In this PR I'm attempting to catch them and report all hints at the end of the result rendering.\r\n\r\n#### A few examples:\r\n\r\n```\r\ndatalad push --to blubb43\r\npublish(error): . (dataset) [refs/heads/git-annex->blubb43:refs/heads/git-annex [rejected] (fetch first)]\r\nPotential hints to solve encountered errors: \r\n1: Updates were rejected because the remote contains work that you do not have locally. This is usually caused by another repository pushing to the same ref. You may want to first integrate the remote changes (e.g., 'git pull ...') before pushing again. See the 'Note about fast-forwards' in 'git push --help' for details.\r\n\r\n```\r\n\r\nA situation with lots of the same hints \r\n\r\n```\r\ndatalad push --to public                                                                     1 \u21b5\r\npublish(error): . (dataset) [refs/heads/master->public:refs/heads/master [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_back_and_forth_in_time->public:refs/heads/sct_back_and_forth_in_time [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_computational_reproducibility->public:refs/heads/sct_computational_reproducibility [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_create_a_dataset->public:refs/heads/sct_create_a_dataset [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_datalad_rerun->public:refs/heads/sct_datalad_rerun [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_hide_content->public:refs/heads/sct_hide_content [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_input_and_output->public:refs/heads/sct_input_and_output [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_install_datasets->public:refs/heads/sct_install_datasets [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_keeping_track->public:refs/heads/sct_keeping_track [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_looking_without_touching->public:refs/heads/sct_looking_without_touching [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_modify_content->public:refs/heads/sct_modify_content [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_more_on_DYI_configurations->public:refs/heads/sct_more_on_DYI_configurations [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_more_on_dataset_nesting->public:refs/heads/sct_more_on_dataset_nesting [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_networking->public:refs/heads/sct_networking [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_populate_a_dataset->public:refs/heads/sct_populate_a_dataset [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_retrace_and_reenact->public:refs/heads/sct_retrace_and_reenact [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_stay_up_to_date->public:refs/heads/sct_stay_up_to_date [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_where_is_waldo->public:refs/heads/sct_where_is_waldo [rejected] (non-fast-forward)]\r\npublish(error): . (dataset) [refs/heads/sct_yoda_project->public:refs/heads/sct_yoda_project [rejected] (non-fast-forward)]\r\nPotential hints to solve encountered errors: \r\n1: Updates were rejected because the tip of your current branch is behind its remote counterpart. Integrate the remote changes (e.g. 'git pull ...') before pushing again. See the 'Note about fast-forwards' in 'git push --help' for details.\r\n2: Updates were rejected because a pushed branch tip is behind its remote counterpart. Check out this branch and integrate the remote changes (e.g. 'git pull ...') before pushing again. See the 'Note about fast-forwards' in 'git push --help' for details.\r\n\r\n```\r\n\r\nAnd with no hints:\r\n```\r\ndatalad push --to roommate                                                                   1 \u21b5\r\npublish(ok): . (dataset) [refs/heads/git-annex->roommate:refs/heads/git-annex f158575..2b80295]      \r\npublish(error): . (dataset) [refs/heads/master->roommate:refs/heads/master [remote rejected] (branch is currently checked out)]\r\n\r\n```\r\n\r\n#### side effects:\r\n\r\nWe found out that the [custom result summary renderer of get](https://github.com/datalad/datalad/blob/9b30ac204d7febe0a1a91c36654fdccd0373dcb7/datalad/distribution/get.py#L786) is never executed, because it would previously only be called if  `result_renderer` was set to `tailored`. With b8b282d, it should be called now.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4338/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4338/timeline", "performed_via_github_app": null}