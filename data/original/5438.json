{"url": "https://api.github.com/repos/datalad/datalad/issues/5438", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5438/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5438/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5438/events", "html_url": "https://github.com/datalad/datalad/pull/5438", "id": 816025027, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc5NzU3NDYz", "number": 5438, "title": "ENH(UX): set \"smoothing=0\" for any progress bar with \"total\" in its label", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390153891, "node_id": "MDU6TGFiZWwzOTAxNTM4OTE=", "url": "https://api.github.com/repos/datalad/datalad/labels/UX", "name": "UX", "color": "0052cc", "default": false, "description": "user experience"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-25T02:30:21Z", "updated_at": "2021-02-25T15:08:50Z", "closed_at": "2021-02-25T14:38:57Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5438", "html_url": "https://github.com/datalad/datalad/pull/5438", "diff_url": "https://github.com/datalad/datalad/pull/5438.diff", "patch_url": "https://github.com/datalad/datalad/pull/5438.patch"}, "body": "Original odd experience was reported in https://github.com/datalad/datalad/pull/5421#issuecomment-784316274 and it was\r\ndue to interplay of two factors:\r\n\r\n1 - Total is updated only after git-annex verifies the checksum.\r\n\r\nTotal progress bar is updated only upon the final \"ok\" from git-annex\r\nthat we got the file.  That also involves validation of the checksum by\r\ngit-annex. So, even though file is finished downloading, and its progress bar\r\ndisappeared, Total would not be updated until that file is \"ok\"ed by annex.\r\nThat takes time, so perceptually to the user  (me) it was odd that Total shows\r\nonly some little total although a good number of files already \"downloaded\"\r\n\r\nGood news: since Joey implemented \"on the fly\" checksumming (at least for\r\nbuilt in \"special remotes\") -- with e.g. `8.20210223+git1-g33af7d193-1~ndall+1` (*)\r\nexperience is much better since there is no delay from progressbar disappearing\r\nand the final message arriving and thus Total gets updated.\r\n\r\n2 - Default tqdm setting is not good for \"rare\" updates\r\n\r\nSee `smoothing` at https://github.com/tqdm/tqdm . Default `0.3` is a\r\ncompromise between providing user with smth between \"momentary\" and\r\n\"mean\" speed.  When Total is updated only once a minute, that leads to\r\n\"current\" speed being indeed quite low if most of the time there were no\r\nprogress at all ;)\r\n\r\nSince \"smoothing\" is ATM quit specific to tqdm and we have quite a number of\r\nsubclasses from ProgressBarBase  I decided to just go for an ad-hoc solution\r\nhere and make any progress bar which has \"total\" in its label to use\r\nsmoothing=0, i.e. to report the mean.\r\n\r\nAltogether with a new git-annex and this total smoothing of 0, Total looks\r\nquite decent now ;)\r\n\r\nCloses #5434\r\n\r\n*: reminder - installation of a bleeding edge build of git-annex on debians is as difficult as `datalad-installer git-annex -m datalad/git-annex` now (you would need hub.oauthtoken though in your git config)", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5438/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5438/timeline", "performed_via_github_app": null}