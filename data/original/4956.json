{"url": "https://api.github.com/repos/datalad/datalad/issues/4956", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4956/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4956/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4956/events", "html_url": "https://github.com/datalad/datalad/issues/4956", "id": 708172513, "node_id": "MDU6SXNzdWU3MDgxNzI1MTM=", "number": 4956, "title": "Bring back combining coverage reports from special remotes", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 545918236, "node_id": "MDU6TGFiZWw1NDU5MTgyMzY=", "url": "https://api.github.com/repos/datalad/datalad/labels/DX", "name": "DX", "color": "0052cc", "default": false, "description": "developer experience"}, {"id": 1782620215, "node_id": "MDU6TGFiZWwxNzgyNjIwMjE1", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-minor", "name": "severity-minor", "color": "ffdddd", "default": false, "description": "a problem which doesn't affect the package's usefulness, and is presumably trivial to fix"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2020-09-24T13:28:57Z", "updated_at": "2020-10-06T00:07:04Z", "closed_at": "2020-10-06T00:07:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Discovered in the course of https://github.com/datalad/datalad/pull/4955/files that we fail to merge coverage reports from special remotes:  https://travis-ci.org/github/datalad/datalad/jobs/729780153#L2438\r\n```\r\n6.32s$ if [ -z \"${_DL_CRON:-}\" ]; then cp __testhome__/.coverage .; coverage combine -a /tmp/.coverage-entrypoints-*; codecov; fi\r\nTraceback (most recent call last):\r\n  File \"/home/travis/virtualenv/python3.7.1/bin/coverage\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/cmdline.py\", line 865, in main\r\n    status = CoverageScript().command_line(argv)\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/cmdline.py\", line 588, in command_line\r\n    self.coverage.combine(data_dirs, strict=True)\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/control.py\", line 696, in combine\r\n    combine_parallel_data(self._data, aliases=aliases, data_paths=data_paths, strict=strict)\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/data.py\", line 117, in combine_parallel_data\r\n    data.update(new_data, aliases=aliases)\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/sqldata.py\", line 706, in update\r\n    for (file, context), numbits in lines.items()\r\n  File \"/home/travis/virtualenv/python3.7.1/lib/python3.7/site-packages/coverage/sqldata.py\", line 706, in <listcomp>\r\n    for (file, context), numbits in lines.items()\r\nKeyError: '/home/travis/build/datalad/datalad/datalad/api.py'\r\n```\r\n\r\nso that step fails and we just submit main coverage.\r\n\r\n@jwodder - since you dealt with coverage reporting recently, could you please also have a look at this, more obscure case as well?  I have not yet tried to reproduce locally etc.  Look into .travis.yml for more pointers on how we do it (helper scripts etc)", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4956/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4956/timeline", "performed_via_github_app": null}