{"url": "https://api.github.com/repos/datalad/datalad/issues/5321", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5321/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5321/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5321/events", "html_url": "https://github.com/datalad/datalad/pull/5321", "id": 784420165, "node_id": "MDExOlB1bGxSZXF1ZXN0NTUzNjE0MDk4", "number": 5321, "title": "OPT: Speed up _check_git_annex_version()", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 289240596, "node_id": "MDU6TGFiZWwyODkyNDA1OTY=", "url": "https://api.github.com/repos/datalad/datalad/labels/performance", "name": "performance", "color": "f4b2d8", "default": false, "description": "Improve performance of an existing feature"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-01-12T17:06:04Z", "updated_at": "2021-01-15T07:05:35Z", "closed_at": "2021-01-15T07:05:31Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5321", "html_url": "https://github.com/datalad/datalad/pull/5321", "diff_url": "https://github.com/datalad/datalad/pull/5321.diff", "patch_url": "https://github.com/datalad/datalad/pull/5321.patch"}, "body": "It removes a programmatic assesment of the platform in order to\r\nbuild a targeted message to be displayed whenever git-annex\r\ncannot be found.\r\n\r\nNow the message is generic and saved 1.5s for a wide range of\r\ndatalad command executed on the cmdline.\r\n\r\nFor example, a `datalad create` on Debian drops from 2.5s to 800ms.\r\n\r\nnow:\r\n```\r\n(datalad3-dev) mih@meiner /tmp % time datalad create s1\r\n[INFO   ] Creating a new annex repo at /tmp/s1 \r\n[INFO   ] Scanning for unlocked files (this may take some time) \r\ncreate(ok): /tmp/s1 (dataset)\r\ndatalad create s1  0.59s user 0.27s system 104% cpu 0.833 total\r\n\r\n(datalad3-dev) mih@meiner /tmp/s1 (git)-[master] % touch this\r\n(datalad3-dev) mih@meiner /tmp/s1 (git)-[master] % time datalad save\r\nadd(ok): this (file)                                                                                                                       \r\nsave(ok): . (dataset)                                                                                                                      \r\naction summary:                                                                                                                            \r\n  add (ok: 1)\r\n  save (ok: 1)\r\ndatalad save  0.50s user 0.17s system 98% cpu 0.677 total\r\n\r\n(datalad3-dev) mih@meiner /tmp/s1 (git)-[master] % time datalad status --annex\r\n1 annex'd file (0.0 B recorded total size)\r\nnothing to save, working tree clean\r\ndatalad status --annex  0.32s user 0.09s system 102% cpu 0.403 total\r\n```\r\n\r\nbefore:\r\n```\r\n(datalad3-dev) mih@meiner /tmp % time datalad create s2\r\n[INFO   ] Creating a new annex repo at /tmp/s2 \r\n[INFO   ] Scanning for unlocked files (this may take some time) \r\ncreate(ok): /tmp/s2 (dataset)\r\ndatalad create s2  2.02s user 0.34s system 98% cpu 2.413 total\r\n\r\n(datalad3-dev) mih@meiner /tmp/s2 (git)-[master] % time datalad save\r\nadd(ok): this (file)                                                                                                                       \r\nsave(ok): . (dataset)                                                                                                                      \r\naction summary:                                                                                                                            \r\n  add (ok: 1)\r\n  save (ok: 1)\r\ndatalad save  2.04s user 0.31s system 92% cpu 2.531 total\r\n\r\n(datalad3-dev) mih@meiner /tmp/s2 (git)-[master] % time datalad status --annex\r\n1 annex'd file (0.0 B recorded total size)\r\nnothing to save, working tree clean\r\ndatalad status --annex  1.88s user 0.20s system 100% cpu 2.059 total\r\n```\r\n\r\n\r\nFixes #5317", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5321/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5321/timeline", "performed_via_github_app": null}