{"url": "https://api.github.com/repos/datalad/datalad/issues/5661", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5661/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5661/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5661/events", "html_url": "https://github.com/datalad/datalad/pull/5661", "id": 890452099, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQzNDcxNDgz", "number": 5661, "title": "DOC: Reference plugins via datalad.api", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 227904225, "node_id": "MDU6TGFiZWwyMjc5MDQyMjU=", "url": "https://api.github.com/repos/datalad/datalad/labels/documentation", "name": "documentation", "color": "cfd3d7", "default": true, "description": "Changes only affect the documentation"}, {"id": 3049454433, "node_id": "MDU6TGFiZWwzMDQ5NDU0NDMz", "url": "https://api.github.com/repos/datalad/datalad/labels/patch", "name": "patch", "color": "870048", "default": false, "description": "Increment the patch version when merged"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-05-12T20:18:31Z", "updated_at": "2021-06-02T19:58:43Z", "closed_at": "2021-05-17T17:27:15Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5661", "html_url": "https://github.com/datalad/datalad/pull/5661", "diff_url": "https://github.com/datalad/datalad/pull/5661.diff", "patch_url": "https://github.com/datalad/datalad/pull/5661.patch"}, "body": "With the recent release of Sphinx v4, the doc build on master and\r\nmaint started to fail.  The failure on master was due to a bug in\r\nSphinx and fixed by v4.0.1.  The failure on maint is due to a warning:\r\n\r\n    docstring of datalad.support.constraints.EnsureChoice:1:duplicate\r\n    object description of datalad.support.constraints.EnsureChoice,\r\n    other instance in generated/datalad.plugin.add_readme, use\r\n    :noindex: for one of them\r\n\r\nOne our end, this is triggered by the combination of two things:\r\n\r\n  * many of the plugin modules have imports at the class level\r\n\r\n  * the documentation refers to these plugin commands via\r\n    datalad.plugin.NAME rather than datalad.api.NAME\r\n\r\nThe end result is that the plugin commands are not rendered like other\r\ncommands (e.g., no command parameters) and instead have a lot of noise\r\nabout unrelated class attributes (e.g., AddReadme.EnsureChoice).\r\n\r\nWe could remove the warning by moving these imports to the module\r\nlevel, but these pages still wouldn't be rendered in the same way that\r\nother commands are.  Remove the warnings and fix the rendering by\r\npointing to datalad.api rather than datalad.plugin.\r\n\r\nNote that master doesn't have this issue because all plugins have been\r\nconverted to regular commands and are referenced as datalad.api.NAME.\r\n\r\nFixes #5650.\r\n\r\n---\r\n\r\nExample of the problem:\r\n\r\nhttps://docs.datalad.org/en/stable/generated/datalad.plugin.add_readme.html#datalad.plugin.add_readme.AddReadme.EnsureChoice\r\n", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5661/timeline", "performed_via_github_app": null}