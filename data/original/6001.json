{"url": "https://api.github.com/repos/datalad/datalad/issues/6001", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/6001/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/6001/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/6001/events", "html_url": "https://github.com/datalad/datalad/issues/6001", "id": 1005173860, "node_id": "I_kwDOANZqws476bxk", "number": 6001, "title": "Datalad publish to gin.g-node.org fails repeatedly", "user": {"login": "ozika", "id": 10030056, "node_id": "MDQ6VXNlcjEwMDMwMDU2", "avatar_url": "https://avatars.githubusercontent.com/u/10030056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ozika", "html_url": "https://github.com/ozika", "followers_url": "https://api.github.com/users/ozika/followers", "following_url": "https://api.github.com/users/ozika/following{/other_user}", "gists_url": "https://api.github.com/users/ozika/gists{/gist_id}", "starred_url": "https://api.github.com/users/ozika/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ozika/subscriptions", "organizations_url": "https://api.github.com/users/ozika/orgs", "repos_url": "https://api.github.com/users/ozika/repos", "events_url": "https://api.github.com/users/ozika/events{/privacy}", "received_events_url": "https://api.github.com/users/ozika/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390153891, "node_id": "MDU6TGFiZWwzOTAxNTM4OTE=", "url": "https://api.github.com/repos/datalad/datalad/labels/UX", "name": "UX", "color": "0052cc", "default": false, "description": "user experience"}, {"id": 2803338840, "node_id": "MDU6TGFiZWwyODAzMzM4ODQw", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-publish", "name": "cmd-publish", "color": "FEF2C0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-23T08:53:15Z", "updated_at": "2021-09-23T10:59:28Z", "closed_at": "2021-09-23T10:58:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### What is the problem?\r\n- I am uploading a large (~630 GB) data set on `gin.g-node.org` and while about 90% of files gets uploaded, the rest fails\r\n- The command I run: `datalad publish -f --to gin --transfer-data all` \r\n- I re-run the same command but the same files keep failing. \r\n- Strangely, when trying to re-upload I noticed that for all of them the upload reaches 100% and keeps going. One clue is that it eventually reaches the size of twice the amount of the original file before marking it as failed. I initially thought it's something to do with internet stability or permissions, but I think I have eliminated those two now. I made [**a video**](https://drive.google.com/file/d/1jENvUH44E_QgSuSv1R0QP5VedDUusEt-/view?usp=sharing) showing this behaviour. The full size of the file is reached at ~3:15 (when upload size is 1.37 GB in this case) and the eventual fail occurs at cca ~7:05 (when the upload size is 2.74 GB, exactly double). \r\n\r\n#### What steps will reproduce the problem?\r\nTbh not sure, just uploading large files to gin from ubuntu, maybe?  I tried uploading to an alternative gin server (internal) and I made sure the internet connection is fast and stable. \r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\n\r\nIn short `0.12.6`, `ubuntu 18.04.`. \r\nIn long below line: \r\n--- \r\n# WTF\r\n## configuration <SENSITIVE, report disabled by configuration>\r\n## datalad \r\n  - full_version: 0.12.6\r\n  - version: 0.12.6\r\n## dataset \r\n  - id: 63a423d0-1894-11ec-8975-4889e7d51f56\r\n  - metadata: <SENSITIVE, report disabled by configuration>\r\n  - path: /data/pl1_data\r\n  - repo: AnnexRepo\r\n## dependencies \r\n  - appdirs: 1.4.3\r\n  - boto: 2.44.0\r\n  - cmd:7z: 16.02\r\n  - cmd:annex: 8.20210223-1~ndall+1\r\n  - cmd:bundled-git: 2.24.0\r\n  - cmd:git: 2.24.0\r\n  - cmd:system-git: 2.24.0\r\n  - cmd:system-ssh: 7.6p1\r\n  - exifread: 2.1.2\r\n  - git: 3.0.5\r\n  - gitdb: 2.0.6\r\n  - humanize: 0.5.1\r\n  - iso8601: 0.1.11\r\n  - keyring: 10.6.0\r\n  - keyrings.alt: 3.0\r\n  - msgpack: 0.5.6\r\n  - mutagen: 1.38\r\n  - requests: 2.18.4\r\n  - tqdm: 4.19.5\r\n  - wrapt: 1.9.0\r\n## environment \r\n  - GIT_PYTHON_GIT_EXECUTABLE: /usr/lib/git-annex.linux/git\r\n  - LANG: en_US.UTF-8\r\n  - LC_ADDRESS: en_GB.UTF-8\r\n  - LC_IDENTIFICATION: en_GB.UTF-8\r\n  - LC_MEASUREMENT: en_GB.UTF-8\r\n  - LC_MONETARY: en_GB.UTF-8\r\n  - LC_NAME: en_GB.UTF-8\r\n  - LC_NUMERIC: en_GB.UTF-8\r\n  - LC_PAPER: en_GB.UTF-8\r\n  - LC_TELEPHONE: en_GB.UTF-8\r\n  - LC_TIME: en_GB.UTF-8\r\n  - PATH: /home/ondrej/.conda/envs/python3.7/bin:/home/ondrej/anaconda3/condabin:/usr/lib/fsl/5.0:/home/ondrej/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\r\n## extensions \r\n## git-annex \r\n  - build flags: \r\n    - Assistant\r\n    - Webapp\r\n    - Pairing\r\n    - Inotify\r\n    - DBus\r\n    - DesktopNotify\r\n    - TorrentParser\r\n    - MagicMime\r\n    - Feeds\r\n    - Testsuite\r\n    - S3\r\n    - WebDAV\r\n  - dependency versions: \r\n    - aws-0.20\r\n    - bloomfilter-2.0.1.0\r\n    - cryptonite-0.25\r\n    - DAV-1.3.3\r\n    - feed-1.0.0.0\r\n    - ghc-8.4.4\r\n    - http-client-0.5.13.1\r\n    - persistent-sqlite-2.8.2\r\n    - torrent-10000.1.1\r\n    - uuid-1.3.13\r\n    - yesod-1.6.0\r\n  - key/value backends: \r\n    - SHA256E\r\n    - SHA256\r\n    - SHA512E\r\n    - SHA512\r\n    - SHA224E\r\n    - SHA224\r\n    - SHA384E\r\n    - SHA384\r\n    - SHA3_256E\r\n    - SHA3_256\r\n    - SHA3_512E\r\n    - SHA3_512\r\n    - SHA3_224E\r\n    - SHA3_224\r\n    - SHA3_384E\r\n    - SHA3_384\r\n    - SKEIN256E\r\n    - SKEIN256\r\n    - SKEIN512E\r\n    - SKEIN512\r\n    - BLAKE2B256E\r\n    - BLAKE2B256\r\n    - BLAKE2B512E\r\n    - BLAKE2B512\r\n    - BLAKE2B160E\r\n    - BLAKE2B160\r\n    - BLAKE2B224E\r\n    - BLAKE2B224\r\n    - BLAKE2B384E\r\n    - BLAKE2B384\r\n    - BLAKE2BP512E\r\n    - BLAKE2BP512\r\n    - BLAKE2S256E\r\n    - BLAKE2S256\r\n    - BLAKE2S160E\r\n    - BLAKE2S160\r\n    - BLAKE2S224E\r\n    - BLAKE2S224\r\n    - BLAKE2SP256E\r\n    - BLAKE2SP256\r\n    - BLAKE2SP224E\r\n    - BLAKE2SP224\r\n    - SHA1E\r\n    - SHA1\r\n    - MD5E\r\n    - MD5\r\n    - WORM\r\n    - URL\r\n    - X*\r\n  - local repository version: 8\r\n  - operating system: linux x86_64\r\n  - remote types: \r\n    - git\r\n    - gcrypt\r\n    - p2p\r\n    - S3\r\n    - bup\r\n    - directory\r\n    - rsync\r\n    - web\r\n    - bittorrent\r\n    - webdav\r\n    - adb\r\n    - tahoe\r\n    - glacier\r\n    - ddar\r\n    - git-lfs\r\n    - httpalso\r\n    - borg\r\n    - hook\r\n    - external\r\n  - supported repository versions: \r\n    - 8\r\n  - upgrade supported from repository versions: \r\n    - 0\r\n    - 1\r\n    - 2\r\n    - 3\r\n    - 4\r\n    - 5\r\n    - 6\r\n    - 7\r\n  - version: 8.20210223-1~ndall+1\r\n## location \r\n  - path: /data/pl1_data\r\n  - type: dataset\r\n## metadata_extractors \r\n  - annex: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.annex\r\n    - version: None\r\n  - audio: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.audio\r\n    - version: None\r\n  - datacite: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datacite\r\n    - version: None\r\n  - datalad_core: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_core\r\n    - version: None\r\n  - datalad_rfc822: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_rfc822\r\n    - version: None\r\n  - exif: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.exif\r\n    - version: None\r\n  - frictionless_datapackage: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.frictionless_datapackage\r\n    - version: None\r\n  - image: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.image\r\n    - version: None\r\n  - xmp: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.xmp\r\n    - version: None\r\n## python \r\n  - implementation: CPython\r\n  - version: 3.6.9\r\n## system \r\n  - distribution: Ubuntu/18.04/bionic\r\n  - encoding: \r\n    - default: utf-8\r\n    - filesystem: utf-8\r\n    - locale.prefered: UTF-8\r\n  - max_path_length: 270\r\n  - name: Linux\r\n  - release: 5.4.0-81-generic\r\n  - type: posix\r\n  - version: #91~18.04.1-Ubuntu SMP Fri Jul 23 13:36:29 UTC 2021\r\n\r\n\r\n", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/6001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/6001/timeline", "performed_via_github_app": null}