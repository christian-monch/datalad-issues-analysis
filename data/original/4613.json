{"url": "https://api.github.com/repos/datalad/datalad/issues/4613", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4613/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4613/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4613/events", "html_url": "https://github.com/datalad/datalad/issues/4613", "id": 634327005, "node_id": "MDU6SXNzdWU2MzQzMjcwMDU=", "number": 4613, "title": "RIA subdataset install \"broken\" by early success", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}, {"id": 390153891, "node_id": "MDU6TGFiZWwzOTAxNTM4OTE=", "url": "https://api.github.com/repos/datalad/datalad/labels/UX", "name": "UX", "color": "0052cc", "default": false, "description": "user experience"}, {"id": 2767256516, "node_id": "MDU6TGFiZWwyNzY3MjU2NTE2", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-get", "name": "cmd-get", "color": "FEF2C0", "default": false, "description": ""}, {"id": 2971010147, "node_id": "MDU6TGFiZWwyOTcxMDEwMTQ3", "url": "https://api.github.com/repos/datalad/datalad/labels/RIA/ORA", "name": "RIA/ORA", "color": "E8F2DF", "default": false, "description": "Issues related to RIA-based workflows and related components"}], "state": "closed", "locked": false, "assignee": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2020-06-08T08:00:47Z", "updated_at": "2021-05-20T15:41:24Z", "closed_at": "2021-05-20T15:41:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Demo:\r\n\r\n```\r\n% datalad clone ria+http://rs.ds.inm7.de#~super all_rs_data\r\n% cd all_rs_data\r\n% datalad get eNKI/sub-A00008399\r\n[INFO   ] Remote origin not usable by git-annex; setting annex-ignore                        \r\n[INFO   ] Configured RIA store not found at ria+file:///ds/rs/srv                            \r\ninstall(ok): /tmp/all_rs_data/eNKI (dataset) [Installed subdataset in order to get /tmp/all_rs_data/eNKI/sub-A00008399]\r\nTotal (0 ok, 4 failed out of 4):   0%|                            | 0.00/207M [00:00<?, ?B/s][WARNING] Running get resulted in stderr output: git-annex: get: 4 failed\r\n \r\n                                                                                             [ERROR  ] not available; Try making some of these repositories available:;      019b3420-fc32-4984-93c6-b79a705511a2 -- mih@bulk1:/ds/rs/incoming/eNKI;      38cb587d-c7ec-4228-a8a2-a1abec89331a -- inm7-storage; ; (Note that these git remotes have annex-ignore set: origin) [get(/tmp/all_rs_data/eNKI/sub-A00008399/ses-DS2/Confounds_sub-A00008399_ses-DS2.mat)] \r\n...\r\n```\r\n\r\nThe ora special remote config doesn't work `ria+file:///ds/rs/srv` so a reconfiguration should have been triggered, but wasn't. The reason is this:\r\n\r\n```\r\n% git grep -A 3 'submodule.*eNKI' -- .gitmodules |cat\r\n.gitmodules:[submodule \"eNKI\"]\r\n.gitmodules-    path = eNKI\r\n.gitmodules-    url = http://rs.ds.inm7.de/23e/45ab0-a588-11ea-8ccf-a0369f287950\r\n.gitmodules-    datalad-id = 23e45ab0-a588-11ea-8ccf-a0369f287950\r\n```\r\nThe URL recorded in `.gitmodules` is actually functional and is tried before the configured RIA lookup:\r\n\r\n```\r\n% git config datalad.get.subdataset-source-candidate-origin\r\nria+http://rs.ds.inm7.de#{id}\r\n```\r\n\r\nNot sure which way would be best here. The problem is caused by the facts that I used\r\n\r\n```\r\ndatalad clone -d^ ria+http://rs.ds.inm7.de#23e45ab0-a588-11ea-8ccf-a0369f287950 eNKI\r\n```\r\n\r\nwhen adding the subdataset originally -- which get's resolved to the working http URL above. I could simply not do that and use a local clone path. or we change the lookup order to prefer datalad config sources over `.gitmodules`.\r\n\r\nPlease let me know what you think @datalad/developers so we can fix this for 0.13 (either by changing code or documenting the issue and leaving written advice on how to avoid this, probably in the handbook).", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4613/timeline", "performed_via_github_app": null}