{"url": "https://api.github.com/repos/datalad/datalad/issues/5174", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5174/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5174/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5174/events", "html_url": "https://github.com/datalad/datalad/issues/5174", "id": 746825411, "node_id": "MDU6SXNzdWU3NDY4MjU0MTE=", "number": 5174, "title": "Fix or kill datalad singularity containers", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778594, "node_id": "MDU6TGFiZWw2Mzc3ODU5NA==", "url": "https://api.github.com/repos/datalad/datalad/labels/question", "name": "question", "color": "fbca04", "default": true, "description": "Issue asks a question rather than reporting a problem"}, {"id": 526935563, "node_id": "MDU6TGFiZWw1MjY5MzU1NjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/feedback-desired", "name": "feedback-desired", "color": "fbca04", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-11-19T18:31:28Z", "updated_at": "2020-11-24T15:02:43Z", "closed_at": "2020-11-24T15:02:43Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As recent issues point out (e.g. #5173) our singularity containers are outdated and anyways a very suboptimal way to install datalad.  IMHO we should direct people to the `datalad/install.py` as the helper to get git-annex/datalad installed\r\n\r\nmeanwhile we should\r\n- [ ] strip away mentioning of singularity in README\r\n- [ ] fix or remove singularity containers\r\n\r\n<details>\r\n<summary>currently fails to build</summary> \r\n\r\nhttps://singularity-hub.org/containers/14903/log\r\n\r\n```shell\r\ncreating build/temp.linux-x86_64-3.7/multidict\r\nx86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/usr/include/python3.7m -c multidict/_multidict.c -o build/temp.linux-x86_64-3.7/multidict/_multidict.o -O2 -std=c99 -Wall -Wsign-compare -Wconversion -fno-strict-aliasing -pedantic\r\nunable to execute 'x86_64-linux-gnu-gcc': No such file or directory\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n\r\n----------------------------------------\r\n\u001b[31m\u001b(B\u001b[mCleaning up...\r\nCleaning up...\r\nDEBUG False\r\nLOG BUILD PARAMETERS:\r\nrepo_url is set to https://www.github.com/datalad/datalad\r\nrepo_id is set to 14052034\r\nresponse_url is set to https://singularity-hub.org/hooks/build/gce/receive\r\nbucket_name is set to singularityhub\r\ntag is set to latest\r\ncontainer_id is set to 14903\r\ncommit is set to 58abf0db07ea6119fd0c520f2445a758ca1b1bf1\r\nbranch is set to master\r\nspec_file is set to tools/Singularity\r\nlogging_url is set to https://singularity-hub.org/hooks/build/gce/finish\r\nlogfile is set to /tmp/.shub-log\r\nChecking out branch master\r\nChecking out commit 58abf0db07ea6119fd0c520f2445a758ca1b1bf1\r\nFound spec file tools/Singularity in repository\r\n+ echo Configuring the environment\r\n+ apt-get -y update\r\n+ apt-get -y install eatmydata\r\n+ eatmydata apt-get -y install gnupg wget locales\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\nGenerating locales (this might take a while)...\r\nGeneration complete.\r\nUpdating certificates in /etc/ssl/certs...\r\n126 added, 0 removed; done.\r\n+ echo en_US.UTF-8 UTF-8\r\n+ locale-gen\r\n+ eatmydata apt-get -y install --no-install-recommends git git-annex-standalone python3-pip\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\n+ eatmydata apt-get -y install --no-install-recommends python3-setuptools python3-wheel less rsync git-remote-gcrypt aria2 libexempi3 rclone git-annex-remote-rclone p7zip-full\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\ninvoke-rc.d: could not determine current runlevel\r\ninvoke-rc.d: policy-rc.d denied execution of restart.\r\n+ eatmydata apt-get -y install --no-install-recommends python3-twisted\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\n+ pip3 install --system datalad[full]\r\nFailed building wheel for yarl\r\nFailed building wheel for multidict\r\nCommand \"/usr/bin/python3 -u -c \"import setuptools, tokenize;__file__='/tmp/pip-install-3imcekik/multidict/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n\r\n', '\r\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-08if0vlw/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-install-3imcekik/multidict/\r\nABORT: Aborting with RETVAL=255\r\n+ echo Configuring the environment\r\n+ apt-get -y update\r\n+ apt-get -y install eatmydata\r\n+ eatmydata apt-get -y install gnupg wget locales\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\nGenerating locales (this might take a while)...\r\nGeneration complete.\r\nUpdating certificates in /etc/ssl/certs...\r\n126 added, 0 removed; done.\r\n+ echo en_US.UTF-8 UTF-8\r\n+ locale-gen\r\n+ eatmydata apt-get -y install --no-install-recommends git git-annex-standalone python3-pip\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\n+ eatmydata apt-get -y install --no-install-recommends python3-setuptools python3-wheel less rsync git-remote-gcrypt aria2 libexempi3 rclone git-annex-remote-rclone p7zip-full\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\ninvoke-rc.d: could not determine current runlevel\r\ninvoke-rc.d: policy-rc.d denied execution of restart.\r\n+ eatmydata apt-get -y install --no-install-recommends python3-twisted\r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nE: Can not write log (Is /dev/pts mounted?) - posix_openpt (2: No such file or directory)\r\n+ pip3 install --system datalad[full]\r\nFailed building wheel for yarl\r\nFailed building wheel for multidict\r\nCommand \"/usr/bin/python3 -u -c \"import setuptools, tokenize;__file__='/tmp/pip-install-3imcekik/multidict/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n\r\n', '\r\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-08if0vlw/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-install-3imcekik/multidict/\r\nABORT: Aborting with RETVAL=255\r\nImage failed build: build end 102 seconds.\r\nReturn value of 1.\r\nEnd Time: Tue Nov 17 01:04:23 UTC 2020.\r\n```\r\n</details>", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5174/timeline", "performed_via_github_app": null}