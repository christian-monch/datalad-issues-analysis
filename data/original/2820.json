{"url": "https://api.github.com/repos/datalad/datalad/issues/2820", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2820/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2820/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2820/events", "html_url": "https://github.com/datalad/datalad/issues/2820", "id": 359920711, "node_id": "MDU6SXNzdWUzNTk5MjA3MTE=", "number": 2820, "title": "Bare repositories are not supported by direct manipulations DataLad", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1055746027, "node_id": "MDU6TGFiZWwxMDU1NzQ2MDI3", "url": "https://api.github.com/repos/datalad/datalad/labels/bare-mode", "name": "bare-mode", "color": "0052cc", "default": false, "description": "Issue regarding operation on bare mode repositories"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-13T14:26:54Z", "updated_at": "2020-05-30T07:15:20Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nour GitRepo passes `**kwargs` to underlying GitPython's Repo, which does support `bare`.  And we make use of that in a few tests, but in general we never (consciously) work/test operation with bare git repos.  That causes trouble when users do try to create bare datalad datasets (see e.g. https://neurostars.org/t/datalad-throwback-doing-as-im-told/2144) or try to add bare \"subdatasets\" (#2819).\r\n\r\nI think at this point we might want to\r\n- [ ] explicitly test for `bare` being passed to GitRepo `kwargs` and blow with `NotImplementedError(\"bare mode git repositories are not supported)`\r\n- [ ] check in GitRepo constructor for existing repos if they are bare and also blow\r\n- [ ] do check for possibly bare repos tried to be `add`-ed (that #2819) and blow there as well\r\n\r\nIn the long(er) run we might consider actually adding support for bare repositories, since they are hand(ier) for collaborative work and might be safer in case of the shared git-annex mode which [leaves files writeable](https://git-annex.branchable.com/bugs/--shared_setting_of_git_causes_annex__39__ed_files_to_be_writeable__33__/)\r\n\r\nedit1: provided a response outlining a possible workflow working with bare repositories for sharing: https://neurostars.org/t/datalad-throwback-doing-as-im-told/2144/2?u=yarikoptic", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2820/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2820/timeline", "performed_via_github_app": null}