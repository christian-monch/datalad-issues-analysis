{"url": "https://api.github.com/repos/datalad/datalad/issues/4980", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4980/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4980/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4980/events", "html_url": "https://github.com/datalad/datalad/issues/4980", "id": 714037751, "node_id": "MDU6SXNzdWU3MTQwMzc3NTE=", "number": 4980, "title": "ORA remote does not handle HTTP403 responses properly", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1782622781, "node_id": "MDU6TGFiZWwxNzgyNjIyNzgx", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-important", "name": "severity-important", "color": "cc0000", "default": false, "description": "major effect on the usability of a package, without rendering it completely unusable to everyone"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-03T08:21:50Z", "updated_at": "2020-10-30T19:02:22Z", "closed_at": "2020-10-30T19:02:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here is the user facing side of the problem:\r\n\r\n```\r\ndatalad get archives/BnB1__Raw_Data__ADNI.7z           \r\n[WARNING] Running get resulted in stderr output: git-annex: get: 1 failed                   \r\n \r\n[ERROR  ] verification of content failed [get(/tmp/hoff/archived/brainbfast/archives/BnB1__Raw_Data__ADNI.7z)] \r\nget(error): /tmp/hoff/archived/brainbfast/archives/BnB1__Raw_Data__ADNI.7z (file) [verification of content failed]\r\n```\r\n\r\nIn the end it turned out that the `get` resulted in an HTTP-get to a RIA store via ORA remote, to a file to which the webserver had no read permissions. I think something like a \"permission denied\" should have been present in the error. But there wasn't.\r\n\r\nInstead, ORA remote happily succeeded and it took git-annex to detect the problem:\r\n\r\n[snippet from git-annex debug log]\r\n```\r\n[2020-10-03 09:43:19.427291019] git-annex-remote-ora[1] --> GETCONFIG url\r\n[2020-10-03 09:43:19.427404828] git-annex-remote-ora[1] <-- VALUE ria+http://archive.ds.inm7.de\r\n[2020-10-03 09:43:19.452510277] git-annex-remote-ora[1] --> GETCONFIG archive-id\r\n[2020-10-03 09:43:19.452649977] git-annex-remote-ora[1] <-- VALUE 736bcb04-7dea-4346-9bb8-a12cd2749b3f\r\n[2020-10-03 09:43:19.452814046] git-annex-remote-ora[1] --> GETCONFIG force-write\r\n[2020-10-03 09:43:19.452890226] git-annex-remote-ora[1] <-- VALUE \r\n[2020-10-03 09:43:19.453102956] git-annex-remote-ora[1] --> PREPARE-SUCCESS\r\n[2020-10-03 09:43:19.453183266] git-annex-remote-ora[1] <-- TRANSFER RETRIEVE MD5E-s315728551051--3a1a3e5e7fe6f6125122fe3b23922869.7z .git/annex/tmp/MD5E-s315728551051--3a1a3e5e7fe6f6125122fe3b23922869.7z\r\n[2020-10-03 09:43:19.453455865] git-annex-remote-ora[1] --> DIRHASH MD5E-s315728551051--3a1a3e5e7fe6f6125122fe3b23922869.7z\r\n[2020-10-03 09:43:19.453567055] git-annex-remote-ora[1] <-- VALUE pV/14/\r\n[2020-10-03 09:43:19.460246052] git-annex-remote-ora[1] --> PROGRESS 199\r\n0%    199 B             1 KiB/s 9y120d[2020-10-03 09:43:19.460532781] git-annex-remote-ora[1] --> TRANSFER-SUCCESS RETRIEVE MD5E-s315728551051--3a1a3e5e7fe6f6125122fe3b23922869.7z\r\n                                      \r\n  verification of content failed\r\n```\r\n(note the SUCESS at the end).\r\n\r\nIn contrast, a `wget` to the URL resulted in:\r\n\r\n```\r\nHTTP request sent, awaiting response... 403 Forbidden\r\n2020-10-03 09:47:15 ERROR 403: Forbidden.\r\n```\r\n\r\nAfter fixing the server-side issue, the `get` went fine. I think this issue is more than a convenience problem, because the initial download-success report impacts decision making down the line. It should at least fail, better with a proper message.\r\n\r\nPing @bpoldrack ", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4980/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4980/timeline", "performed_via_github_app": null}