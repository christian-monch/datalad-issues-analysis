{"url": "https://api.github.com/repos/datalad/datalad/issues/5064", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5064/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5064/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5064/events", "html_url": "https://github.com/datalad/datalad/issues/5064", "id": 726586953, "node_id": "MDU6SXNzdWU3MjY1ODY5NTM=", "number": 5064, "title": "asyncio-related competition->crash", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1782623847, "node_id": "MDU6TGFiZWwxNzgyNjIzODQ3", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-critical", "name": "severity-critical", "color": "ff0000", "default": false, "description": "makes it unusable, causes data loss, introduces security vulnerability"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-10-21T15:13:46Z", "updated_at": "2020-12-10T07:50:44Z", "closed_at": "2020-12-10T07:50:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "With present master\r\n\r\n```\r\n% ipython3\r\nPython 3.7.3 (default, Apr  3 2019, 05:39:12) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.18.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import datalad.api as dl\r\n\r\nIn [2]: dl.__version__\r\nTraceback (most recent call last):\r\n  File \"/home/mih/venvs/datalad/bin/ipython3\", line 8, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/IPython/__init__.py\", line 126, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/traitlets/config/application.py\", line 837, in launch_instance\r\n    app.start()\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/IPython/terminal/ipapp.py\", line 356, in start\r\n    self.shell.mainloop()\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/IPython/terminal/interactiveshell.py\", line 564, in mainloop\r\n    self.interact()\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/IPython/terminal/interactiveshell.py\", line 547, in interact\r\n    code = self.prompt_for_code()\r\n  File \"/home/mih/venvs/datalad/lib/python3.7/site-packages/IPython/terminal/interactiveshell.py\", line 478, in prompt_for_code\r\n    asyncio.set_event_loop(old_loop)\r\n  File \"/usr/lib/python3.7/asyncio/events.py\", line 757, in set_event_loop\r\n    get_event_loop_policy().set_event_loop(loop)\r\n  File \"/usr/lib/python3.7/asyncio/unix_events.py\", line 1117, in set_event_loop\r\n    self._watcher.attach_loop(loop)\r\n  File \"/usr/lib/python3.7/asyncio/unix_events.py\", line 868, in attach_loop\r\n    loop.add_signal_handler(signal.SIGCHLD, self._sig_chld)\r\n  File \"/usr/lib/python3.7/asyncio/unix_events.py\", line 86, in add_signal_handler\r\n    self._check_closed()\r\n  File \"/usr/lib/python3.7/asyncio/base_events.py\", line 480, in _check_closed\r\n    raise RuntimeError('Event loop is closed')\r\nRuntimeError: Event loop is closed\r\n\r\nIf you suspect this is an IPython 7.18.1 bug, please report it at:\r\n    https://github.com/ipython/ipython/issues\r\nor send an email to the mailing list at ipython-dev@python.org\r\n\r\nYou can print a more detailed traceback right now with \"%tb\", or use \"%debug\"\r\nto interactively debug it.\r\n\r\nExtra-detailed tracebacks for bug-reporting purposes can be enabled via:\r\n    %config Application.verbose_crash=True\r\n```\r\n\r\nThat is bad.\r\n\r\nI wonder if that traceback line in `IPython/terminal/interactiveshell.py` can provide inspiration. It seems as if one could \"manage\" a dedicated event loop, and we could close that one, instead of closing THE one. Just speculation at this point...didn't look.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5064/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5064/timeline", "performed_via_github_app": null}