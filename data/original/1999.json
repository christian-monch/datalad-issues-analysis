{"url": "https://api.github.com/repos/datalad/datalad/issues/1999", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1999/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1999/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1999/events", "html_url": "https://github.com/datalad/datalad/issues/1999", "id": 277114718, "node_id": "MDU6SXNzdWUyNzcxMTQ3MTg=", "number": 1999, "title": "crawling S3 bucket results in urlencode where not needed/desired ", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}, {"id": 440544386, "node_id": "MDU6TGFiZWw0NDA1NDQzODY=", "url": "https://api.github.com/repos/datalad/datalad/labels/fix-implemented", "name": "fix-implemented", "color": "0e8a16", "default": false, "description": "A fix is available, but has not been merged or released, yet."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-11-27T18:07:18Z", "updated_at": "2017-12-21T08:04:21Z", "closed_at": "2017-12-21T08:04:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\nwhile trying to crawl a test subject from hcp1200 ran into\r\n```\r\n[INFO   ] Need to download 5.3 MB from s3://hcp-openaccess/HCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_%5BLM-TEV-storoptcor-versus-storoptwro%5D_%5BOP-diff%5D_%5BBT-diff%5D_%5BMODE-planar%5D.mat?versionId=XRL.75mwQnzB1LVcsnArQo5dTVLFmkPp. No progress indication will be reported\r\n[WARNING] Caught AnnexBatchCommandError: command 'addurl'\r\nError, annex reported failure for addurl: {u'command': u'addurl', u'file': u's3://hcp-openaccess/HCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_%5BLM-TEV-storoptcor-versus-storoptwro%5D_%5BOP-diff%5D_%5BBT-diff%5D_%5BMODE-planar%5D.mat?versionId=XRL.75mwQnzB1LVcsnArQo5dTVLFmkPp', u'success': False} [annexrepo.py:add_url_to_file:2042] on trial #1. Sleeping 3.000000 and retrying\r\n```\r\nwhich is because of the filenames containing `[]`:\r\n```\r\n$> datalad ls s3://hcp-openaccess/HCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_                                                                                          \r\nConnecting to bucket: hcp-openaccess\r\n[INFO   ] S3 session: Connecting to the bucket hcp-openaccess \r\nBucket info:\r\n  Versioning: S3ResponseError: 403 Forbidden\r\n     Website: hcp-openaccess.s3-website-us-east-1.amazonaws.com\r\n         ACL: S3ResponseError: 403 Forbidden\r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumopt]_[BT-diff]_[MODE-mag].mat                                         2017-04-11T00:05:34.000Z 11417975 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumopt]_[BT-diff]_[MODE-planar].mat                                      2017-04-11T00:05:43.000Z  5227277 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumoptcor-versus-mathnumoptwro]_[OP-diff]_[BT-diff]_[MODE-mag].mat       2017-04-11T00:05:49.000Z 11400490 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumoptcor-versus-mathnumoptwro]_[OP-diff]_[BT-diff]_[MODE-planar].mat    2017-04-11T00:05:57.000Z  5297750 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumque-versus-mathoper]_[OP-diff]_[BT-diff]_[MODE-mag].mat               2017-04-11T00:06:02.000Z 11419983 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumque-versus-mathoper]_[OP-diff]_[BT-diff]_[MODE-planar].mat            2017-04-11T00:06:13.000Z  5297458 \r\nHCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-mathnumque]_[BT-diff]_[MODE-mag].mat                                         2017-04-11T00:06:19.000Z 11430844 \r\n...\r\n```\r\nand us somewhere urlencoding them (legit thing to do to guarantee healthy interactions with annex), but probably we would need to unencode them when actually initiating the interaction, since to download we need to provide them as is:\r\n```shell\r\n$> datalad download-url 's3://hcp-openaccess/HCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-storsentnon]_[BT-diff]_[MODE-mag].mat'\r\n[INFO   ] Downloading 's3://hcp-openaccess/HCP_1200/100307/MEG/StoryM/eravg/100307_MEG_StoryM_eravg_[LM-TEV-storsentnon]_[BT-diff]_[MODE-mag].mat' into '.' \r\n[INFO   ] S3 session: Connecting to the bucket hcp-openaccess \r\n```\r\n(yet to add reporting, now only progressbar appears and then disappears)", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1999/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1999/timeline", "performed_via_github_app": null}