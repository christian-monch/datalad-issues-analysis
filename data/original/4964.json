{"url": "https://api.github.com/repos/datalad/datalad/issues/4964", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4964/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4964/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4964/events", "html_url": "https://github.com/datalad/datalad/pull/4964", "id": 709035936, "node_id": "MDExOlB1bGxSZXF1ZXN0NDkzMTU2Njk3", "number": 4964, "title": "ENH: get: Avoid unnecessary checkout in subdataset update", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-25T15:41:42Z", "updated_at": "2020-10-07T20:10:11Z", "closed_at": "2020-10-07T20:09:51Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4964", "html_url": "https://github.com/datalad/datalad/pull/4964", "diff_url": "https://github.com/datalad/datalad/pull/4964.diff", "patch_url": "https://github.com/datalad/datalad/pull/4964.patch"}, "body": "gh-4853 reworked get() to avoid using repo.update_submodule().\r\n_install_subds_from_flexible_source() now has logic that\r\n\r\n  * tries a direct fetch if the target commit isn't available locally\r\n  * unconditionally checks out the target commit\r\n  * tries to avoid a detached HEAD by moving the originally checked\r\n    out branch back to HEAD if the branch contains HEAD\r\n\r\nIt does all of these even if the starting commit matches the target\r\ncommit.  The unconditional checkout means that we always end up in a\r\ndetached HEAD, leading to confusing messages like\r\n\r\n    [INFO ] Reset subdataset branch 'master' to b292d7e3 (from\r\n    b292d7e3) to avoid a detached HEAD\r\n\r\nMake all of the above logic happen only when the current commit\r\ndoesn't match the target.\r\n\r\n---\r\n\r\nNote: This is just adds an `if` condition and indentation.  A larger rework of this code is planned: <https://github.com/datalad/datalad/pull/4853#issuecomment-687567201>\r\n\r\n", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4964/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4964/timeline", "performed_via_github_app": null}