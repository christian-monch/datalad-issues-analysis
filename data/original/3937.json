{"url": "https://api.github.com/repos/datalad/datalad/issues/3937", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3937/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3937/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3937/events", "html_url": "https://github.com/datalad/datalad/issues/3937", "id": 538567839, "node_id": "MDU6SXNzdWU1Mzg1Njc4Mzk=", "number": 3937, "title": "make datalad --version report  git describe if `pip installed` from github", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778592, "node_id": "MDU6TGFiZWw2Mzc3ODU5Mg==", "url": "https://api.github.com/repos/datalad/datalad/labels/enhancement", "name": "enhancement", "color": "0052cc", "default": true, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-16T18:05:19Z", "updated_at": "2019-12-16T18:05:19Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "we do include `git describe` in  `datalad --version` whenever datalad installed from a local git clone via `pip install -e` (for development), but not when we `pip install` from github (or actually even from a local clone without `-e`)\r\n\r\n```\r\n(git-annex)lena:/tmp/study2[master]\r\n$> pip install git+https://github.com/datalad/datalad        \r\nCollecting git+https://github.com/datalad/datalad\r\n  Cloning https://github.com/datalad/datalad to /home/yoh/.tmp/pip-req-build-ejzfgu6m\r\n  Running command git clone -q https://github.com/datalad/datalad /home/yoh/.tmp/pip-req-build-ejzfgu6m\r\n  Running command git submodule update --init --recursive -q\r\nRequirement already satisfied (use --upgrade to upgrade): datalad==0.12.0rc6 from git+https://github.com/datalad/datalad in /tmp/venvs/dev3/lib/python3.7/site-packages\r\nRequirement already satisfied: appdirs in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (1.4.3)\r\nRequirement already satisfied: chardet>=3.0.4 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (3.0.4)\r\nRequirement already satisfied: GitPython>=2.1.8 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (3.0.4)\r\nRequirement already satisfied: iso8601 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (0.1.11)\r\nRequirement already satisfied: humanize in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (0.5.1)\r\nRequirement already satisfied: fasteners in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (0.14.1)\r\nRequirement already satisfied: patool>=1.7 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (1.12)\r\nRequirement already satisfied: tqdm in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (4.30.0)\r\nRequirement already satisfied: wrapt in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (1.11.2)\r\nRequirement already satisfied: boto in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (2.49.0)\r\nRequirement already satisfied: keyring>=8.0 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (18.0.1)\r\nRequirement already satisfied: keyrings.alt in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (3.1.1)\r\nRequirement already satisfied: msgpack in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (0.5.6)\r\nRequirement already satisfied: requests>=1.2 in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (2.21.0)\r\nRequirement already satisfied: jsmin in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (2.2.2)\r\nRequirement already satisfied: PyGithub in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (1.43.7)\r\nRequirement already satisfied: simplejson in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (3.16.0)\r\nRequirement already satisfied: whoosh in /usr/lib/python3/dist-packages (from datalad==0.12.0rc6) (2.7.4)\r\nRequirement already satisfied: secretstorage in /usr/lib/python3/dist-packages (from keyring>=8.0->datalad==0.12.0rc6) (2.3.1)\r\nBuilding wheels for collected packages: datalad\r\n  Building wheel for datalad (setup.py) ... done\r\n  Created wheel for datalad: filename=datalad-0.12.0rc6-cp37-none-any.whl size=1442149 sha256=8cc0c45f8b0428748784719d1883643b4155643756d9cbb8f2ca43a4d146fade\r\n  Stored in directory: /home/yoh/.tmp/pip-ephem-wheel-cache-qpcsrho6/wheels/b8/22/87/6c24855d3db6b8b480a807badbb1d3b451aa9997566170f992\r\nSuccessfully built datalad\r\npip install git+https://github.com/datalad/datalad  6.30s user 1.03s system 35% cpu 20.359 total\r\n\r\n$> datalad --version\r\ndatalad 0.12.0rc6\r\n```\r\n\r\nI think we should do something like nibabel does with\r\n```\r\n$> cat .gitattributes \r\nnibabel/COMMIT_INFO.txt export-subst\r\n```\r\nand if I `pip install --upgrade git+https://github.com/nipy/nibabel` I do get proper `__verison__` like `3.0.0rc2+1.gd1518aa7`.  So I guess it might be that which makes it happen and we should support that too", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3937/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3937/timeline", "performed_via_github_app": null}