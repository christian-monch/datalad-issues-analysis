{"url": "https://api.github.com/repos/datalad/datalad/issues/2267", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2267/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2267/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2267/events", "html_url": "https://github.com/datalad/datalad/pull/2267", "id": 302434890, "node_id": "MDExOlB1bGxSZXF1ZXN0MTcyOTY2Njk4", "number": 2267, "title": "Locking at the repo level for datalad-archives", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 449733138, "node_id": "MDU6TGFiZWw0NDk3MzMxMzg=", "url": "https://api.github.com/repos/datalad/datalad/labels/WIP", "name": "WIP", "color": "fbca04", "default": false, "description": "work in progress"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-05T19:43:46Z", "updated_at": "2018-03-07T14:08:09Z", "closed_at": "2018-03-07T14:08:09Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/2267", "html_url": "https://github.com/datalad/datalad/pull/2267", "diff_url": "https://github.com/datalad/datalad/pull/2267.diff", "patch_url": "https://github.com/datalad/datalad/pull/2267.patch"}, "body": "This pull request fixes #???\r\n\r\nI thought that if I make our datalad-archives refuse to prepare the 2nd instance, git-annex would just use the single instance of the custom special remote while downloading files, but it is not the case:\r\nhttp://git-annex.branchable.com/bugs/howto_guarantee_a_single_instance_of_a_special_remote__63__/\r\n\r\nso this one is just to see what else would break.\r\n\r\nIdeally we should just lock \"per file/operation\", i.e. if I need to get a file - we lock for that operation and then other instances would just wait for that.  Similar for \"extraction\" and possibly \"Cleanup\". This way they could all co-exist in parallel while waiting for another instance to take care about getting the file, or may be meanwhile requesting another archive (if such rare case happens) and extracting it to serve individual files \"in parallel\" to git-annex\r\n\r\n### Changes\r\n- [ ] This change is complete\r\n\r\nPlease have a look @datalad/developers\r\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2267/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2267/timeline", "performed_via_github_app": null}