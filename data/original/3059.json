{"url": "https://api.github.com/repos/datalad/datalad/issues/3059", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3059/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3059/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3059/events", "html_url": "https://github.com/datalad/datalad/issues/3059", "id": 387610460, "node_id": "MDU6SXNzdWUzODc2MTA0NjA=", "number": 3059, "title": "`install` error reporting suboptimal (hidden permission denied)", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-05T06:22:48Z", "updated_at": "2019-12-21T14:02:20Z", "closed_at": "2019-12-21T14:02:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here is what it looks like to try to install a dataset via SSH when the server rejects the credentials:\r\n\r\n```\r\n(datalad3-dev) 1 mih@zing ~/pd/scratch % datalad install -s git@github.com:datalad/datalad-revolution.git dummy\r\n[INFO   ] Cloning git@github.com:datalad/datalad-revolution.git into '/home/mih/pd/scratch/dummy' \r\nPermission denied (publickey).\r\n[WARNING] Failed to run cmd ['ssh', '-fN', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=\"/home/mih/.cache/datalad/sockets/bebac456\"', 'git@github.com']. Exit code=255\r\n| stdout: None\r\n| stderr: None \r\n[ERROR  ] Failed to clone from any candidate source URL. Encountered errors per each url were: (OrderedDict([('git@github.com:datalad/datalad-revolution.git', \"Cmd('/usr/lib/git-annex.linux/git') failed due to: exit code(128)\\n  cmdline: /usr/lib/git-annex.linux/git clone --progress -v git@github.com:datalad/datalad-revolution.git /home/mih/pd/scratch/dummy [cmd.py:wait:415]\")]),) [install(/home/mih/pd/scratch/dummy)] \r\ninstall(error): /home/mih/pd/scratch/dummy (dataset) [Failed to clone from any candidate source URL. Encountered errors per each url were: (OrderedDict([('git@github.com:datalad/datalad-revolution.git', \"Cmd('/usr/lib/git-annex.linux/git') failed due to: exit code(128)\\n  cmdline: /usr/lib/git-annex.linux/git clone --progress -v git@github.com:datalad/datalad-revolution.git /home/mih/pd/scratch/dummy [cmd.py:wait:415]\")]),)]\r\n```\r\n\r\nIn this report it doesn't look that bad, as the second line will report the actual problem. However, in a terminal this is a rather faint \"INFO\" message that is followed by a bright yellow WARNING that is merely a report of the command that revealed the issue, which in turn is followed by a bright red warning with the nitty gritty of what happened inside.\r\n\r\nI think the error reporting has it almost exactly backwards. All of this information is the report of a single error that should be caught at the top-level and turned into a comprehensible error message for human consumption. I'd argue that 'permission denied' is one of the most frequent errors that occur in real life usage of install, and this should be done properly.\r\n\r\nI am aware of this being part of a longer list of attempts that could have worked if this would have been a subdataset. but it isn't and this is like one of the first commands that DataLad users will approach.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3059/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3059/timeline", "performed_via_github_app": null}