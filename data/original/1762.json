{"url": "https://api.github.com/repos/datalad/datalad/issues/1762", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1762/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1762/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1762/events", "html_url": "https://github.com/datalad/datalad/issues/1762", "id": 252890024, "node_id": "MDU6SXNzdWUyNTI4OTAwMjQ=", "number": 1762, "title": "YAFTP -- yet another failure to publish", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}, {"id": 440544386, "node_id": "MDU6TGFiZWw0NDA1NDQzODY=", "url": "https://api.github.com/repos/datalad/datalad/labels/fix-implemented", "name": "fix-implemented", "color": "0e8a16", "default": false, "description": "A fix is available, but has not been merged or released, yet."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-08-25T12:45:12Z", "updated_at": "2017-08-26T07:15:35Z", "closed_at": "2017-08-26T07:15:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Note: demo.datalad.org is 127.0.0.1\r\n\r\n```sh\r\nmih@meiner /tmp % datalad create demo\r\n[INFO   ] Creating a new annex repo at /tmp/demo \r\ncreate(ok): /tmp/demo (dataset)                                                                                       \r\n\r\nmih@meiner /tmp % cd demo\r\nmih@meiner /tmp/demo (git)-[master] % dd if=/dev/urandom of=big.dat bs=1M count=1\r\n1+0 records in\r\n1+0 records out\r\n1048576 bytes (1,0 MB, 1,0 MiB) copied, 0,0297882 s, 35,2 MB/s\r\n\r\nmih@meiner /tmp/demo (git)-[master] % datalad add big.dat\r\nadd(ok): /tmp/demo/big.dat (file)                                                                                     \r\nsave(ok): /tmp/demo (dataset)\r\naction summary:\r\n  add (ok: 1)\r\n  save (ok: 1)\r\n\r\nmih@meiner /tmp/demo (git)-[master] % datalad create-sibling -s myserver demo.datalad.org:public_html/publish-demo --target-url http://demo.datalad.org/publish-demo/.git\r\n[INFO   ] Connecting ... \r\n[INFO   ] Considering to create a target dataset /tmp/demo at public_html/publish-demo of demo.datalad.org \r\n[INFO   ] Updating dataset '/tmp/demo' ... \r\n.: myserver(+) [http://demo.datalad.org/publish-demo/.git (git)]\r\n[INFO   ] Adjusting remote git configuration \r\n[INFO   ] Enabling git post-update hook ... \r\n[INFO   ] Running post-update hooks in all created siblings \r\ncreate_sibling(ok): . (dataset)\r\n\r\nmih@meiner /tmp/demo (git)-[master] % datalad publish --to myserver --transfer-data all\r\n[INFO   ] Publishing <Dataset path=/tmp/demo> data to myserver \r\npublish(ok): big.dat (file)                                                                                           \r\n[INFO   ] Publishing <Dataset path=/tmp/demo> to myserver                                                             \r\nNo handlers could be found for logger \"git.remote\"\r\n[ERROR  ] failed to push to myserver: git-annex -> myserver/git-annex [rejected] (fetch first); pushed: ['[new branch]'] [publish(/tmp/demo)] \r\npublish(error): . (dataset) [failed to push to myserver: git-annex -> myserver/git-annex [rejected] (fetch first); pushed: ['[new branch]']]\r\naction summary:\r\n  publish (error: 1, ok: 1)\r\n\r\nmih@meiner /tmp/demo (git)-[master] % datalad publish --to myserver --transfer-data all\r\n[INFO   ] Will publish updated git-annex \r\n[INFO   ] Publishing <Dataset path=/tmp/demo> data to myserver \r\n[INFO   ] Publishing <Dataset path=/tmp/demo> to myserver \r\npublish(ok): . (dataset) [pushed to myserver: ['[up to date]', '8977a5f..77a3476']]\r\nmih@meiner /tmp/demo (git)-[master] %                                                                                \r\n```\r\n\r\nBottom-line: Something fails the first time, but works the second time around.\r\n\r\nNow the same thing, again from scratch, but this time without `--target-url` in the `create_sibling` call -- instant success:\r\n\r\n```sh\r\nmih@meiner /tmp % datalad create demo\r\n[INFO   ] Creating a new annex repo at /tmp/demo \r\ncreate(ok): /tmp/demo (dataset)                                                                                       \r\nmih@meiner /tmp % cd demo\r\nmih@meiner /tmp/demo (git)-[master] % dd if=/dev/urandom of=big.dat bs=1M count=1\r\n1+0 records in\r\n1+0 records out\r\n1048576 bytes (1,0 MB, 1,0 MiB) copied, 0,00984292 s, 107 MB/s\r\nmih@meiner /tmp/demo (git)-[master] % datalad create-sibling -s myserver demo.datalad.org:public_html/publish-demo\r\n[INFO   ] Connecting ... \r\n[INFO   ] Considering to create a target dataset /tmp/demo at public_html/publish-demo of demo.datalad.org \r\n[INFO   ] Updating dataset '/tmp/demo' ... \r\n.: myserver(+) [demo.datalad.org:public_html/publish-demo (git)]\r\n[INFO   ] Adjusting remote git configuration \r\n[INFO   ] Enabling git post-update hook ... \r\n[INFO   ] Running post-update hooks in all created siblings \r\ncreate_sibling(ok): . (dataset)\r\nmih@meiner /tmp/demo (git)-[master] % datalad publish --to myserver --transfer-data all\r\n[INFO   ] Publishing <Dataset path=/tmp/demo> data to myserver \r\n[INFO   ] Publishing <Dataset path=/tmp/demo> to myserver \r\npublish(ok): . (dataset) [pushed to myserver: ['ac41031..5b3e79c', '[new branch]']]\r\n```\r\n\r\nWhat is it?", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1762/timeline", "performed_via_github_app": null}