{"url": "https://api.github.com/repos/datalad/datalad/issues/3224", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3224/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3224/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3224/events", "html_url": "https://github.com/datalad/datalad/issues/3224", "id": 421324130, "node_id": "MDU6SXNzdWU0MjEzMjQxMzA=", "number": 3224, "title": "A few issues while running the tests on conda installed new annex and datalad", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-03-15T02:21:30Z", "updated_at": "2020-10-13T18:59:11Z", "closed_at": "2020-10-13T18:59:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "just so we know\r\n\r\n```shell\r\n$> datalad --version\r\ndatalad 0.11.3\r\n\r\n$> python -m nose -s -v datalad\r\n....\r\ndatalad.tests.test_version.test__version__ ... SKIP: no /home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/tests/../../CHANGELOG.md found\r\nVersions: appdirs=1.4.3 boto=2.49.0 cmd:annex=7.20190219-g16f7885 cmd:git=2.19.1 cmd:system-git=2.19.1 cmd:system-ssh=7.9p1 exifread=2.1.2 git=2.1.11 gitdb=2.0.5 humanize=0.5.1 iso8601=0.1.12 keyring=18.0.0 keyrings.alt=3.1 msgpack=0.6.1 mutagen=1.41.1 patoolib=1.12 requests=2.21.0 six=1.12.0 tqdm=4.31.1 wrapt=1.11.1\r\nObscure filename: str=b' \"\\';a&b&c\\xce\\x94\\xd0\\x99\\xd7\\xa7\\xd9\\x85\\xe0\\xb9\\x97\\xe3\\x81\\x82 `| ' repr=' \"\\';a&b&c\u0394\u0419\u05e7\u0645\u0e57\u3042 `| '\r\nEncodings: default='utf-8' filesystem='utf-8' locale.prefered='UTF-8'\r\nEnvironment: PATH='/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/bin:/home/yoh/anaconda-2018.12-3.7/bin:/home/yoh/gocode/bin:/home/yoh/gocode/bin:/home/yoh/bin:/home/yoh/.local/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/snap/bin:/sbin:/usr/sbin:/usr/local/sbin' LANG='en_US.utf8' GIT_PAGER='less --no-init --quit-if-one-screen' GIT_PYTHON_GIT_EXECUTABLE='/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/bin/git'\r\nERROR\r\nException ignored in: <function _Database.close at 0x7fb50841f9d8>\r\nTraceback (most recent call last):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/dbm/dumb.py\", line 284, in close\r\n    self._commit()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/dbm/dumb.py\", line 135, in _commit\r\n    with self._io.open(self._dirfile, 'w', encoding=\"Latin-1\") as f:\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/yoh/.tmp/datalad_temp_22j7xv4a/.config/datalad/cookies.dir'\r\n\r\n======================================================================\r\nERROR: datalad.distribution.tests.test_add.test_add_mimetypes\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/tests/utils.py\", line 442, in newfunc\r\n    return t(*(arg + (d,)), **kw)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/tests/test_add.py\", line 398, in test_add_mimetypes\r\n    __not_tested__ = ds.add(['file.txt', 'empty'])\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/dataset.py\", line 524, in apply_func\r\n    return f(**kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 491, in eval_func\r\n    return return_func(generator_func)(*args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 479, in return_func\r\n    results = list(results)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 428, in generator_func\r\n    result_renderer, result_xfm, _result_filter, **_kwargs):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 521, in _process_results\r\n    for res in results:\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/add.py\", line 422, in __call__\r\n    for a in added:\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 1602, in add_\r\n    expect_stderr=True):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 2504, in _run_annex_command_json\r\n    raise e\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 2416, in _run_annex_command_json\r\n    **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 1095, in _run_annex_command\r\n    env=env, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/gitrepo.py\", line 1800, in _run_command_files_split\r\n    *args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/cmd.py\", line 683, in run\r\n    cmd, env=self.get_git_environ_adjusted(env), *args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/cmd.py\", line 542, in run\r\n    raise CommandError(text_type(cmd), msg, status, out[0], out[1])\r\ndatalad.support.exceptions.CommandError: CommandError: command '['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'add', '--json', '--', '/home/yoh/.tmp/datalad_temp_tree_test_add_mimetypesj9jcge73/file.txt', '/home/yoh/.tmp/datalad_temp_tree_test_add_mimetypesj9jcge73/empty']' failed with exitcode 1\r\nFailed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'add', '--json', '--', '/home/yoh/.tmp/datalad_temp_tree_test_add_mimetypesj9jcge73/file.txt', '/home/yoh/.tmp/datalad_temp_tree_test_add_mimetypesj9jcge73/empty'] under '/home/yoh/.tmp/datalad_temp_tree_test_add_mimetypesj9jcge73'. Exit code=1.\r\n\r\n======================================================================\r\nERROR: datalad.distribution.tests.test_create.test_create_text_no_annex\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/tests/utils.py\", line 615, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/tests/test_create.py\", line 350, in test_create_text_no_annex\r\n    ds.add(['t', 'b'])\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/dataset.py\", line 524, in apply_func\r\n    return f(**kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 491, in eval_func\r\n    return return_func(generator_func)(*args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 479, in return_func\r\n    results = list(results)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 428, in generator_func\r\n    result_renderer, result_xfm, _result_filter, **_kwargs):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/interface/utils.py\", line 521, in _process_results\r\n    for res in results:\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/distribution/add.py\", line 422, in __call__\r\n    for a in added:\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 1602, in add_\r\n    expect_stderr=True):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 2504, in _run_annex_command_json\r\n    raise e\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 2416, in _run_annex_command_json\r\n    **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/annexrepo.py\", line 1095, in _run_annex_command\r\n    env=env, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/gitrepo.py\", line 1800, in _run_command_files_split\r\n    *args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/cmd.py\", line 683, in run\r\n    cmd, env=self.get_git_environ_adjusted(env), *args, **kwargs)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/cmd.py\", line 542, in run\r\n    raise CommandError(text_type(cmd), msg, status, out[0], out[1])\r\ndatalad.support.exceptions.CommandError: CommandError: command '['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'add', '--json', '--', '/home/yoh/.tmp/datalad_temp_test_create_text_no_annex97xxwyu0/t', '/home/yoh/.tmp/datalad_temp_test_create_text_no_annex97xxwyu0/b']' failed with exitcode 1\r\nFailed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'annex', 'add', '--json', '--', '/home/yoh/.tmp/datalad_temp_test_create_text_no_annex97xxwyu0/t', '/home/yoh/.tmp/datalad_temp_test_create_text_no_annex97xxwyu0/b'] under '/home/yoh/.tmp/datalad_temp_test_create_text_no_annex97xxwyu0'. Exit code=1.\r\n\r\n======================================================================\r\nERROR: test suite for <module 'datalad' from '/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/__init__.py'>\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/suite.py\", line 228, in run\r\n    self.tearDown()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/suite.py\", line 351, in tearDown\r\n    self.teardownContext(ancestor)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/suite.py\", line 367, in teardownContext\r\n    try_run(context, names)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/nose/util.py\", line 471, in try_run\r\n    return func()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/__init__.py\", line 216, in teardown_package\r\n    cookies_db.close()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/site-packages/datalad/support/cookies.py\", line 62, in close\r\n    self._cookies_db.close()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/shelve.py\", line 144, in close\r\n    self.sync()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/shelve.py\", line 168, in sync\r\n    self[key] = entry\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/shelve.py\", line 125, in __setitem__\r\n    self.dict[key.encode(self.keyencoding)] = f.getvalue()\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/dbm/dumb.py\", line 216, in __setitem__\r\n    self._index[key] = self._setval(pos, val)\r\n  File \"/home/yoh/anaconda-4.4.0-3.6/envs/git-annex-test/lib/python3.7/dbm/dumb.py\", line 178, in _setval\r\n    with _io.open(self._datfile, 'rb+') as f:\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/yoh/.tmp/datalad_temp_22j7xv4a/.config/datalad/cookies.dat'\r\n\r\n----------------------------------------------------------------------\r\nRan 889 tests in 913.608s\r\n\r\nFAILED (SKIP=82, errors=3)\r\npython -m nose -s -v datalad  531.20s user 383.20s system 99% cpu 15:14.95 total\r\n\r\n```", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3224/timeline", "performed_via_github_app": null}