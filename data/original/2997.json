{"url": "https://api.github.com/repos/datalad/datalad/issues/2997", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2997/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2997/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2997/events", "html_url": "https://github.com/datalad/datalad/issues/2997", "id": 380825673, "node_id": "MDU6SXNzdWUzODA4MjU2NzM=", "number": 2997, "title": "create-sibling: permission denied errors on .git/*  ", "user": {"login": "tedstrauss", "id": 930560, "node_id": "MDQ6VXNlcjkzMDU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/930560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tedstrauss", "html_url": "https://github.com/tedstrauss", "followers_url": "https://api.github.com/users/tedstrauss/followers", "following_url": "https://api.github.com/users/tedstrauss/following{/other_user}", "gists_url": "https://api.github.com/users/tedstrauss/gists{/gist_id}", "starred_url": "https://api.github.com/users/tedstrauss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tedstrauss/subscriptions", "organizations_url": "https://api.github.com/users/tedstrauss/orgs", "repos_url": "https://api.github.com/users/tedstrauss/repos", "events_url": "https://api.github.com/users/tedstrauss/events{/privacy}", "received_events_url": "https://api.github.com/users/tedstrauss/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-14T18:17:38Z", "updated_at": "2018-11-15T17:59:19Z", "closed_at": "2018-11-15T17:59:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nI am attempting to run `create-sibling` to clone the datalad project onto a remote server and write the web GUI for publishing the project. I am getting several `Permission denied` errors about writing to files in the `.git` folder of the remote location. I have set directory owners and permissions properly but it doesn't fix it. See the trace below.\r\n\r\nDoes the python code run git commands as another user?\r\n\r\n```\r\ndatalad@home$ datalad -l 2 create-sibling -r --ui true --existing reconfigure --target-dir /var/www/html/dist  datalad@dist.myserver.ca:/var/www/html/dist\r\n[DEBUG  ] Command line args 1st pass. Parsed: Namespace() Unparsed: ['create-sibling', '-r', '--ui', 'true', '--existing', 'reconfigure', '--target-dir', '/var/www/html/dist', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[DEBUG  ] Discovering plugins \r\n[Level 5] Importing module datalad.distribution.create_sibling  \r\n[DEBUG  ] Building doc for <class 'datalad.interface.annotate_paths.AnnotatePaths'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.update.Update'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.siblings.Siblings'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.create_sibling.CreateSibling'> \r\n[Level 5] Finished setup_parser \r\n[DEBUG  ] Parsing known args among ['/usr/local/bin/datalad', '-l', '2', 'create-sibling', '-r', '--ui', 'true', '--existing', 'reconfigure', '--target-dir', '/var/www/html/dist', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.create_sibling.CreateSibling'> \r\n[Level 5] Parsed ri /path/to/data/MRI1 into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': '/path/to/data/MRI1', 'password': '', 'port': ''} \r\n[Level 5] Detected file ri \r\n[DEBUG  ] Resolved dataset for creating a sibling: <Dataset path=/path/to/data/MRI1> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 9] Running: ['git', 'annex', 'version', '--raw'] \r\n[Level 8] Finished running ['git', 'annex', 'version', '--raw'] with status 0 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[Level 5] Found 1 previous connections \r\n[Level 9] Running: ['git', 'config', 'user.name'] \r\n[Level 8] Finished running ['git', 'config', 'user.name'] with status 0 \r\n[Level 9] Running: ['git', 'config', 'user.email'] \r\n[Level 8] Finished running ['git', 'config', 'user.email'] with status 0 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin', '--file', '/path/to/data/MRI1/.datalad/config'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin', '--file', '/path/to/data/MRI1/.datalad/config'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[Level 5] Parsed ri datalad@dist.myserver.ca:/var/www/html/dist into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': 'datalad@dist.myserver.ca:/var/www/html/dist', 'password': '', 'port': ''} \r\n[Level 5] Detected ssh ri \r\n[DEBUG  ] No sibling name given, use URL hostname 'dist.myserver.ca' as sibling name \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.interface.annotate_paths.AnnotatePaths'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Building doc for <class 'datalad.interface.save.Save'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.add.Add'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.subdatasets.Subdatasets'> \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.subdatasets.Subdatasets'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Resolved dataset for subdataset reporting/modification: <Dataset path=/path/to/data/MRI1> \r\n[Level 9] Running: ['git', 'ls-files', '--stage', '-z'] \r\n[Level 8] Finished running ['git', 'ls-files', '--stage', '-z'] with status 0 \r\n[Level 5] Parsed ri /path/to/data/MRI1/sub-STJ82860572941V0120181112132504070 into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070', 'password': '', 'port': ''} \r\n[Level 5] Detected file ri \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1/sub-STJ82860572941V0120181112132504070 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin', '--file', u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070/.datalad/config'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin', '--file', u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070/.datalad/config'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[INFO   ] Connecting ... \r\n[Level 5] Not opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) for checking since /localhome/datalad/.cache/datalad/sockets/a65ea871 does not exist \r\n[Level 5] Not opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) for checking since /localhome/datalad/.cache/datalad/sockets/a65ea871 does not exist \r\n[DEBUG  ] Opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-fN', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', \"sh -e -c 'dirname $(readlink -f $(which git-annex-shell))'\"] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', \"sh -e -c 'dirname $(readlink -f $(which git-annex-shell))'\"] with status 0 \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git annex version --raw'] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git annex version --raw'] with status 0 \r\n[INFO   ] Considering to create a target dataset /path/to/data/MRI1 at /var/www/html/dist of dist.myserver.ca \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; ls /var/www/html/dist'] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; ls /var/www/html/dist'] with status 0 \r\n[DEBUG  ] Trying to rmdir /var/www/html/dist on remote since might be an empty dir \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; rmdir /var/www/html/dist'] \r\n[Level 9] Failed to run ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; rmdir /var/www/html/dist'] under None. Exit code=1. out= err=rmdir: failed to remove '/var/www/html/dist': Permission denied\r\n|  \r\n[INFO   ] Target path /var/www/html/dist already exists. And it fails to rmdir (rmdir: failed to remove '/var/www/html/dist': Permission denied). Will only reconfigure \r\n[DEBUG  ] Adding the siblings \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.siblings.Siblings'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Resolved dataset for sibling configuration: <Dataset path=/path/to/data/MRI1> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 9] Running: ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[Level 11] Failed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] under '/path/to/data/MRI1'. Exit code=128. out= err=error: could not lock config file .git/config: Permission denied\r\n| fatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n|  \r\nFailed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] under '/path/to/data/MRI1'. Exit code=128. out= err=error: could not lock config file .git/config: Permission denied\r\nfatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n\r\nerror: could not lock config file .git/config: Permission denied\r\nfatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n[Level 5] Exiting \r\n[DEBUG  ] Closing 1 SSH connections... \r\n[DEBUG  ] Closing SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\ndatalad@endex:/path/to/data/MRI1$ clear\r\ndatalad@endex:/path/to/data/MRI1$ datalad -l 1 create-sibling -r --ui true --existing reconfigure --target-dir /var/www/html/dist  datalad@dist.myserver.ca:/var/www/html/dist\r\n[DEBUG  ] Command line args 1st pass. Parsed: Namespace() Unparsed: ['create-sibling', '-r', '--ui', 'true', '--existing', 'reconfigure', '--target-dir', '/var/www/html/dist', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[DEBUG  ] Discovering plugins \r\n[Level 5] Importing module datalad.distribution.create_sibling  \r\n[DEBUG  ] Building doc for <class 'datalad.interface.annotate_paths.AnnotatePaths'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.update.Update'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.siblings.Siblings'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.create_sibling.CreateSibling'> \r\n[Level 5] Finished setup_parser \r\n[DEBUG  ] Parsing known args among ['/usr/local/bin/datalad', '-l', '1', 'create-sibling', '-r', '--ui', 'true', '--existing', 'reconfigure', '--target-dir', '/var/www/html/dist', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.create_sibling.CreateSibling'> \r\n[Level 5] Parsed ri /path/to/data/MRI1 into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': '/path/to/data/MRI1', 'password': '', 'port': ''} \r\n[Level 5] Detected file ri \r\n[DEBUG  ] Resolved dataset for creating a sibling: <Dataset path=/path/to/data/MRI1> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 9] Running: ['git', 'annex', 'version', '--raw'] \r\n[Level 8] Finished running ['git', 'annex', 'version', '--raw'] with status 0 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[Level 5] Found 1 previous connections \r\n[Level 9] Running: ['git', 'config', 'user.name'] \r\n[Level 8] Finished running ['git', 'config', 'user.name'] with status 0 \r\n[Level 9] Running: ['git', 'config', 'user.email'] \r\n[Level 8] Finished running ['git', 'config', 'user.email'] with status 0 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin', '--file', '/path/to/data/MRI1/.datalad/config'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin', '--file', '/path/to/data/MRI1/.datalad/config'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[Level 5] Parsed ri datalad@dist.myserver.ca:/var/www/html/dist into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': 'datalad@dist.myserver.ca:/var/www/html/dist', 'password': '', 'port': ''} \r\n[Level 5] Detected ssh ri \r\n[DEBUG  ] No sibling name given, use URL hostname 'dist.myserver.ca' as sibling name \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.interface.annotate_paths.AnnotatePaths'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Building doc for <class 'datalad.interface.save.Save'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.add.Add'> \r\n[DEBUG  ] Building doc for <class 'datalad.distribution.subdatasets.Subdatasets'> \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.subdatasets.Subdatasets'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Resolved dataset for subdataset reporting/modification: <Dataset path=/path/to/data/MRI1> \r\n[Level 9] Running: ['git', 'ls-files', '--stage', '-z'] \r\n[Level 8] Finished running ['git', 'ls-files', '--stage', '-z'] with status 0 \r\n[Level 5] Parsed ri /path/to/data/MRI1/sub-STJ82860572941V0120181112132504070 into fields {'username': '', 'scheme': '', 'fragment': '', 'hostname': '', 'query': '', 'path': u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070', 'password': '', 'port': ''} \r\n[Level 5] Detected file ri \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1/sub-STJ82860572941V0120181112132504070 \r\n[Level 9] Running: ['git', 'version'] \r\n[Level 8] Finished running ['git', 'version'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin', '--file', u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070/.datalad/config'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin', '--file', u'/path/to/data/MRI1/sub-STJ82860572941V0120181112132504070/.datalad/config'] with status 0 \r\n[Level 9] Running: ['git', 'config', '-z', '-l', '--show-origin'] \r\n[Level 8] Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0 \r\n[INFO   ] Connecting ... \r\n[Level 5] Not opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) for checking since /localhome/datalad/.cache/datalad/sockets/a65ea871 does not exist \r\n[Level 5] Not opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) for checking since /localhome/datalad/.cache/datalad/sockets/a65ea871 does not exist \r\n[DEBUG  ] Opening SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-fN', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', \"sh -e -c 'dirname $(readlink -f $(which git-annex-shell))'\"] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', \"sh -e -c 'dirname $(readlink -f $(which git-annex-shell))'\"] with status 0 \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git annex version --raw'] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; git annex version --raw'] with status 0 \r\n[INFO   ] Considering to create a target dataset /path/to/data/MRI1 at /var/www/html/dist of dist.myserver.ca \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; ls /var/www/html/dist'] \r\n[Level 8] Finished running ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; ls /var/www/html/dist'] with status 0 \r\n[DEBUG  ] Trying to rmdir /var/www/html/dist on remote since might be an empty dir \r\n[DEBUG  ] Checking SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'check', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n[DEBUG  ] Check of SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) has succeeded \r\n[Level 9] Running: ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; rmdir /var/www/html/dist'] \r\n[Level 9] Failed to run ['ssh', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca', 'export \"PATH=/usr/lib/git-annex.linux:$PATH\"; rmdir /var/www/html/dist'] under None. Exit code=1. out= err=rmdir: failed to remove '/var/www/html/dist': Permission denied\r\n|  \r\n[INFO   ] Target path /var/www/html/dist already exists. And it fails to rmdir (rmdir: failed to remove '/var/www/html/dist': Permission denied). Will only reconfigure \r\n[DEBUG  ] Adding the siblings \r\n[DEBUG  ] Determined class of decorated function: <class 'datalad.distribution.siblings.Siblings'> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[DEBUG  ] Resolved dataset for sibling configuration: <Dataset path=/path/to/data/MRI1> \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 5] Detected <class 'datalad.support.annexrepo.AnnexRepo'> at /path/to/data/MRI1 \r\n[Level 9] Running: ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] \r\n[Level 11] Failed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] under '/path/to/data/MRI1'. Exit code=128. out= err=error: could not lock config file .git/config: Permission denied\r\n| fatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n|  \r\nFailed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'remote', 'add', 'dist.myserver.ca', 'datalad@dist.myserver.ca:/var/www/html/dist'] under '/path/to/data/MRI1'. Exit code=128. out= err=error: could not lock config file .git/config: Permission denied\r\nfatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n\r\nerror: could not lock config file .git/config: Permission denied\r\nfatal: could not set 'remote.dist.myserver.ca.url' to 'datalad@dist.myserver.ca:/var/www/html/dist'\r\n[Level 5] Exiting \r\n[DEBUG  ] Closing 1 SSH connections... \r\n[DEBUG  ] Closing SSHConnection(ctrl_path=<<'/localhome/datalad/.c...>>, sshri=<<SSHRI(hostname='dist.b...>>) by calling ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 9] Running: ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] \r\n[Level 8] Finished running ['ssh', '-O', 'stop', '-o', 'ControlPath=\"/localhome/datalad/.cache/datalad/sockets/a65ea871\"', 'datalad@dist.myserver.ca'] with status 0 \r\n```\r\n\r\n#### What steps will reproduce the problem?\r\n\r\n`datalad -l 9 create-sibling -r --ui true --existing reconfigure --target-dir /var/www/html/dist  datalad@dist.myserver.edu:/var/www/html/dist`\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\n\r\ndatalad 0.11.0\r\n\r\n```\r\n$ datalad wtf\r\n/usr/local/lib/python2.7/dist-packages/dicom/__init__.py:53: UserWarning: \r\nThis code is using an older version of pydicom, which is no longer \r\nmaintained as of Jan 2017.  You can access the new pydicom features and API \r\nby installing `pydicom` from PyPI.\r\nSee 'Transitioning to pydicom 1.x' section at pydicom.readthedocs.org \r\nfor more information.\r\n\r\n  warnings.warn(msg)\r\n/usr/local/lib/python2.7/dist-packages/bids/grabbids/__init__.py:6: FutureWarning: grabbids has been renamed to layout in version 0.6.5, and will be removed in version 0.8\r\n  warnings.warn(\"grabbids has been renamed to layout in version 0.6.5, and will be removed in version 0.8\", FutureWarning)\r\n# WTF\r\n- path: /scratch/box/webdav/box/MRI1\r\n- type: dataset\r\n## configuration <SENSITIVE, report disabled by configuration>\r\n## datalad \r\n  - full_version: 0.11.0\r\n  - version: 0.11.0\r\n## dataset \r\n  - metadata: <SENSITIVE, report disabled by configuration>\r\n  - path: /scratch/box/webdav/box/MRI1\r\n  - repo: AnnexRepo\r\n## dependencies \r\n  - appdirs: 1.4.3\r\n  - boto: 2.49.0\r\n  - cmd:annex: 6.20181011+git124-g94aa0e2f6-1~ndall+1\r\n  - cmd:git: 2.19.1\r\n  - cmd:system-git: 1.9.1\r\n  - cmd:system-ssh: 6.6.1p1\r\n  - exifread: 2.1.2\r\n  - git: 2.1.11\r\n  - gitdb: 2.0.5\r\n  - humanize: 0.5.1\r\n  - iso8601: 0.1.12\r\n  - msgpack: 0.5.6\r\n  - mutagen: 1.41.1\r\n  - requests: 2.20.0\r\n  - six: 1.11.0\r\n  - tqdm: 4.28.1\r\n  - wrapt: 1.10.11\r\n## environment \r\n  - GIT_PYTHON_GIT_EXECUTABLE: /usr/lib/git-annex.linux/git\r\n  - LANG: en_CA.ISO-8859-1\r\n  - LC_ALL: en_CA.ISO-8859-1\r\n  - PATH: /opt/sge/bin:/opt/sge/bin/lx-amd64:/opt/sge/bin:/opt/sge/bin/lx-amd64:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/bin:/usr/local/bic/bin:/usr/local/mni/bin\r\n## extentions \r\n  - neuroimaging: \r\n    - description: Neuroimaging tools\r\n    - entrypoints: \r\n      - datalad_neuroimaging.bids2scidata.BIDS2Scidata: \r\n        - class: BIDS2Scidata\r\n        - load_error: None\r\n        - module: datalad_neuroimaging.bids2scidata\r\n        - names: \r\n          - bids2scidata\r\n    - load_error: None\r\n    - module: datalad_neuroimaging\r\n    - version: 0.1.5\r\n## git-annex \r\n  - build flags: \r\n    - Assistant\r\n    - Webapp\r\n    - Pairing\r\n    - S3(multipartupload)(storageclasses)\r\n    - WebDAV\r\n    - Inotify\r\n    - DBus\r\n    - DesktopNotify\r\n    - TorrentParser\r\n    - MagicMime\r\n    - Feeds\r\n    - Testsuite\r\n  - dependency versions: \r\n    - aws-0.19\r\n    - bloomfilter-2.0.1.0\r\n    - cryptonite-0.25\r\n    - DAV-1.3.2\r\n    - feed-1.0.0.0\r\n    - ghc-8.2.2\r\n    - http-client-0.5.12\r\n    - persistent-sqlite-2.8.1.2\r\n    - torrent-10000.1.1\r\n    - uuid-1.3.13\r\n    - yesod-1.6.0\r\n  - key/value backends: \r\n    - SHA256E\r\n    - SHA256\r\n    - SHA512E\r\n    - SHA512\r\n    - SHA224E\r\n    - SHA224\r\n    - SHA384E\r\n    - SHA384\r\n    - SHA3_256E\r\n    - SHA3_256\r\n    - SHA3_512E\r\n    - SHA3_512\r\n    - SHA3_224E\r\n    - SHA3_224\r\n    - SHA3_384E\r\n    - SHA3_384\r\n    - SKEIN256E\r\n    - SKEIN256\r\n    - SKEIN512E\r\n    - SKEIN512\r\n    - BLAKE2B256E\r\n    - BLAKE2B256\r\n    - BLAKE2B512E\r\n    - BLAKE2B512\r\n    - BLAKE2B160E\r\n    - BLAKE2B160\r\n    - BLAKE2B224E\r\n    - BLAKE2B224\r\n    - BLAKE2B384E\r\n    - BLAKE2B384\r\n    - BLAKE2S256E\r\n    - BLAKE2S256\r\n    - BLAKE2S160E\r\n    - BLAKE2S160\r\n    - BLAKE2S224E\r\n    - BLAKE2S224\r\n    - BLAKE2SP256E\r\n    - BLAKE2SP256\r\n    - BLAKE2SP224E\r\n    - BLAKE2SP224\r\n    - SHA1E\r\n    - SHA1\r\n    - MD5E\r\n    - MD5\r\n    - WORM\r\n    - URL\r\n  - local repository version: 5\r\n  - operating system: linux x86_64\r\n  - remote types: \r\n    - git\r\n    - gcrypt\r\n    - p2p\r\n    - S3\r\n    - bup\r\n    - directory\r\n    - rsync\r\n    - web\r\n    - bittorrent\r\n    - webdav\r\n    - adb\r\n    - tahoe\r\n    - glacier\r\n    - ddar\r\n    - hook\r\n    - external\r\n  - supported repository versions: \r\n    - 3\r\n    - 5\r\n    - 6\r\n  - upgrade supported from repository versions: \r\n    - 0\r\n    - 1\r\n    - 2\r\n    - 3\r\n    - 4\r\n    - 5\r\n  - version: 6.20181011+git124-g94aa0e2f6-1~ndall+1\r\n## metadata_extractors \r\n  - annex: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.annex\r\n    - version: None\r\n  - audio: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.audio\r\n    - version: None\r\n  - bids: \r\n    - load_error: None\r\n    - module: datalad_neuroimaging.extractors.bids\r\n    - version: None\r\n  - datacite: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datacite\r\n    - version: None\r\n  - datalad_core: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_core\r\n    - version: None\r\n  - datalad_rfc822: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_rfc822\r\n    - version: None\r\n  - dicom: \r\n    - load_error: None\r\n    - module: datalad_neuroimaging.extractors.dicom\r\n    - version: None\r\n  - exif: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.exif\r\n    - version: None\r\n  - frictionless_datapackage: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.frictionless_datapackage\r\n    - version: None\r\n  - image: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.image\r\n    - version: None\r\n  - nidm: \r\n    - load_error: None\r\n    - module: datalad_neuroimaging.extractors.nidm\r\n    - version: None\r\n  - nifti1: \r\n    - load_error: None\r\n    - module: datalad_neuroimaging.extractors.nifti1\r\n    - version: None\r\n  - xmp: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.xmp\r\n    - version: None\r\n## system \r\n  - distribution: Ubuntu/14.04/trusty\r\n  - encoding: \r\n    - default: ascii\r\n    - filesystem: ISO-8859-1\r\n    - locale.prefered: ISO-8859-1\r\n  - max_path_length: None\r\n  - name: Linux\r\n  - release: 3.13.0-153-generic\r\n  - type: posix\r\n  - version: #203-Ubuntu SMP Thu Jun 14 08:52:28 UTC 2018\r\n```\r\n\r\n", "closed_by": {"login": "tedstrauss", "id": 930560, "node_id": "MDQ6VXNlcjkzMDU2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/930560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tedstrauss", "html_url": "https://github.com/tedstrauss", "followers_url": "https://api.github.com/users/tedstrauss/followers", "following_url": "https://api.github.com/users/tedstrauss/following{/other_user}", "gists_url": "https://api.github.com/users/tedstrauss/gists{/gist_id}", "starred_url": "https://api.github.com/users/tedstrauss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tedstrauss/subscriptions", "organizations_url": "https://api.github.com/users/tedstrauss/orgs", "repos_url": "https://api.github.com/users/tedstrauss/repos", "events_url": "https://api.github.com/users/tedstrauss/events{/privacy}", "received_events_url": "https://api.github.com/users/tedstrauss/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2997/timeline", "performed_via_github_app": null}