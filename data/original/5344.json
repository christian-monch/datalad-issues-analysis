{"url": "https://api.github.com/repos/datalad/datalad/issues/5344", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5344/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5344/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5344/events", "html_url": "https://github.com/datalad/datalad/pull/5344", "id": 789387321, "node_id": "MDExOlB1bGxSZXF1ZXN0NTU3NzM3ODEw", "number": 5344, "title": "ENH: cmdline: Use pydoc pager for --help", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-19T21:29:44Z", "updated_at": "2021-01-20T16:56:34Z", "closed_at": "2021-01-20T14:34:18Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5344", "html_url": "https://github.com/datalad/datalad/pull/5344", "diff_url": "https://github.com/datalad/datalad/pull/5344.diff", "patch_url": "https://github.com/datalad/datalad/pull/5344.patch"}, "body": "The argument for -h/--help/--help-np is wired up with a custom\r\nargparse.Action class, HelpAction.  For an interactive call with\r\n--help and a subcommand, this class looks for a corresponding manpage\r\nfile and tries to shell out to man(1), falling back to printing the\r\nhelp string.\r\n\r\nThis means that for several common install scenarios, output isn't\r\ndisplayed with a pager, and there is no distinction between --help and\r\n--help-np.  Given that the help text of most subcommands probably\r\nexceeds common terminal heights, callers need to either scroll up or\r\ndo something like `datalad <subcommand> --help | less`.\r\n\r\nMake a pager available in these situations by using pydoc.pager() to\r\ndisplay the --help output.  Two notes:\r\n\r\n  * guarding the use of pydoc.pager() with datalad's is_interactive()\r\n    isn't essential because pydoc.pager() avoids using a pager when it\r\n    detects a non-interactive environment.  However, these interactive\r\n    checks aren't identical, so it probably makes sense to honor a\r\n    \"no\" from is_interactive().\r\n\r\n  * pydoc.pager() will enter the pager even if the number of lines\r\n    doesn't exceed the current terminal height.  Given the length of\r\n    the output for most subcommands, checking this ourselves (and\r\n    worrying about platform-specific details) before calling\r\n    pydoc.pager() probably isn't worth it.\r\n\r\n---\r\n\r\nI've had a draft for this around for a while and thought about it again as I was typing `datalad siblings --help | less`.  Given the last point in the commit message, I'm not sure if others will think this is a good change.  Thoughts?\r\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5344/timeline", "performed_via_github_app": null}