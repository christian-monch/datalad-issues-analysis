{"url": "https://api.github.com/repos/datalad/datalad/issues/3611", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3611/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3611/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3611/events", "html_url": "https://github.com/datalad/datalad/pull/3611", "id": 483582492, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA5NjI5ODQ5", "number": 3611, "title": "RF+BF: make cookies db access/closing more robust", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/63", "html_url": "https://github.com/datalad/datalad/milestone/63", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/63/labels", "id": 4525220, "node_id": "MDk6TWlsZXN0b25lNDUyNTIyMA==", "number": 63, "title": "Release 0.11.7", "description": "", "creator": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2019-07-26T18:31:57Z", "updated_at": "2020-01-12T11:22:31Z", "due_on": null, "closed_at": "2020-01-12T11:22:31Z"}, "comments": 5, "created_at": "2019-08-21T18:31:54Z", "updated_at": "2019-08-25T00:27:38Z", "closed_at": "2019-08-23T17:53:05Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/3611", "html_url": "https://github.com/datalad/datalad/pull/3611", "diff_url": "https://github.com/datalad/datalad/pull/3611.diff", "patch_url": "https://github.com/datalad/datalad/pull/3611.patch"}, "body": "While running tests under some conda environment, there were errors while closing\r\ncookies DB. Could not reproduce in the native Debian environment with similarishish\r\nPython.  With these changes, cookies_db is a property so it gets properly\r\nloadded before setting any value. And also we catch exceptions upon\r\nclose and report them as a warning if there were some cookies to store.\r\n\r\nUnfortunately Python in conda env still prints directly the entire traceback, and\r\non Debian some error message even before throwing the exception so you could see something like\r\n\r\n    $> DATALAD_LOG_LEVEL=INFO python -m nose -s -v datalad/support/tests/test_cookies.py\r\n    datalad.support.tests.test_cookies.test_no_blows ... [WARNING] Failed to save possibly updated 1 cookies (best): [Errno 2] No such file or directory: '/home/yoh/.tmp/datalad_temp_test_no_blows1_rmfcb2/mycookies.dat' [dumb.py:_setval:178]\r\n    Exception ignored in: <function _Database.close at 0x7f1fe46872f0>\r\n    Traceback (most recent call last):\r\n      File \"/home/yoh/anaconda-2018.12-3.7/envs/test-gitpython/lib/python3.7/dbm/dumb.py\", line 284, in close\r\n        self._commit()\r\n      File \"/home/yoh/anaconda-2018.12-3.7/envs/test-gitpython/lib/python3.7/dbm/dumb.py\", line 135, in _commit\r\n        with self._io.open(self._dirfile, 'w', encoding=\"Latin-1\") as f:\r\n    FileNotFoundError: [Errno 2] No such file or directory: '/home/yoh/.tmp/datalad_temp_test_no_blows1_rmfcb2/mycookies.dir'\r\n    ok\r\n\r\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3611/timeline", "performed_via_github_app": null}