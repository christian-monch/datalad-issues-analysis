{"url": "https://api.github.com/repos/datalad/datalad/issues/5325", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5325/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5325/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5325/events", "html_url": "https://github.com/datalad/datalad/pull/5325", "id": 784652583, "node_id": "MDExOlB1bGxSZXF1ZXN0NTUzODEwMzQ0", "number": 5325, "title": "TST: Add skip_if_adjusted_branch decorator", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-01-12T22:52:30Z", "updated_at": "2021-01-13T17:19:21Z", "closed_at": "2021-01-13T17:05:39Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5325", "html_url": "https://github.com/datalad/datalad/pull/5325", "diff_url": "https://github.com/datalad/datalad/pull/5325.diff", "patch_url": "https://github.com/datalad/datalad/pull/5325.patch"}, "body": "A repeated pattern in the tests is to create a dataset with a path\r\ngenerated via with_{tree,tempfile} and then raise a SkipTest if the\r\ndataset is on an adjusted branch.  Aside from being a bit harder to\r\ngrep for, a problem with this pattern is that it's wasteful.  A\r\ndataset is created for each test, but the temporary directory's file\r\nsystem isn't changing out from under us, so we can use the same answer\r\nacross tests.\r\n\r\nAdd a skip_if_adjusted_branch() decorator that caches the result,\r\npaying the cost of an additional create() call for file systems that\r\ndo not default to adjusted branches.\r\n\r\nAnother advantage of this new decorator is that, when we realize a\r\ntest marked with skip_if_on_windows() actually failed due to more\r\ngeneral adjusted branch issues, we can simply switch the decorator.\r\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5325/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5325/timeline", "performed_via_github_app": null}