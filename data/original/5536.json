{"url": "https://api.github.com/repos/datalad/datalad/issues/5536", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5536/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5536/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5536/events", "html_url": "https://github.com/datalad/datalad/pull/5536", "id": 843640344, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAyOTk1MDIw", "number": 5536, "title": "interface: Include message in json{,_pp} output", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-29T18:01:43Z", "updated_at": "2021-03-30T12:52:07Z", "closed_at": "2021-03-30T06:28:05Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5536", "html_url": "https://github.com/datalad/datalad/pull/5536", "diff_url": "https://github.com/datalad/datalad/pull/5536.diff", "patch_url": "https://github.com/datalad/datalad/pull/5536.patch"}, "body": "When rendering results as json, the message and logger fields are\r\ndropped.  Information about the logger seems unlikely to be useful,\r\nbut filtering out the message can lose information that's not\r\navailable elsewhere, particularly for commands that put a caught\r\nexception in the message field of status=error results.\r\n\r\nThe message has been filtered out since result handling was introduced\r\nin v0.6.0.  2747ed1928 (RF: Centralize logging in result evaluation,\r\n2017-03-02) doesn't give an explicit reason for this, but it's likely\r\nbecause the message can be a `(<format string>, <value>, ...)` tuple,\r\nand those values aren't necessarily JSON serializable.  However, this\r\nshould no longer be an issue as of v0.11.0 because json.dumps() is\r\ncalled with a default=str.\r\n\r\nRetain the message in the json rendering to avoid losing information.\r\n\r\nAt least in the case of exceptions, another option would be to update\r\nthese commands to use a field that isn't dropped.  get_status_dict()\r\nrecently gained an 'exception' keyword, which it formats as the\r\n'exception_traceback' field, so this approach is already used to some\r\ndegree.  Aside from backward compatibility concerns, the problem with\r\nusing a different field is that then callers using the default\r\nrenderer do not see the information.\r\n\r\nRe: https://github.com/datalad/datalad/pull/5517#discussion_r599140556\r\n", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5536/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5536/timeline", "performed_via_github_app": null}