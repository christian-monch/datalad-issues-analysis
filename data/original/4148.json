{"url": "https://api.github.com/repos/datalad/datalad/issues/4148", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4148/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4148/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4148/events", "html_url": "https://github.com/datalad/datalad/issues/4148", "id": 565001697, "node_id": "MDU6SXNzdWU1NjUwMDE2OTc=", "number": 4148, "title": "Q: how to update dataset hierarchy to the state of the remote hierarchy when some submodules go forward?", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-13T23:03:13Z", "updated_at": "2020-02-22T03:25:33Z", "closed_at": "2020-02-22T03:25:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "ATM we have only `update --merge -r` but that one would \"pull\" all submodules to the latest state present on remote.  That might result in progressing forward relative to the origin even if there is no local changes.  So the desired action to achieve is something along the lines of \r\n\r\n `git pull --ff-only && git submodule update --recursive`\r\n\r\nbut that might detach heads due to `submodules`.\r\n\r\nHere is a script (based on Kyle's way in #4118):\r\n```\r\ncd \"$(mktemp -d --tmpdir dl-XXXXXXX)\"\r\n\r\ndatalad create 3rd\r\n\r\ndatalad create rem\r\ndatalad -C rem clone -d . $PWD/3rd\r\ndatalad -C rem uninstall -d . 3rd\r\n\r\n# Install hierarchy elsewhere\r\ndatalad install -r -s rem ds\r\n\r\n# 3rd goes ahead\r\necho foo > 3rd/foo\r\ndatalad save -d 3rd\r\n\r\n# rem goes ahead some other way\r\necho I read > rem/README.md\r\ndatalad save -d rem -r\r\n\r\n# Intent is to update full hierarchy to reflect state of rem\r\n# but we would then would be merging changes in 3rd not present in rem\r\ndatalad -C ds update -r --merge\r\ngit -C ds diff origin/master..\r\n```\r\nwhich would result at the end in smth like\r\n```\r\ndiff --git a/3rd b/3rd\r\nindex 8fcac34..49003d6 160000\r\n--- a/3rd\r\n+++ b/3rd\r\n@@ -1 +1 @@\r\n-Subproject commit 8fcac346541f642a580478183dd7b007c4ca9683\r\n+Subproject commit 49003d6324514140c4991c7a9aea6d877542f3fd\r\n```\r\nwhen the desire/intent to not have differences to the origin, i.e. `ds/3rd` staying in the same version as on original `rem`, not progressing forward as it did in its origin. \r\n\r\nHow should we express it in `update` call?   \r\n\r\nPS use case from https://github.com/CONP-PCNO/conp-dataset/ where actual subdatasets are of respective contributors, and shouldn't be progressed forward until curated.", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4148/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4148/timeline", "performed_via_github_app": null}