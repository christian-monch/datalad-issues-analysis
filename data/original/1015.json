{"url": "https://api.github.com/repos/datalad/datalad/issues/1015", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1015/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1015/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1015/events", "html_url": "https://github.com/datalad/datalad/issues/1015", "id": 183183068, "node_id": "MDU6SXNzdWUxODMxODMwNjg=", "number": 1015, "title": "create-sibling should exit with non-0 if something goes wrong", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}], "state": "closed", "locked": false, "assignee": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-10-15T02:11:47Z", "updated_at": "2017-02-09T21:41:24Z", "closed_at": "2017-02-09T21:41:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "just ran\n\n``` shell\n$> datalad create-sibling --shared all --existing=reconfigure hydra:/data/famface_angles/pilot-annex \n2016-10-14 22:03:00,893 [INFO   ] Connecting ...              \n2016-10-14 22:03:01,098 [INFO   ] Creating target dataset Matteo at /data/famface_angles/pilot-annex \n2016-10-14 22:03:01,126 [INFO   ] Adjusting remote git configuration \n2016-10-14 22:03:01,219 [ERROR  ] git config failed at remote location /data/famface_angles/pilot-annex.\n| You will not be able to push to checked out branch. Error: CommandError: command '['ssh', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', 'hydra', \"'git'\", \"'-C'\", \"'/data/famface_angles/pilot-annex'\", \"'-c'\", \"'receive.autogc=0'\", \"'-c'\", \"'gc.auto=0'\", \"'config'\", \"'receive.denyCurrentBranch'\", \"'updateInstead'\"]' failed with exitcode 255.\nFailed to run ['ssh', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', 'hydra', \"'git'\", \"'-C'\", \"'/data/famface_angles/pilot-annex'\", \"'-c'\", \"'receive.autogc=0'\", \"'-c'\", \"'gc.auto=0'\", \"'config'\", \"'receive.denyCurrentBranch'\", \"'updateInstead'\"] under None. Exit code=255. out= err=error: could not lock config file .git/config: No such file or directory\n [cmd.py:run:367] \n2016-10-14 22:03:01,219 [INFO   ] Enabling git post-update hook ... \n2016-10-14 22:03:01,256 [ERROR  ] Failed to run ['scp', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', '/tmp/datalad_temp_PNdjNx', 'hydra:\"/data/famface_angles/pilot-annex/.git/hooks/post-update\"'] under None. Exit code=1. out= err=scp: /data/famface_angles/pilot-annex/.git/hooks/post-update: No such file or directory\n|  \n2016-10-14 22:03:01,257 [ERROR  ] Failed to add json creation command to post update hook.\n| Error: CommandError: command '['scp', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', '/tmp/datalad_temp_PNdjNx', 'hydra:\"/data/famface_angles/pilot-annex/.git/hooks/post-update\"']' failed with exitcode 1.\n| Failed to run ['scp', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', '/tmp/datalad_temp_PNdjNx', 'hydra:\"/data/famface_angles/pilot-annex/.git/hooks/post-update\"'] under None. Exit code=1. out= err=scp: /data/famface_angles/pilot-annex/.git/hooks/post-update: No such file or directory\n|  [cmd.py:run:367] \n2016-10-14 22:03:01,313 [ERROR  ] Failed to run post-update hook under path /data/famface_angles/pilot-annex. Error: CommandError: command '['ssh', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', 'hydra', \"cd '/data/famface_angles/pilot-annex/.git' && hooks/post-update\"]' failed with exitcode 1.\n| Failed to run ['ssh', '-o', 'ControlPath=/home/yoh/.config/datalad/hydra', 'hydra', \"cd '/data/famface_angles/pilot-annex/.git' && hooks/post-update\"] under None. Exit code=1. out= err=zsh:cd:1: no such file or directory: /data/famface_angles/pilot-annex/.git\n|  [cmd.py:run:367] \n(venv-tests) 2 18906 [13].....................................:Fri 14 Oct 2016 10:03:01 PM EDT:.\n```\n\nwhich is full of errors ... because directory existed but was not a git repo, so all those commands failed on remote end. I expect it to\n1. fails as soon a remote command fails\n2. \"Connecting\" should say where connecting to\n3. exit code should be non-0\n", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1015/timeline", "performed_via_github_app": null}