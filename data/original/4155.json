{"url": "https://api.github.com/repos/datalad/datalad/issues/4155", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4155/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4155/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4155/events", "html_url": "https://github.com/datalad/datalad/issues/4155", "id": 565582240, "node_id": "MDU6SXNzdWU1NjU1ODIyNDA=", "number": 4155, "title": "export*: provide convention/options for upload of updates", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778592, "node_id": "MDU6TGFiZWw2Mzc3ODU5Mg==", "url": "https://api.github.com/repos/datalad/datalad/labels/enhancement", "name": "enhancement", "color": "0052cc", "default": true, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-14T22:17:04Z", "updated_at": "2020-02-16T16:59:21Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\n@dnkennedy is a brave person trying to use DataLad under-used/under-tested functionality but he is too shy to report problems and express his desires\r\n\r\n#### What is the underlying problem?\r\n\r\n`export-to-figshare` already allows to update an existing article with a new zipball of the dataset (and @dnkennedy is a living proof that it worked!). But it exports entire (size matters not?) dataset into an archive with the same name as before (based on dataset UUID) which makes it non-trivial to manually identify and remove previous version. \r\n\r\nRecently, #4140 (which closed #4138) added (where present) version information into the title of the new article, but didn't change naming of the exported archive.  So, at least to partially mitigate the difficulty of disambiguating different versions published within the same article, we could do the same to the published tarball -- include version when present.  (I think export-to-figshare UI could even ask to tag dataset if it was not yet tagged).  And we could ask if previous version(s) should be removed.\r\n\r\nBut there is IMHO a bigger/more interesting \"problem\" to solve. And it relates to #2038 (export multiple tarballs, e.g. per directory) somewhat.  Should we establish an \"overlay\" export feature to upload collections of zipballs for a dataset so they could be extracted (probably in a specified order) to reconstitute dataset, e.g. we could\r\n\r\n- export only the files which changed (added, edited) since the last upload if it was of the same MAJOR. (as in MAJOR.MINOR.PATCH) version (if \"MAJOR.\" is different -- full upload). Logic within DataLad should verify that no files were \"deleted\" since \"MAJOR.\", since that is breaking \"compatibility\" and thus should require \"MAJOR.\" version boost.  Then download of a tarball for a given version would require download of all tarballs for the same MAJOR. (but smaller in MINOR.PATCH) and extraction in a sorted by version order\r\n\r\n- with every uploaded zipball upload a \"small\" .json.xz file listing\r\n  - all the files/fingerprints (last edited git commit or git annex key if annexed)\r\n  - references to other zipballs which it overlays over\r\n  - possibly even removed files from what it overlays (thus not requiring stringent versioning as in the idea above).\r\n  - this feature could be useful also for #2038\r\n\r\nAny other ideas on what \"update\" features we should get for export, and either \"overlay\" sounds anyhow sensible/doable/robust.  Or some other ways to provide scalable export to figshare (and later possibly to zenodo etc)?", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4155/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4155/timeline", "performed_via_github_app": null}