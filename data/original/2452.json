{"url": "https://api.github.com/repos/datalad/datalad/issues/2452", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2452/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2452/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2452/events", "html_url": "https://github.com/datalad/datalad/issues/2452", "id": 318027113, "node_id": "MDU6SXNzdWUzMTgwMjcxMTM=", "number": 2452, "title": "Invalid on windows timezone test", "user": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 188141023, "node_id": "MDU6TGFiZWwxODgxNDEwMjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/platform-windows", "name": "platform-windows", "color": "0052cc", "default": false, "description": "Issue concerned with Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-04-26T13:21:22Z", "updated_at": "2020-03-15T16:20:41Z", "closed_at": "2020-03-15T16:20:41Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\nIn https://ci.appveyor.com/project/mih/datalad/build/1.0.20 the following test is failing, since `time.tzset()` is available on Unix only.\r\n\r\nHowever, I don't quite get its purpose in the test in question:\r\n\r\n```python\r\ndef test_get_timestamp_suffix():\r\n    # we need to patch temporarily TZ\r\n    import time\r\n    try:\r\n        with patch.dict('os.environ', {'TZ': 'GMT'}):\r\n            time.tzset()\r\n            # skynet DOB\r\n            assert_equal(get_timestamp_suffix(0), '-1970-01-01T00:00:00+0000')\r\n            assert_equal(get_timestamp_suffix(0, prefix=\"+\"),\r\n                         '+1970-01-01T00:00:00+0000')\r\n            # yoh found no way to mock things out and didn't want to provide\r\n            # explicit call to anything to get current time with the timezone,\r\n            # so disabling this test for now besides that it should return smth\r\n            # sensible ;)\r\n            #with patch.object(time, 'localtime', lambda: 1):\r\n            #    assert_equal(get_timestamp_suffix(),\r\n            #  '-1970-01-01T00:00:01+0000')  # skynet is 1 sec old\r\n            assert(get_timestamp_suffix().startswith('-'))\r\n    finally:\r\n        time.tzset()\r\n```\r\nBut timestamp `0` should always resolve to this very string. At the end of the day this is just calling `time.gmtime(0)`, the result of which should be independent on local TZ, no? Do I miss something here, @yarikoptic ?\r\nIf I'm right, the use of  `time.tzset()` is simply superfluous.", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2452/timeline", "performed_via_github_app": null}