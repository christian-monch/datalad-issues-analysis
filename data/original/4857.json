{"url": "https://api.github.com/repos/datalad/datalad/issues/4857", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4857/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4857/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4857/events", "html_url": "https://github.com/datalad/datalad/issues/4857", "id": 690401384, "node_id": "MDU6SXNzdWU2OTA0MDEzODQ=", "number": 4857, "title": "publish/push --since=^ deficiency: disregard of updated `git-annex` branch in subdatasets", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778592, "node_id": "MDU6TGFiZWw2Mzc3ODU5Mg==", "url": "https://api.github.com/repos/datalad/datalad/labels/enhancement", "name": "enhancement", "color": "0052cc", "default": true, "description": ""}, {"id": 2767220159, "node_id": "MDU6TGFiZWwyNzY3MjIwMTU5", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-push", "name": "cmd-push", "color": "FEF2C0", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-01T19:48:03Z", "updated_at": "2021-02-23T23:37:16Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "`--since=^`  only considers changes as visible from the current branch to speed up operations. It is sufficient \"90%\" of the time ;)\r\nBut subdatasets might get some other (e.g. `git-annex` or any other feature branch) updated and those might need to be published/pushed to the remove.  But with `--since=^` we might not even consider those subdatasets.\r\n\r\nI see use-cases where current, faster, behavior with `--since=^` which relies on selecting subdatasets would be sufficient (e.g. the location is the origin, and there is no feature branches, etc).  But in other cases it would be needed to assess all subdatasets (thus no `--since`) but avoid any interaction with the remote if as far as it knows remote has all references already and no data to be transferred (we could check if `git-annex` branch is identical on both ends).\r\n\r\n```shell\r\n(git)smaug:/mnt/datasets/datalad/crawl/openneuro/ds000001[master]git\r\n$> time git push --all --dry-run datalad-public\r\nEverything up-to-date\r\ngit push --all --dry-run datalad-public  0.01s user 0.02s system 18% cpu 0.158 total\r\n\r\n$> time git annex copy --to=datalad-public --auto       \r\ngit annex copy --to=datalad-public --auto  0.10s user 0.06s system 112% cpu 0.137 total\r\n\r\n$> time datalad push --to=datalad-public  \r\n# here it seems to be doing quite a bit according to the progress bars etc\r\ndatalad push --to=datalad-public  1.41s user 0.54s system 99% cpu 1.965 total   \r\n```\r\n\r\nSo it is pretty much similar to having `--fast` like `git-annex` does?\r\n\r\nP.S. I thought we had an issue on this already but I failed to find it.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4857/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4857/timeline", "performed_via_github_app": null}