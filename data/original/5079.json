{"url": "https://api.github.com/repos/datalad/datalad/issues/5079", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5079/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5079/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5079/events", "html_url": "https://github.com/datalad/datalad/issues/5079", "id": 728434085, "node_id": "MDU6SXNzdWU3Mjg0MzQwODU=", "number": 5079, "title": "log_progress_stage \"progressbars\" helper", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778592, "node_id": "MDU6TGFiZWw2Mzc3ODU5Mg==", "url": "https://api.github.com/repos/datalad/datalad/labels/enhancement", "name": "enhancement", "color": "0052cc", "default": true, "description": ""}, {"id": 390153891, "node_id": "MDU6TGFiZWwzOTAxNTM4OTE=", "url": "https://api.github.com/repos/datalad/datalad/labels/UX", "name": "UX", "color": "0052cc", "default": false, "description": "user experience"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-10-23T18:35:03Z", "updated_at": "2020-10-23T18:37:04Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nATM we just rely on `lgr.info` but we do and should use it sparsely. So we would not use it if in some cases operations could complete fast and be many to run.\r\n\r\nIf we could have something like\r\n```python\r\nwith log_process_stage(f\"Processing dataset {ds}\", steps=[\"fetch\", \"process\", \"save\"]) as lps:\r\n  lps.next()\r\n  fetch()\r\n  lps.next()\r\n  process()\r\n  lps.next()\r\n  ds.save()\r\n```\r\nwhich would display progress bar with `3` total and then adjust label as it goes from \"Processing dataset XXX: fetch\" to \"Processing dataset XXX: save\" (on top of any other progressbar which might come from log_progress etc) and then as any other progressbar disappear -- would be awesome and informative to the user. (changes in https://github.com/datalad/datalad/pull/5022/ would also ensure that logging would just be \"streaming\" above the progressbars)\r\n\r\nIt can already be done with log_progress, but IMHO a helper would be of \"help\" (unless I am mistaken).  Notes:\r\n\r\n- if there are conditional steps, we could have `next(step=None)` so it would find the step in the list and know that some were skipped, and thus adjust the label to also say `\"skipped: process\"` (e.g. if we had `lps.next(\"save\")` but not the one for \"process\".\r\n\r\n- edit: a \"smart\" one could may be not show ETA based on current steps progression, but (optionally?) just collect statistics for a given code placement (or some explicitly provided `id`) and guestimate duration based on the prior runs - I expect that in typical usecases it would already be \"in the right ballpark\"\r\n\r\nWDYT?", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5079/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5079/timeline", "performed_via_github_app": null}