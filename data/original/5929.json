{"url": "https://api.github.com/repos/datalad/datalad/issues/5929", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5929/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5929/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5929/events", "html_url": "https://github.com/datalad/datalad/issues/5929", "id": 979671019, "node_id": "MDU6SXNzdWU5Nzk2NzEwMTk=", "number": 5929, "title": "add-archive-content on pure (non tar) .xz adds it under git annex key filename", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3295048737, "node_id": "MDU6TGFiZWwzMjk1MDQ4NzM3", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-add-archive-content", "name": "cmd-add-archive-content", "color": "7B7458", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-25T22:36:11Z", "updated_at": "2021-08-25T23:43:37Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n11984  datalad create /tmp/testxz\r\n11985  cd /tmp/testxz\r\n11986  echo 123 > 123.txt\r\n11987  xz 123.txt\r\n11988  ls\r\n11989  datalad save -m 'add xz'\r\n11990  ls -l 123.txt.xz\r\n11991  datalad add-archive-content --delete 123.txt.xz\r\n11992  ls -l\r\n11993  echo 124 > 124.txt\r\n11994  gzip 124.txt\r\n11995  datalad save -m 'add gz'\r\n11996  datalad add-archive-content --delete 124.txt.gz\r\n```\r\nresults in\r\n\r\n```\r\n$> ls\r\n124.txt@  MD5E-s60--b6bfb7613a8ca533ec202294257e9fde.txt@\r\n\r\n```\r\n\r\n<details>\r\n<summary>full protocol on .xz and .gz (ok) files</summary> \r\n\r\n```shell\r\n$> datalad create /tmp/testxz\r\n[INFO   ] Creating a new annex repo at /tmp/testxz \r\ncreate(ok): /tmp/testxz (dataset)\r\n1 11985.....................................:Wed 25 Aug 2021 06:31:46 PM EDT:.\r\nlena:~\r\n$> cd /tmp/testxz\r\n1 11986.....................................:Wed 25 Aug 2021 06:31:48 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> echo 123 > 123.txt\r\n1 11987.....................................:Wed 25 Aug 2021 06:31:57 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> xz 123.txt\r\n1 11988.....................................:Wed 25 Aug 2021 06:32:01 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> ls\r\n123.txt.xz\r\n1 11989.....................................:Wed 25 Aug 2021 06:32:02 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> datalad save -m 'add xz'\r\nadd(ok): 123.txt.xz (file)                                                                                                                                                                                           \r\nsave(ok): . (dataset)                                                                                                                                                                                                \r\naction summary:                                                                                                                                                                                                      \r\n  add (ok: 1)\r\n  save (ok: 1)\r\n1 11990.....................................:Wed 25 Aug 2021 06:32:12 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> ls -l 123.txt.xz \r\nlrwxrwxrwx 1 yoh yoh 124 Aug 25 18:31 123.txt.xz -> .git/annex/objects/kv/Q8/MD5E-s60--b6bfb7613a8ca533ec202294257e9fde.txt.xz/MD5E-s60--b6bfb7613a8ca533ec202294257e9fde.txt.xz\r\n1 11991.....................................:Wed 25 Aug 2021 06:32:15 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> datalad add-archive-content --delete 123.txt.xz\r\n[INFO   ] Adding content of the archive 123.txt.xz into annex AnnexRepo(/tmp/testxz) \r\n[INFO   ] Initiating special remote datalad-archives \r\n[INFO   ] Finished adding 123.txt.xz: Files processed: 1, +annex: 1 \r\n1 11992.....................................:Wed 25 Aug 2021 06:32:38 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> ls -l\r\ntotal 4\r\nlrwxrwxrwx 1 yoh yoh 116 Aug 25 18:32 MD5E-s60--b6bfb7613a8ca533ec202294257e9fde.txt -> .git/annex/objects/MX/gx/MD5E-s4--ba1f2511fc30423bdbb183fe33f3dd0f.txt/MD5E-s4--ba1f2511fc30423bdbb183fe33f3dd0f.txt\r\n1 11993.....................................:Wed 25 Aug 2021 06:32:41 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> echo 124 > 124.txt                            \r\n1 11994.....................................:Wed 25 Aug 2021 06:32:50 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> gzip 124.txt\r\n1 11995.....................................:Wed 25 Aug 2021 06:32:52 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> datalad save -m 'add gz' \r\nadd(ok): 124.txt.gz (file)                                                                                                                                                                                           \r\nsave(ok): . (dataset)                                                                                                                                                                                                \r\naction summary:                                                                                                                                                                                                      \r\n  add (ok: 1)\r\n  save (ok: 1)\r\n1 11996.....................................:Wed 25 Aug 2021 06:33:01 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> datalad add-archive-content --delete 124.txt.gz \r\n[INFO   ] Adding content of the archive 124.txt.gz into annex AnnexRepo(/tmp/testxz) \r\n[INFO   ] Finished adding 124.txt.gz: Files processed: 1, +annex: 1 \r\n1 11997.....................................:Wed 25 Aug 2021 06:33:12 PM EDT:.\r\n(git-annex)lena:/tmp/testxz[master]\r\n$> ls\r\n124.txt@  MD5E-s60--b6bfb7613a8ca533ec202294257e9fde.txt@\r\n\r\n```\r\n</details>", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5929/timeline", "performed_via_github_app": null}