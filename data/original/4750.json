{"url": "https://api.github.com/repos/datalad/datalad/issues/4750", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4750/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4750/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4750/events", "html_url": "https://github.com/datalad/datalad/issues/4750", "id": 661838766, "node_id": "MDU6SXNzdWU2NjE4Mzg3NjY=", "number": 4750, "title": "datalad uninstall drops from ephemeral origin", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2803278929, "node_id": "MDU6TGFiZWwyODAzMjc4OTI5", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-uninstall", "name": "cmd-uninstall", "color": "FEF2C0", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-20T13:41:47Z", "updated_at": "2021-03-10T08:20:22Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Thanks to git-annex tracking it shouldn't lead to data loss but I wonder if that is really a desired behavior e.g. in cases we make ephemeral installs to satisfy YODA principles etc: it leads to wiping out possibly expensive to re-obtain data from the original annex:\r\n\r\n```shell\r\n$> datalad create testds; cd testds; datalad install -d . -s ~/datalad/openneuro/ds000001 --reckless=ephemeral\r\n[INFO   ] Creating a new annex repo at /tmp/testds \r\n[INFO   ] Scanning for unlocked files (this may take some time) \r\ncreate(ok): /tmp/testds (dataset)\r\n[INFO   ] Scanning for unlocked files (this may take some time)                                                                                                                                                                    \r\n[INFO   ] access to 1 dataset sibling s3-PRIVATE not auto-enabled, enable with:\r\n| \t\tdatalad siblings -d \"/tmp/testds/ds000001\" enable -s s3-PRIVATE \r\ninstall(ok): /tmp/testds/ds000001 (dataset)\r\nadd(ok): /tmp/testds/ds000001 (file)\r\nadd(ok): /tmp/testds/.gitmodules (file)\r\nsave(ok): /tmp/testds (dataset)\r\naction summary:\r\n  add (ok: 2)\r\n  install (ok: 1)\r\n  save (ok: 1)\r\n\r\n$> ls -l ds000001/.git/annex -d\r\nlrwxrwxrwx 1 yoh yoh 47 Jul 20 09:36 ds000001/.git/annex -> /home/yoh/datalad/openneuro/ds000001/.git/annex/\r\n\r\n$> datalad uninstall ds000001\r\ndrop(ok): /tmp/testds/ds000001/sub-01/anat/sub-01_T1w.nii.gz (file) [checking s3-PUBLIC...]\r\ndrop(ok): /tmp/testds/ds000001/sub-01/anat/sub-01_inplaneT2.nii.gz (file) [checking s3-PUBLIC...]\r\ndrop(ok): /tmp/testds/ds000001/sub-01/func/sub-01_task-balloonanalogrisktask_run-01_bold.nii.gz (file) [checking s3-PUBLIC...]\r\ndrop(ok): /tmp/testds/ds000001 (directory)\r\nuninstall(ok): /tmp/testds/ds000001 (dataset)\r\naction summary:\r\n  drop (ok: 4)\r\n  uninstall (ok: 1)\r\n\r\n$> ls -L ~/datalad/openneuro/ds000001/sub-01/anat/sub-01_T1w.nii.gz \r\nls: cannot access '/home/yoh/datalad/openneuro/ds000001/sub-01/anat/sub-01_T1w.nii.gz': No such file or directory\r\n\r\n$> datalad --version\r\ndatalad 0.13.1.dev55\r\n```\r\nI think the best course of action is to not call `drop` while uninstalling ephemeral clone", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4750/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4750/timeline", "performed_via_github_app": null}