{"url": "https://api.github.com/repos/datalad/datalad/issues/1825", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1825/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1825/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1825/events", "html_url": "https://github.com/datalad/datalad/issues/1825", "id": 256899244, "node_id": "MDU6SXNzdWUyNTY4OTkyNDQ=", "number": 1825, "title": "Problems with AFP server on Ubuntu", "user": {"login": "billbrod", "id": 6338509, "node_id": "MDQ6VXNlcjYzMzg1MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/6338509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billbrod", "html_url": "https://github.com/billbrod", "followers_url": "https://api.github.com/users/billbrod/followers", "following_url": "https://api.github.com/users/billbrod/following{/other_user}", "gists_url": "https://api.github.com/users/billbrod/gists{/gist_id}", "starred_url": "https://api.github.com/users/billbrod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billbrod/subscriptions", "organizations_url": "https://api.github.com/users/billbrod/orgs", "repos_url": "https://api.github.com/users/billbrod/repos", "events_url": "https://api.github.com/users/billbrod/events{/privacy}", "received_events_url": "https://api.github.com/users/billbrod/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 33, "created_at": "2017-09-12T02:38:14Z", "updated_at": "2019-05-10T02:16:40Z", "closed_at": "2019-05-09T20:38:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm not sure I can make this specific enough to get help, but I've been having issues using datalad on an AFP server. My OS is Ubuntu 16.04 LTS, and I've mounted the AFP server both with [afpfs-ng](https://github.com/simonvetter/afpfs-ng) and [gvfs-mount](http://manpages.ubuntu.com/manpages/trusty/man1/gvfs-mount.1.html). In both cases I can mount the server and navigate to it, both in Nautilus (my file explorer) and on the command line. I'm able to create two datasets on my machine's hard drive and everything seems to work fine, so I don't think it's my datalad install, but when dealing with the server, I have trouble with the most basic tasks.\r\n\r\nWhen creating a dataset while the AFP server was mounted using gvfs-mount, the dataset would be created without any problems, but attempting to do any git or datalad commands within that directory cause a `fatal: This operation must be run in a work tree` to be printed and nothing happens. After poking around online, I thought this might have to do with the total path length (like the Windows issue #82), since gvfs-mount uses a very long mount point name by default. \r\n\r\nHowever, using afpfs-ng allowed me to get a much shorter name for the mount point, but I still occasionally have this issue. Just now, I was just attempting to re-create a dataset to reproduce other issues I ran into, but now I can't get anywhere because I immediately run into the above issue (with a path name length of 62 characters). I'm now running a VPN in order to mount the drive, but that's the only thing that's changed from this afternoon, when I was able to create the dataset.\r\n\r\nWhen I create a new dataset on my machine's hard drive using the server dataset as a source (using `dataset install --source /mnt/path/to/dataset test`), it creates it correctly (and copies the data, if any), but when I navigate into the directory and type git status, it tells me `Your branch is based on 'origin/master', but the upstream is gone. (use \"git branch --unset-upstream\" to fixup)`, which googling tells me means that the branch is gone. When I try to then update from one dataset to the other, they're unable to do so, often without an error message (I can't find the error message that would be occasionally returned, since I'm unable to create the dataset on the server without any problems).\r\n\r\nI had other issues as well, but I think they're all related and I currently can't reproduce them because of this `fatal: This operation must be run in a work tree` issue, which I think means that git thinks I'm not in a git directory (despite both `.git` and `.datalad` being present and containing files). Any ideas what might be going on?", "closed_by": {"login": "billbrod", "id": 6338509, "node_id": "MDQ6VXNlcjYzMzg1MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/6338509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billbrod", "html_url": "https://github.com/billbrod", "followers_url": "https://api.github.com/users/billbrod/followers", "following_url": "https://api.github.com/users/billbrod/following{/other_user}", "gists_url": "https://api.github.com/users/billbrod/gists{/gist_id}", "starred_url": "https://api.github.com/users/billbrod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billbrod/subscriptions", "organizations_url": "https://api.github.com/users/billbrod/orgs", "repos_url": "https://api.github.com/users/billbrod/repos", "events_url": "https://api.github.com/users/billbrod/events{/privacy}", "received_events_url": "https://api.github.com/users/billbrod/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1825/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1825/timeline", "performed_via_github_app": null}