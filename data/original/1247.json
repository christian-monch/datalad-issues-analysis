{"url": "https://api.github.com/repos/datalad/datalad/issues/1247", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1247/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1247/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1247/events", "html_url": "https://github.com/datalad/datalad/issues/1247", "id": 204409564, "node_id": "MDU6SXNzdWUyMDQ0MDk1NjQ=", "number": 1247, "title": "GitPython environment not modified properly", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2017-01-31T20:07:17Z", "updated_at": "2017-02-14T11:14:59Z", "closed_at": "2017-02-14T11:14:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "During a git push from within `publish`:\r\n````\r\n[DEBUG  ] Running: ['ssh', '-O', 'check', '-o', 'ControlPath=/home/mih/.cache/datalad/sockets/747501b3584c118d95811f2c756f2a9f', 'kumo.ovgu.de']\r\n| cwd: None \r\n[ERROR  ] Cmd('git') failed due to: exit code(128)\r\n|   cmdline: git -c receive.autogc=0 -c gc.auto=0 push --porcelain target1 git-annex:git-annex\r\n|   stderr: 'fatal: bad numeric config value 'updateInstead' for 'receive.denycurrentbranch' in config: invalid unit\r\n| fatal: Could not read from remote repository.\r\n| \r\n| Please make sure you have the correct access rights\r\n| and the repository exists.' [cmd.py:wait:291] (GitCommandError) \r\n````\r\n\r\nsystem-git on that host is old. However, it should have been done with GIT_SSH_COMMAND='datalad ssrun'. But from some reason it is not happening (code is on top of #1241). Running this manually works:\r\n\r\n````\r\n% GIT_SSH_COMMAND='datalad sshrun' GIT_TRACE=1 git -c receive.autogc=0 -c gc.auto=0 push --porcelain target1 git-annex:git-annex\r\n21:06:19.174577 git.c:371               trace: built-in: git 'push' '--porcelain' 'target1' 'git-annex:git-annex'\r\n21:06:19.174855 run-command.c:350       trace: run_command: 'datalad sshrun' 'kumo.ovgu.de' 'git-receive-pack '\\''public_html/demoannex'\\'''\r\n21:06:19.175065 run-command.c:209       trace: exec: '/bin/sh' '-c' 'datalad sshrun \"$@\"' 'datalad sshrun' 'kumo.ovgu.de' 'git-receive-pack '\\''public_html/demoannex'\\'''\r\nTo kumo.ovgu.de:public_html/demoannex\r\n=\trefs/heads/git-annex:refs/heads/git-annex\t[up to date]\r\nDone\r\n````", "closed_by": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1247/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1247/timeline", "performed_via_github_app": null}