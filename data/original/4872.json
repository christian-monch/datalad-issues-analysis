{"url": "https://api.github.com/repos/datalad/datalad/issues/4872", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4872/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4872/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4872/events", "html_url": "https://github.com/datalad/datalad/pull/4872", "id": 694071703, "node_id": "MDExOlB1bGxSZXF1ZXN0NDgwNTA4NjEy", "number": 4872, "title": "Last step before {Git|Annex}Repo.add() removal", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 519289523, "node_id": "MDU6TGFiZWw1MTkyODk1MjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/on%20hold%20-%20input%20required", "name": "on hold - input required", "color": "fbca04", "default": false, "description": "Work on this issue cannot proceed until critical feedback was given"}, {"id": 545918236, "node_id": "MDU6TGFiZWw1NDU5MTgyMzY=", "url": "https://api.github.com/repos/datalad/datalad/labels/DX", "name": "DX", "color": "0052cc", "default": false, "description": "developer experience"}, {"id": 1453907298, "node_id": "MDU6TGFiZWwxNDUzOTA3Mjk4", "url": "https://api.github.com/repos/datalad/datalad/labels/stale-PR-closed-without-merge", "name": "stale-PR-closed-without-merge", "color": "ffffff", "default": false, "description": ""}, {"id": 1746781627, "node_id": "MDU6TGFiZWwxNzQ2NzgxNjI3", "url": "https://api.github.com/repos/datalad/datalad/labels/merge-if-ok", "name": "merge-if-ok", "color": "fbca04", "default": false, "description": "OP considers this work done, and requests review/merge"}, {"id": 2096760260, "node_id": "MDU6TGFiZWwyMDk2NzYwMjYw", "url": "https://api.github.com/repos/datalad/datalad/labels/corpse-in-basement", "name": "corpse-in-basement", "color": "d4c5f9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-09-05T12:03:12Z", "updated_at": "2021-01-15T07:54:51Z", "closed_at": "2021-01-15T07:54:51Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4872", "html_url": "https://github.com/datalad/datalad/pull/4872", "diff_url": "https://github.com/datalad/datalad/pull/4872.diff", "patch_url": "https://github.com/datalad/datalad/pull/4872.patch"}, "body": "https://github.com/datalad/datalad/issues/3714 posed the question re the fate of these methods. This PR is supposed to show that they are obsolete in the context of datalad-core, and to explore what extension work is TODO. It looks as if only `metalad` and `crawler` need attention.\r\n\r\nBefore a merge, the first commit is likely to be dropped (see its message). The other commits will make it easier for a larger portion of the tests to run on windows. Further homogenization will hopefully ease the porting effort substantially.\r\n\r\nGuidelines for porting other code (examples can be found in the diff of the test code in this PR):\r\n\r\n- If possible/desirable use `Dataset`-level API, not `Repo`-level\r\n- Replace immediate `add/commit` sequences with `Repo.save()` calls\r\n- Replace explicit staging needs (should be very few) with `Repo._save_add()` helper\r\n\r\nTODO\r\n\r\n- [x] check failure of `datalad.customremotes.tests.test_archives.test_basic_scenario` (accidentally put variable name on quotes)\r\n- [x] check failure of `datalad.support.tests.test_annexrepo.test_annex_add_no_dotfiles`\r\n      - this is only happening with a v7 version of `git-annex-standalone`, it doesn't happen for v8 versions of standalone, nor does it happen for v8 versions of a normal `git-annex`\r\n      - I forgot (again) why we are clinging to this old version for the tests, but given that this is a non-issue for any version that would get normally installed, I am not planning to invest time into an investigation.\r\n- [x] windows failure of `datalad.support.tests.test_repodates.test_check_dates`", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4872/timeline", "performed_via_github_app": null}