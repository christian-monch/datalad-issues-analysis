{"url": "https://api.github.com/repos/datalad/datalad/issues/5639", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5639/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5639/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5639/events", "html_url": "https://github.com/datalad/datalad/pull/5639", "id": 875883859, "node_id": "MDExOlB1bGxSZXF1ZXN0NjMwMTM2NzQw", "number": 5639, "title": "TST: test_partial_unlocked: Document and avoid recent git-annex failure", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3049454618, "node_id": "MDU6TGFiZWwzMDQ5NDU0NjE4", "url": "https://api.github.com/repos/datalad/datalad/labels/tests", "name": "tests", "color": "ffd3cc", "default": false, "description": "Add or improve existing tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-05-04T22:18:41Z", "updated_at": "2021-06-02T20:03:32Z", "closed_at": "2021-05-05T13:30:03Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5639", "html_url": "https://github.com/datalad/datalad/pull/5639", "diff_url": "https://github.com/datalad/datalad/pull/5639.diff", "patch_url": "https://github.com/datalad/datalad/pull/5639.patch"}, "body": "git-annex's 424bef6b6 (smudge: check for known annexed inodes before\r\nchecking annex.largefiles, 2021-05-03) fixed a case where an unchanged\r\nunlocked annexed file that does not match annex.largefiles gets sent\r\nto git.\r\n\r\nThat change leads to a racy failure of test_partial_unlocked.  The\r\ntest unlocks a file and then configures .gitattributes so that the\r\nfile doesn't match annex.largefiles.  Before 424bef6b6, providing that\r\nfile as a pathspec to `git commit` (as `datalad save` does) results in\r\na commit where the file changes to being tracked by git.  With\r\n424bef6b6, the above sometimes doesn't happen; instead the commit\r\nincludes the link to a pointer file change, and the change to being\r\ntracked by git remains in the index.\r\n\r\nThis issue has been reported upstream.  For now, document it, and\r\nadjust the test to avoid the intermittent failure.\r\n\r\nCloses #5637\r\n\r\n[1] https://git-annex.branchable.com/bugs/case_where_using_pathspec_with_git-commit_leaves_s/\r\n", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5639/timeline", "performed_via_github_app": null}