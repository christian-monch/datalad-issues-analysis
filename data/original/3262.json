{"url": "https://api.github.com/repos/datalad/datalad/issues/3262", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3262/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3262/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3262/events", "html_url": "https://github.com/datalad/datalad/issues/3262", "id": 424430802, "node_id": "MDU6SXNzdWU0MjQ0MzA4MDI=", "number": 3262, "title": "OPT/RF Runner", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/68", "html_url": "https://github.com/datalad/datalad/milestone/68", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/68/labels", "id": 5040840, "node_id": "MDk6TWlsZXN0b25lNTA0MDg0MA==", "number": 68, "title": "More flexible, less monolithic Runner(s)", "description": "", "creator": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 5, "state": "closed", "created_at": "2020-01-25T06:41:19Z", "updated_at": "2020-10-13T18:58:34Z", "due_on": null, "closed_at": "2020-02-10T19:57:14Z"}, "comments": 7, "created_at": "2019-03-22T23:11:35Z", "updated_at": "2020-10-13T18:58:34Z", "closed_at": "2020-10-13T18:58:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#3261 shows that in some use-cases we do spend a lot of time in Runner executing external commands. Unfortunately we do not have estimate how it relates to actual run time of those external commands, but observing low CPU and no `D` state for invoked git/git-annex commands I would suspect that the way we invoke those commands via Popen is suboptimal, probably blocking/waiting/sleeping somewhere.\r\n\r\nAlso Runner grew into a monster, as many of you have already stated.  I think it would be worth to\r\n- identify scenarios where and how it is used (e.g. with or without requiring online processing of output, etc). May be by now some combinations of modes could be dropped, and a few more mode-specific implementations are provided instead\r\n- [ ] see if at least for some (if not all) we could use/implement non-blocking mode of operation, see e.g. https://stackoverflow.com/questions/375427/non-blocking-read-on-a-subprocess-pipe-in-python", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3262/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3262/timeline", "performed_via_github_app": null}