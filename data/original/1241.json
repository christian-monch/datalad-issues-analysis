{"url": "https://api.github.com/repos/datalad/datalad/issues/1241", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1241/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1241/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1241/events", "html_url": "https://github.com/datalad/datalad/pull/1241", "id": 204016372, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAzNzM5OTkx", "number": 1241, "title": "NF: Remote git version sensing; SSH execution env conditions (fixes gh-1240)", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2017-01-30T13:54:58Z", "updated_at": "2017-02-07T14:21:45Z", "closed_at": "2017-02-02T18:50:20Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/1241", "html_url": "https://github.com/datalad/datalad/pull/1241", "diff_url": "https://github.com/datalad/datalad/pull/1241.diff", "patch_url": "https://github.com/datalad/datalad/pull/1241.patch"}, "body": "NF: Remote git version sensing; SSH execution env conditions (fixes gh-1240)\r\n    \r\nWith this change, remote SSH calls will try to use a bundles Git version if any exists (or can be found next to git-annex). This should work for explicit calls to git, as well as any implicit  calls made by other (proxy) commands.\r\n\r\nThis required some changes in the way we call SSH. Most notably we need to send commands as a single string (not a list), and we need to quote path arguments prior to sending them to SSH.\r\n\r\nTODO:\r\n\r\n- [x] Open SSH connection on demand\r\n- [x] New `SSHConnection.is_open()`\r\n- [x] RF `SSHConnection.__call__()` to accept a single command string. This is also the way Git will send commands along\r\n- [x] Auto-sensing of Git version, Git-annex version and installation location, as will as detection of bundles Git installations\r\n- [x] Proper control path filename encoding of host, user and port, following SSH recommendations\r\n- [x] Use hash as control path filename to not give away information on shared locations\r\n- [x] Implementation of an `sshrun` command to be used by us as `GIT_SSH_COMMAND`\r\n- [x] RF to be able to generate control paths in the tests too. All failing tests are due to inappropriate assumptions on the control path value after RF\r\n- [x] When `CommandError` reaches the top level, datalad as a whole fails with the same error and exit code as the underlying error.\r\n- [ ] #1247 ", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1241/timeline", "performed_via_github_app": null}