{"url": "https://api.github.com/repos/datalad/datalad/issues/948", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/948/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/948/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/948/events", "html_url": "https://github.com/datalad/datalad/issues/948", "id": 179836958, "node_id": "MDU6SXNzdWUxNzk4MzY5NTg=", "number": 948, "title": "do not add pushurl if not explicitly specified AND/OR the same as url", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/34", "html_url": "https://github.com/datalad/datalad/milestone/34", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/34/labels", "id": 2055649, "node_id": "MDk6TWlsZXN0b25lMjA1NTY0OQ==", "number": 34, "title": "Yarik-happy-demo-for-CRCNS-SfN", "description": "List of issues I would like to see addressed for a full blown demo, but which also would simplify my life", "creator": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 8, "state": "closed", "created_at": "2016-10-07T19:09:48Z", "updated_at": "2021-09-13T15:54:12Z", "due_on": "2016-10-14T07:00:00Z", "closed_at": "2017-06-15T10:55:48Z"}, "comments": 2, "created_at": "2016-09-28T17:34:19Z", "updated_at": "2016-11-25T19:56:47Z", "closed_at": "2016-11-25T19:56:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently create-sibling (or somewhere under) configures both url and pushurl in .git/config even if pushurl is the same as url:\n\n``` shell\n[remote \"smaug\"]\n    url = smaug:/mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms/PHANTOM1_3\n    fetch = +refs/heads/*:refs/remotes/smaug/*\n    pushurl = smaug:/mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms/PHANTOM1_3\n```\n\nIMHO shouldn't be done at all if url == pushurl.  That in turn then breaks check while trying to add/publish to just cloned superdataset, which wouldn't have any \"pushurl\" set (why would it?):\n\n``` shell\n$> datalad create-sibling --existing=skip -r smaug:/mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms smaug\n2016-09-28 13:30:11,547 [INFO   ] Connecting ... (create_sibling.py:212)\nECDSA host key for IP address '129.170.233.9' not in list of known hosts.\n2016-09-28 13:30:11,733 [INFO   ] Creating target dataset dartmouth-phantoms at /mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms (create_sibling.py:242)\n2016-09-28 13:30:11,778 [INFO   ] Creating target dataset dartmouth-phantoms/PHANTOM1_3 at /mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms/PHANTOM1_3 (create_sibling.py:242)\n2016-09-28 13:30:11,819 [INFO   ] Creating target dataset dartmouth-phantoms/PHANTOM-20160909 at /mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms/PHANTOM-20160909 (create_sibling.py:242)\n2016-09-28 13:30:11,862 [INFO   ] Creating target dataset dartmouth-phantoms/bids_test3 at /mnt/datasets/datalad/crawl/dicoms/dartmouth-phantoms/bids_test3 (create_sibling.py:242)\n```\n\ninitial workaround could be as simple as \n\n```\n$> git diff\ndiff --git a/datalad/distribution/add_sibling.py b/datalad/distribution/add_sibling.py\nindex aabe7e0..04d3c0e 100644\n--- a/datalad/distribution/add_sibling.py\n+++ b/datalad/distribution/add_sibling.py\n@@ -166,8 +166,7 @@ class AddSibling(Interface):\n                 if repos[repo_name]['url'].rstrip('/') != existing_url.rstrip('/') \\\n                         or (pushurl and existing_pushurl and\n                             repos[repo_name]['pushurl'].rstrip('/') !=\n-                                    existing_pushurl.rstrip('/')) \\\n-                        or (pushurl and not existing_pushurl):\n+                                    existing_pushurl.rstrip('/')):\n                     conflicting.append(repo_name)\n\n         if not force and conflicting:\n```\n\nbut I think we should altogether not set those pushurls if == url.  Agreed?\n", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/948/timeline", "performed_via_github_app": null}