{"url": "https://api.github.com/repos/datalad/datalad/issues/1365", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1365/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1365/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1365/events", "html_url": "https://github.com/datalad/datalad/issues/1365", "id": 212764125, "node_id": "MDU6SXNzdWUyMTI3NjQxMjU=", "number": 1365, "title": "fetch fails in create_sibling call", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-03-08T15:21:35Z", "updated_at": "2017-03-09T14:25:35Z", "closed_at": "2017-03-09T14:25:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Originally \"reported\" in the original #1356 ... now I managed to reproduce it (although in another test):\r\n\r\n```\r\n(git)hopa:~datalad/datalad[bf-publish]git\r\n$> DATALAD_TESTS_SSH=1 nosetests -s -v datalad/distribution/tests/test_publish.py:test_publish_depends\r\n                                                                                                                                                        \r\nERROR\r\nVersions: cmd:annex=6.20170220+gitg75a15e1ad-1~ndall+1 cmd:git=2.11.0 cmd:system-git=2.11.0 git=2.1.0 tqdm=4.11.2\r\n\r\n======================================================================\r\nERROR: datalad.distribution.tests.test_publish.test_publish_depends\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 818, in newfunc\r\n    return func(*args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 734, in newfunc\r\n    t(*(arg + (uri,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 564, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 564, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 564, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/tests/utils.py\", line 564, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/distribution/tests/test_publish.py\", line 336, in test_publish_depends\r\n    name='target1')\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/distribution/dataset.py\", line 577, in apply_func\r\n    return f(**kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/distribution/create_sibling.py\", line 562, in __call__\r\n    inherit\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/distribution/create_sibling.py\", line 217, in _create_dataset_sibling\r\n    inherit=inherit\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/distribution/add_sibling.py\", line 268, in __call__\r\n    repo.fetch(name)\r\n  File \"/home/yoh/proj/datalad/datalad/datalad/support/gitrepo.py\", line 1388, in fetch\r\n    fi_list += rm.fetch(refspec=refspec, progress=progress, **kwargs)\r\n  File \"/usr/lib/python2.7/dist-packages/git/remote.py\", line 752, in fetch\r\n    res = self._get_fetch_info_from_stderr(proc, progress)\r\n  File \"/usr/lib/python2.7/dist-packages/git/remote.py\", line 638, in _get_fetch_info_from_stderr\r\n    proc.wait(stderr=stderr_text)\r\n  File \"/usr/lib/python2.7/dist-packages/git/cmd.py\", line 290, in wait\r\n    raise GitCommandError(self.args, status, errstr)\r\nGitCommandError: Cmd('/usr/lib/git-annex.linux/git') failed due to: exit code(128)\r\n  cmdline: /usr/lib/git-annex.linux/git -c receive.autogc=0 -c gc.auto=0 fetch -v target1\r\n  stderr: 'fatal: Could not read from remote repository.\r\n\r\nPlease make sure you have the correct access rights\r\nand the repository exists.'\r\n-------------------- >> begin captured logging << --------------------\r\ndatalad.utils: Level 5: Importing datalad.utils\r\ndatalad.utils: Level 5: Done importing datalad.utils\r\ndatalad.cmd: DEBUG: Will use git under '/usr/lib/git-annex.linux' (no adjustments to PATH if empty string)\r\ndatalad.cmd: DEBUG: Running: ['git', 'config', '-z', '-l']\r\ncwd: None\r\ndatalad.cmd: Level 8: Finished running ['git', 'config', '-z', '-l'] with status 0\r\ndatalad.ui: Level 5: Starting importing ui\r\ndatalad.ui.dialog: Level 5: Starting importing ui.dialog\r\ndatalad.ui.dialog: Level 5: Done importing ui.dialog\r\ndatalad.ui: Level 5: Initiating UI switcher\r\ndatalad.ui: DEBUG: UI set to DialogUI(out=<file>)\r\ndatalad.ui: Level 5: Done importing ui\r\n--------------------- >> end captured logging << ---------------------\r\n```\r\n\r\nthe \"trigger\" for me is to be outside of the virtualenv environment ... not yet sure how that matters here.  But if I run when activating my virtualenv -- test passes.  git module version is the same -- uses system wide one .  so the divergence remains a mystery", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1365/timeline", "performed_via_github_app": null}