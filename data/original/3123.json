{"url": "https://api.github.com/repos/datalad/datalad/issues/3123", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3123/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3123/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3123/events", "html_url": "https://github.com/datalad/datalad/issues/3123", "id": 399620526, "node_id": "MDU6SXNzdWUzOTk2MjA1MjY=", "number": 3123, "title": "datalad install subdataset over SSH hops (ssh alias capitalization ignored)", "user": {"login": "seldamat", "id": 1558845, "node_id": "MDQ6VXNlcjE1NTg4NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1558845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seldamat", "html_url": "https://github.com/seldamat", "followers_url": "https://api.github.com/users/seldamat/followers", "following_url": "https://api.github.com/users/seldamat/following{/other_user}", "gists_url": "https://api.github.com/users/seldamat/gists{/gist_id}", "starred_url": "https://api.github.com/users/seldamat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seldamat/subscriptions", "organizations_url": "https://api.github.com/users/seldamat/orgs", "repos_url": "https://api.github.com/users/seldamat/repos", "events_url": "https://api.github.com/users/seldamat/events{/privacy}", "received_events_url": "https://api.github.com/users/seldamat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 63778590, "node_id": "MDU6TGFiZWw2Mzc3ODU5MA==", "url": "https://api.github.com/repos/datalad/datalad/labels/severity-normal", "name": "severity-normal", "color": "ff8888", "default": false, "description": "standard severity"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-01-16T02:28:57Z", "updated_at": "2020-07-23T20:18:40Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "#### What is the problem?\r\nCandidate source URL is invalid and does not match ssh config host name, preventing `datalad install` from running correctly.\r\n#### What steps will reproduce the problem?\r\nI am attempting to install across SSH hops.. so my config file looks something like\r\n```\r\nHost A.edu\r\n     User seldamat\r\n     ForwardAgent yes\r\n     ServerAliveInterval 240\r\n     ServerAliveCountMax 2\r\n     IdentityFile ~/.ssh/rsa\r\n\r\nHost B, B-Alias\r\n    User seldamat\r\n    ForwardAgent yes\r\n    ProxyCommand ssh -q A nc  B 22\r\n    ServerAliveInterval 240\r\n    ServerAliveCountMax 2\r\n    IdentityFile ~/.ssh/rsa\r\n\r\nHost C, C-Alias\r\n    User username\r\n    ForwardAgent yes\r\n    ProxyCommand ssh -q B-alias nc C 22\r\n    ServerAliveInterval 240\r\n    ServerAliveCountMax 2\r\n```\r\n\r\nMy .gitmodule looks like\r\n```\r\n[submodule \"dataset\"]\r\n\tpath = dataset\r\n\turl = ssh://admin@C-Alias:/home/username/datasets/central-repository/dataset.git\r\n```\r\n\r\nI am running (note that this is being run within a dataset itself)\r\n`datalad install dataset`\r\n\r\nError message is (excerpt):\r\n```\r\n[INFO   ] Cloning ssh://username@C-Alias:/home/username/datasets/central-repository/dataset.git [1 other candidates] into '/gpfs/dataset'\r\nssh_exchange_identification: Connection closed by remote host\r\n[WARNING] Failed to run cmd ['ssh', '-fN', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=\"/storage/home/sue217/.cache/datalad/sockets/f7ed4923\"', 'username@c-alias']. Exit code=255\r\n| stdout: None\r\n| stderr: None\r\nssh_exchange_identification: Connection closed by remote host\r\n[WARNING] Failed to run cmd ['ssh', '-fN', '-o', 'ControlMaster=auto', '-o', 'ControlPersist=15m', '-o', 'ControlPath=\"/storage/home/sue217/.cache/datalad/sockets/f7ed4923\"', 'username@c-alias']. Exit code=255\r\n| stdout: None\r\n| stderr: None\r\n```\r\n\r\nI noticed that the host name was incorrectly de-capitalized so I added this host name to the list\r\n```\r\nHost C, C-Alias, c-alias\r\n    User username\r\n    ForwardAgent yes\r\n    ProxyCommand ssh -q B-alias nc C 22\r\n    ServerAliveInterval 240\r\n    ServerAliveCountMax 2\r\n```\r\n\r\nAfter this modification \r\n`datalad install dataset`\r\n\r\nWorks like a charm! \r\n\r\nOnly issue is that `git annex sync` doesn't work unless you remove the lowercase host entry. No idea why on this one \ud83e\udd37\ud83c\udffb\u200d\u2642\ufe0f\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\ndatalad 0.11.0\r\n#### Is there anything else that would be useful to know in this context?\r\nI changed the user/host names in the output/example files for privacy.\r\n#### Have you had any success using DataLad before? (to assess your expertise/prior luck.  We would welcome your testimonial additions to https://github.com/datalad/datalad/wiki/Testimonials as well)\r\ndatalad is great!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3123/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3123/timeline", "performed_via_github_app": null}