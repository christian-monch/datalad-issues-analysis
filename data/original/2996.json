{"url": "https://api.github.com/repos/datalad/datalad/issues/2996", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2996/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2996/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2996/events", "html_url": "https://github.com/datalad/datalad/issues/2996", "id": 380612848, "node_id": "MDU6SXNzdWUzODA2MTI4NDg=", "number": 2996, "title": "Retrieving results in datalad-run from datalad cmdline calls", "user": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2767259861, "node_id": "MDU6TGFiZWwyNzY3MjU5ODYx", "url": "https://api.github.com/repos/datalad/datalad/labels/cmd-run/rerun", "name": "cmd-run/rerun", "color": "FEF2C0", "default": false, "description": "Issues about the favorite command of ReproPeople"}], "state": "open", "locked": false, "assignee": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-11-14T09:42:08Z", "updated_at": "2021-03-08T16:12:15Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "We regularly need to call datalad commands via `datalad-run` or `datalad-run-procedure`.\r\nThis leads to an independent datalad process and subsequently to the situation, that we don't have access to the results of those secondary datalad commands. For some workflows this is pretty inconvenient. For the things we need in `datalad-hirni` (leading to this issue), we can solve that with a special purpose approach, of course, and there are many ways to do it. However, it seems worth discussing it in a more general fashion and may be come up with a solution in `datalad-run` itself.\r\n\r\nSince we leave the python context entirely all those \"secondary calls\" can do is writing to stdout (or some file, of course). Despite the issue, that `run` currently channels the output through, we could theoretically parse the output (if those commands were called with `-f json`) from within `run` and yield. This could be done with a special output renderer for example. So `-f pipe_json` could mark a line (or a block) in the output, that `run` would then parse into a regular result to yield, while all non-marked output remains untouched. This would require the to be called command or procedure to make sure this renderer is used (which, I think, is fine, since particularly procedures can grow quite complex and it might be necessary for them to decide the results of which commands should be accessible for `run`).\r\nAn alternative would be to have some special temporary location (within .git?) to write results to, that `run` would then read. Or having an option for `run` to give a path where to read such result dumps from.\r\nWhat else seems to be a thinkable approach to you guys?\r\n\r\nI lean towards the output marking ATM, since it's easier to get and yield those while it's happening. On the other hand it kind of pollutes the output that is meant for the user especially with procedures which may consist of a mix of datalad and non-datalad calls.\r\n\r\nWhat do you think, @datalad/developers ?", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2996/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2996/timeline", "performed_via_github_app": null}