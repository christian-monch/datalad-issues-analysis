{"url": "https://api.github.com/repos/datalad/datalad/issues/4045", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4045/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4045/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4045/events", "html_url": "https://github.com/datalad/datalad/pull/4045", "id": 551530654, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0MjM2MzUy", "number": 4045, "title": "BF: clone: Account for relative paths when inheriting local origins", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-17T17:04:56Z", "updated_at": "2020-01-17T19:59:10Z", "closed_at": "2020-01-17T19:58:56Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4045", "html_url": "https://github.com/datalad/datalad/pull/4045", "diff_url": "https://github.com/datalad/datalad/pull/4045.diff", "patch_url": "https://github.com/datalad/datalad/pull/4045.patch"}, "body": "As of 367454e0b (NF: Auto-configure local origin of local origin to\r\nmake annex available, 2019-12-29), we check whether origin's URL for a\r\nnewly cloned annex dataset points to a local dataset.  If it does, we\r\nadd _that_ dataset's origin (if any) to the newly cloned dataset.  And\r\nas of d2a25d090 (ENH: Make configuration of local origin siblings work\r\nrecursively, 2020-01-05), we continue walking up the chain of local\r\norigin's until we hit an origin that is not a local path.\r\n\r\nHowever, we create the corresponding dataset instance with the wrong\r\npath when origin is a _relative_ path: it should be relative to the\r\ncloned repository, not the current working directory.  The incorrect\r\npath means that there's no \"origin of origin\" to find, and an\r\n\"origin-N\" remote isn't added.\r\n\r\nNote that this bug isn't currently very accessible because `git clone`\r\nconverts relative paths to absolute ones, and the first attempt to\r\nadjust these back to relative paths (02e2b4c46 and 0a80bb47e) was\r\nreverted in e8c5d7069 (BF: clone: Revert incorrect relative path\r\nadjustment to URLs, 2020-01-14).  But relative paths will be a common\r\ncase when the second attempt from gh-4026 lands.", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4045/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4045/timeline", "performed_via_github_app": null}