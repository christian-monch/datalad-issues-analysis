{"url": "https://api.github.com/repos/datalad/datalad/issues/4856", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4856/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4856/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4856/events", "html_url": "https://github.com/datalad/datalad/issues/4856", "id": 690278347, "node_id": "MDU6SXNzdWU2OTAyNzgzNDc=", "number": 4856, "title": "The most recent setuptools breaks installation on readthedocs", "user": {"login": "adswa", "id": 29738718, "node_id": "MDQ6VXNlcjI5NzM4NzE4", "avatar_url": "https://avatars.githubusercontent.com/u/29738718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adswa", "html_url": "https://github.com/adswa", "followers_url": "https://api.github.com/users/adswa/followers", "following_url": "https://api.github.com/users/adswa/following{/other_user}", "gists_url": "https://api.github.com/users/adswa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adswa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adswa/subscriptions", "organizations_url": "https://api.github.com/users/adswa/orgs", "repos_url": "https://api.github.com/users/adswa/repos", "events_url": "https://api.github.com/users/adswa/events{/privacy}", "received_events_url": "https://api.github.com/users/adswa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-01T16:19:21Z", "updated_at": "2020-09-05T12:46:01Z", "closed_at": "2020-09-05T12:46:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "On readthedocs, the builds for the docs currently break. I think the reason is a broken setuptools release (version 50.0.0, released August 30th), see https://github.com/pypa/setuptools/issues/2353 <details><summary>Here is the traceback for readthedocs</summary>\r\n\r\n```\r\nProcessing /home/docs/checkouts/readthedocs.org/user_builds/datalad/checkouts/latest\r\n  Installing build dependencies: started\r\n  Installing build dependencies: finished with status 'done'\r\n  Getting requirements to build wheel: started\r\n  Getting requirements to build wheel: finished with status 'done'\r\nERROR: Exception:\r\nTraceback (most recent call last):\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/cli/base_command.py\", line 216, in _main\r\n    status = self.run(options, args)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/cli/req_command.py\", line 182, in wrapper\r\n    return func(self, options, args)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/commands/install.py\", line 325, in run\r\n    reqs, check_supported_wheels=not options.target_dir\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/resolution/legacy/resolver.py\", line 183, in resolve\r\n    discovered_reqs.extend(self._resolve_one(requirement_set, req))\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/resolution/legacy/resolver.py\", line 388, in _resolve_one\r\n    abstract_dist = self._get_abstract_dist_for(req_to_install)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/resolution/legacy/resolver.py\", line 340, in _get_abstract_dist_for\r\n    abstract_dist = self.preparer.prepare_linked_requirement(req)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/operations/prepare.py\", line 483, in prepare_linked_requirement\r\n    req, self.req_tracker, self.finder, self.build_isolation,\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/operations/prepare.py\", line 91, in _get_prepared_distribution\r\n    abstract_dist.prepare_distribution_metadata(finder, build_isolation)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/distributions/sdist.py\", line 38, in prepare_distribution_metadata\r\n    self._setup_isolation(finder)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_internal/distributions/sdist.py\", line 96, in _setup_isolation\r\n    reqs = backend.get_requires_for_build_wheel()\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_vendor/pep517/wrappers.py\", line 161, in get_requires_for_build_wheel\r\n    'config_settings': config_settings\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_vendor/pep517/wrappers.py\", line 265, in _call_hook\r\n    raise BackendUnavailable(data.get('traceback', ''))\r\npip._vendor.pep517.wrappers.BackendUnavailable: Traceback (most recent call last):\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/pip/_vendor/pep517/_in_process.py\", line 86, in _build_backend\r\n    obj = import_module(mod_path)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 953, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 728, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/home/docs/.pyenv/versions/3.7.3/lib/python3.7/site-packages/setuptools/__init__.py\", line 6, in <module>\r\n    import distutils.core\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/site-packages/_distutils_hack/__init__.py\", line 82, in create_module\r\n    return importlib.import_module('._distutils', 'setuptools')\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/datalad/envs/latest/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\nModuleNotFoundError: No module named 'setuptools._distutils'\r\n```\r\n</details>\r\n\r\nI wanted to try whether this change in ``pyproject.toml`` helps\r\n\r\n```diff\r\n-requires = [\"setuptools>=40.8.0\", \"wheel\"]\r\n+requires = [\"setuptools>=40.8.0<50\", \"wheel\"]\r\n```\r\nbut the docs are tested with GitHub workflows only, so I can't test it and I don't dare to push ;-)", "closed_by": {"login": "adswa", "id": 29738718, "node_id": "MDQ6VXNlcjI5NzM4NzE4", "avatar_url": "https://avatars.githubusercontent.com/u/29738718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adswa", "html_url": "https://github.com/adswa", "followers_url": "https://api.github.com/users/adswa/followers", "following_url": "https://api.github.com/users/adswa/following{/other_user}", "gists_url": "https://api.github.com/users/adswa/gists{/gist_id}", "starred_url": "https://api.github.com/users/adswa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adswa/subscriptions", "organizations_url": "https://api.github.com/users/adswa/orgs", "repos_url": "https://api.github.com/users/adswa/repos", "events_url": "https://api.github.com/users/adswa/events{/privacy}", "received_events_url": "https://api.github.com/users/adswa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4856/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4856/timeline", "performed_via_github_app": null}