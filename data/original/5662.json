{"url": "https://api.github.com/repos/datalad/datalad/issues/5662", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5662/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5662/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5662/events", "html_url": "https://github.com/datalad/datalad/pull/5662", "id": 891304216, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQ0MTkyNjY1", "number": 5662, "title": "clone, install: Support cloning a specified branch or tag", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-05-13T19:19:44Z", "updated_at": "2021-06-04T14:53:43Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/5662", "html_url": "https://github.com/datalad/datalad/pull/5662", "diff_url": "https://github.com/datalad/datalad/pull/5662.diff", "patch_url": "https://github.com/datalad/datalad/pull/5662.patch"}, "body": "Note: This is marked as a draft because, based on past discussion, I expect there to be a good amount of disagreement about how to expose this.\r\n\r\n---\r\n\r\nPer @yarikoptic's request, this PR is a continuation of the discussion in gh-2109 about installing a specific version of a dataset.  gh-4036 added a RIA-specific URL scheme to support cloning a specific branch or tag: `ria+...#<dataset uuid>[@<tag/branch>]`.\r\n\r\nI see two main routes to extend that support to URLs in general:\r\n\r\n  * come up with a scheme for non-RIA URLs\r\n\r\n    Forms mentioned in gh-2109 include `...#version=X` (in fragment) and `...@X` (in path).\r\n\r\n  * add an argument to `clone` and `install` that allows specifying `X`.\r\n\r\n\r\nI'm in favor of the second due to the combination of the following reasons:\r\n\r\n  * It avoids all of the discussion in gh-2109 about how to represent the version in the URL.\r\n\r\n  * Allowing arbitrary `git clone` options to be passed to `datalad clone` seems like a good idea to me.  This has been brought up before (e.g., gh-4035 and gh-5286), and I think it will likely come up more as sparse checkouts and partial clones become more mature and widely used.\r\n\r\nGoing the command-argument route leaves the question of what to do with `datalad install`.  We could allow arbitrary `git clone` options there too.  However, given that `install` also wraps `get`, it's not clear that clone options should take precedence over arbitrary `git annex get` options.  So, in the case of `install`, a dedicated `--branch` argument could be added.  This doesn't block switching to arbitrary clone options later, aside from introducing the requirement that `--branch` (like other arbitrary options) comes at the end.\r\n\r\nHere are the main points against using command arguments instead of an URL-embedded version that come to mind:\r\n\r\n  * RIA already uses an embedded version.\r\n\r\n  * `--branch` is tied to git-clone's tag/branch implementation, and, even though RIA versions currently use `--branch`, it'd be possible to switch away from that behind the scenes so that arbitrary commits are supported.\r\n\r\nHowever, if `datalad clone` is going to accept arbitrary `git clone` options anyway, `--branch` falls out of that, so neither of those points carry much weight in my view.  `--branch` can be used until there's a clear need for arbitrary revisions (which, as far as I'm aware, hasn't been brought up for RIA URLs yet) and then an embedded URL scheme can be implemented.  At that point, it's still good for `datalad clone` to support arbitrary options, and the only extra cost is the `--branch` argument of `install`.\r\n\r\nThoughts?\r\n\r\ncc: @mih @yarikoptic @bpoldrack @dorianps\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5662/timeline", "performed_via_github_app": null}