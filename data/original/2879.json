{"url": "https://api.github.com/repos/datalad/datalad/issues/2879", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2879/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2879/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2879/events", "html_url": "https://github.com/datalad/datalad/issues/2879", "id": 364604697, "node_id": "MDU6SXNzdWUzNjQ2MDQ2OTc=", "number": 2879, "title": "Brain dump on GitPython removal", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-09-27T18:42:42Z", "updated_at": "2020-03-06T16:43:48Z", "closed_at": "2020-03-06T16:43:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I am aware that this idea is unpopular, but I am yet to be convinced that carrying around a repository instance in an otherwise entirely stateless setup is adding something valuable enough to be worth the cost. However, this is not to debate this point but rather to summarize what I know about the situation.\r\n\r\n### Usage patterns\r\n\r\n[ km: Updated for #2902 and #3530 ]\r\n\r\nDirect usage of the GitPython API in non-Repo class code is most problematic. Here are those in Datalad-core that I am aware of (`repo` is the GitPython repository object):\r\n\r\n- [ ] repo.remotes[remote].refs (create-sibling, publish)\r\n- [ ] repo.repo.commit() (publish)\r\n- [ ] repo.remotes[remote].refs[remote_branch_name] (publish)\r\n- [ ] repo.close() (ls)\r\n- [X] repo.git.show() (gone with #2902)\r\n- [ ] repo.git.merge_base() (GitRepo)\r\n- [X] repo.git.rev_parse() (all but two gone with #2902)\r\n- [X] repo.git_dir (gone with #2902)\r\n- [ ] repo.git (GitRepo, AnnexRepo)\r\n- [X] repo.git.for_each_ref()\r\n- [X] repo.git.log()\r\n- [X] repo.git.ls_tree()\r\n- [X] repo.git.cat_file\r\n\r\nand additionally in the associated tests\r\n\r\n- [X] repo.git.rev_list()\r\n- [X] repo.head.commit.message\r\n- [x] repo.commit().hexsha\r\n- [X] repo.git.reset()\r\n- [ ] repo.submodule() (GitRepo tests)\r\n\r\n### Data structure/object use\r\n\r\nExcept for PushInfo and Blob these are pretty harmless, as they either do not need a Repo instance, or are more or less static objects.\r\n\r\n- [x] git.GitConfigParser\r\n- [x] git.remote.PushInfo\r\n- [x] git.objects.blob.Blob\r\n- [ ] git.exc.InvalidGitRepositoryError\r\n- [ ] gitdb.exc.BadName\r\n- [ ] git.exc.GitCommandError\r\n- [ ] git.exc.NoSuchPathError", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2879/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2879/timeline", "performed_via_github_app": null}