{"url": "https://api.github.com/repos/datalad/datalad/issues/2515", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/2515/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/2515/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/2515/events", "html_url": "https://github.com/datalad/datalad/pull/2515", "id": 324992022, "node_id": "MDExOlB1bGxSZXF1ZXN0MTg5NDM4NDc3", "number": 2515, "title": "remaining two tests to fail while using bleeding edge git-annex 6.20180519+gitgf6f199be3-1~ndall+1", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-05-21T17:12:10Z", "updated_at": "2018-07-15T06:47:18Z", "closed_at": "2018-05-22T00:48:47Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/2515", "html_url": "https://github.com/datalad/datalad/pull/2515", "diff_url": "https://github.com/datalad/datalad/pull/2515.diff", "patch_url": "https://github.com/datalad/datalad/pull/2515.patch"}, "body": "#### What is the problem?\r\nI've not uploaded most recent git-annex since it caused few other tests to fail in comparison to previous one ()\r\n```shell\r\n$> DATALAD_TESTS_SSH=1 python -m nose -s -v datalad.support.tests.test_gitrepo:test_git_custom_calls datalad.support.tests.test_annexrepo:test_AnnexRepo_add_unexpected_direct_mode       \r\ndatalad.support.tests.test_gitrepo.test_git_custom_calls ... FAIL\r\ndatalad.support.tests.test_annexrepo.test_AnnexRepo_add_unexpected_direct_mode ... ERROR\r\nVersions: appdirs=1.4.3 boto=2.44.0 cmd:annex=6.20180519+gitgf6f199be3-1~ndall+1 cmd:git=2.17.0 cmd:system-git=2.17.0 cmd:system-ssh=7.6p1 exifread=2.1.2 git=2.1.8 gitdb=2.0.3 humanize=0.5.1 iso8601=0.1.11 msgpack=0.5.1 mutagen=1.40.0 requests=2.18.4 scrapy=1.5.0 six=1.11.0 tqdm=4.19.5 wrapt=1.9.0\r\n\r\n======================================================================\r\nERROR: datalad.support.tests.test_annexrepo.test_AnnexRepo_add_unexpected_direct_mode\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/tests/utils.py\", line 836, in newfunc\r\n    t(*(arg + (uri,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/tests/test_annexrepo.py\", line 838, in test_AnnexRepo_add_unexpected_direct_mode\r\n    top.add('.')\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/gitrepo.py\", line 301, in newfunc\r\n    result = func(self, files_new, *args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/annexrepo.py\", line 1482, in add\r\n    to_be_added_recs = _get_to_be_added_recs(files)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/annexrepo.py\", line 1475, in _get_to_be_added_recs\r\n    raise e\r\nCommandError: CommandError: command '['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'add', '--dry-run', '-N', '--ignore-missing', '--verbose', '--', '.']' failed with exitcode 128\r\nFailed to run ['git', '-c', 'receive.autogc=0', '-c', 'gc.auto=0', 'add', '--dry-run', '-N', '--ignore-missing', '--verbose', '--', '.'] under '/home/yoh/.tmp/datalad_temp_clone_url_vhdYI1'. Exit code=128. out= err=fatal: this operation must be run in a work tree\r\nfatal: 'git status --porcelain=2' failed in submodule subm 1\r\n\r\n\r\n======================================================================\r\nFAIL: datalad.support.tests.test_gitrepo.test_git_custom_calls\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/tests/utils.py\", line 663, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/tests/utils.py\", line 663, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/support/tests/test_gitrepo.py\", line 901, in test_git_custom_calls\r\n    assert_in(\"fatal: Not a git repository\", str(cm.exception))\r\nAssertionError: 'fatal: Not a git repository' not found in \"Cmd('/usr/lib/git-annex.linux/git') failed due to: exit code(128)\\n  cmdline: /usr/lib/git-annex.linux/git -c receive.autogc=0 -c gc.auto=0 -C /home/yoh/.tmp/datalad_temp_test_git_custom_callsQbgSw9 status\\n  stderr: 'fatal: not a git repository (or any parent up to mount point /)\\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).'\"\r\n-------------------- >> begin captured logging << --------------------\r\ndatalad.utils: Level 5: Importing datalad.utils\r\ndatalad.utils: Level 5: Done importing datalad.utils\r\ndatalad.cmd: Level 9: Will use git under '/usr/lib/git-annex.linux' (no adjustments to PATH if empty string)\r\ndatalad.cmd: Level 9: Running: ['git', 'version']\r\ndatalad.cmd: Level 8: Finished running ['git', 'version'] with status 0\r\ndatalad.cmd: Level 9: Running: ['git', 'config', '-z', '-l', '--show-origin']\r\ndatalad.cmd: Level 8: Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0\r\ndatalad.ui: Level 5: Starting importing ui\r\ndatalad.ui.dialog: Level 5: Starting importing ui.dialog\r\ndatalad.ui.dialog: Level 5: Done importing ui.dialog\r\ndatalad.ui: Level 5: Initiating UI switcher\r\ndatalad.ui: DEBUG: UI set to DialogUI(out=<file>)\r\ndatalad.ui: Level 5: Done importing ui\r\ndatalad.gitrepo: DEBUG: stdout| On branch master\r\ndatalad.gitrepo: DEBUG: stdout| nothing to commit, working tree clean\r\n--------------------- >> end captured logging << ---------------------\r\n\r\n----------------------------------------------------------------------\r\nRan 2 tests in 17.074s\r\n\r\nFAILED (errors=1, failures=1)\r\nDATALAD_TESTS_SSH=1 python -m nose -s -v    12.89s user 5.46s system 99% cpu 18.414 total\r\n\r\n```\r\nand they pass fine with 6.20180416+gitg86b18966f-1~ndall+1 ... 2nd one seems to be just casing (heh heh)... will fix up for those now", "closed_by": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/2515/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/2515/timeline", "performed_via_github_app": null}