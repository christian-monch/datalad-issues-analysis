{"url": "https://api.github.com/repos/datalad/datalad/issues/1745", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1745/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1745/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1745/events", "html_url": "https://github.com/datalad/datalad/issues/1745", "id": 251924385, "node_id": "MDU6SXNzdWUyNTE5MjQzODU=", "number": 1745, "title": "Demo of a simple reproducible analysis on public data", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 440544386, "node_id": "MDU6TGFiZWw0NDA1NDQzODY=", "url": "https://api.github.com/repos/datalad/datalad/labels/fix-implemented", "name": "fix-implemented", "color": "0e8a16", "default": false, "description": "A fix is available, but has not been merged or released, yet."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-08-22T11:25:39Z", "updated_at": "2017-08-24T05:10:29Z", "closed_at": "2017-08-24T05:10:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```sh\r\ndatalad create demo\r\ncd demo\r\n# obtain two public datasets as input\r\ndatalad install -d . -s ///openfmri/ds000001 inputs/ds000001\r\ndatalad install -d . -s ///openfmri/ds000002 inputs/ds000002\r\n# create a script that will perform brain extraction on any given\r\n# MRI file\r\nmkdir code\r\n\r\ncat << EOT > code/brain_extraction.sh\r\n# enable FSL\r\n. /etc/fsl/5.0/fsl.sh\r\n\r\n# obtain all inputs\r\ndatalad get \\$@\r\n# perform brain extraction\r\ncount=1\r\nfor nifti in \\$@; do\r\n  subdir=\"sub-\\$(printf %03d \\$count)\"\r\n  mkdir -p \\$subdir\r\n  bet \\$nifti \\$subdir/anat -m\r\n  count=\\$((count + 1)) \r\ndone\r\nEOT\r\n\r\n# save this version of the script in the dataset\r\ndatalad add code -m \"Brain extraction script\" --to-git\r\ndatalad save --version-tag setup_done\r\n# run the brain extraction script on the structural images\r\n# of the first subject from each dataset (could be all of them)\r\n# this saves the outcomes together with the exact command call\r\n# and version of the script\r\ndatalad run bash -e code/brain_extraction.sh inputs/ds*/sub-01/anat/sub-01_T1w.nii.gz\r\n# enough information is recorded to rerun the command, not that\r\n# the re-generated data is exactly the same and the dataset does not\r\n# need to be saved\r\ndatalad run --rerun\r\ndu -sh .\r\n# we can verify that our processing has not modified the inputs\r\ndatalad diff --revision setup_done inputs/*\r\n# hence we can uninstall them, they are public data after all\r\ndatalad uninstall inputs/*\r\ndu -sh .\r\n# however, all inputs are still available and can be re-obtained\r\n# on demand. For example, we can rerun our brain extraction command\r\n# again, and it will reobtain all required datasets to perform the\r\n# same operation that was originally recorded\r\n# note that it gets identical results, and the dataset does not need\r\n# to be saved\r\ndatalad run --rerun\r\n```", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1745/timeline", "performed_via_github_app": null}