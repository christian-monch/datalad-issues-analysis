{"url": "https://api.github.com/repos/datalad/datalad/issues/5110", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5110/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5110/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5110/events", "html_url": "https://github.com/datalad/datalad/issues/5110", "id": 734231610, "node_id": "MDU6SXNzdWU3MzQyMzE2MTA=", "number": 5110, "title": "ORA remote fails to transfer file", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2971010147, "node_id": "MDU6TGFiZWwyOTcxMDEwMTQ3", "url": "https://api.github.com/repos/datalad/datalad/labels/RIA/ORA", "name": "RIA/ORA", "color": "E8F2DF", "default": false, "description": "Issues related to RIA-based workflows and related components"}], "state": "closed", "locked": false, "assignee": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-11-02T06:40:10Z", "updated_at": "2021-07-02T15:38:01Z", "closed_at": "2021-07-02T15:38:01Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n% git annex --debug copy --to lab-storage pics/hypal_demo_tuned/hypal.png\r\n[2020-11-02 07:29:46.101912901] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] --> PREPARE-SUCCESS\r\n[2020-11-02 07:29:46.102386015] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] <-- CHECKPRESENT MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:46.103619813] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] --> DIRHASH MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:46.104045071] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] <-- VALUE M4/11/\r\n[2020-11-02 07:29:46.167260247] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] --> CHECKPRESENT-FAILURE MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:46.169088362] process [706337] chat: git [\"--git-dir=.git\",\"--work-tree=.\",\"--literal-pathspecs\",\"cat-file\",\"--batch\"]\r\n[2020-11-02 07:29:46.170824253] process [706338] chat: git [\"--git-dir=.git\",\"--work-tree=.\",\"--literal-pathspecs\",\"cat-file\",\"--batch-check=%(objectname) %(objecttype) %(objectsize)\"]\r\n(to lab-storage...) \r\n[2020-11-02 07:29:46.183562185] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] <-- TRANSFER STORE MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png .git/annex/objects/M4/11/MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png/MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:48.495864949] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] --> TRANSFER-SUCCESS STORE MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:48.496908331] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] <-- REMOVE MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n[2020-11-02 07:29:48.638136145] /home/mih/env/datalad3-dev/bin/git-annex-remote-ora[1] --> REMOVE-SUCCESS MD5E-s496173--9fa20182c8f242aec53758cafb0e8e3c.png\r\n\r\n  content changed while it was being sent\r\nfailed\r\n```\r\n\r\nInterestingly, it does not happen for all files in that dataset.\r\nUnclear what is going on.\r\n\r\n```\r\n% git cat-file -p git-annex:remote.log\r\n21b6fea9-be51-4329-877f-fd405806dff8 archive-id=5db11bd6-8755-11e9-8596-f0d5bf7b5561 autoenable=true encryption=none externaltype=ora name=lab-storage type=external url=ria+ssh://juseless/data/group/psyinf/talks.ria timestamp=1604297443.506710939s\r\n```\r\n\r\nWhen I enable datalad debug logging and manually replicate the underlying `scp` call, I can confirm that the md5sums of the source and destination file are, in fact, identical. I have tried to manually remove the transfer directory on the remote, but the error can be replicated regardless.\r\n\r\nI can also confirm that this behavior is independent of the specific target location (picked another machine and it instantly replicated), and happens with local git-annex versions 8.20200908 and 8.20201007.", "closed_by": {"login": "bpoldrack", "id": 10498301, "node_id": "MDQ6VXNlcjEwNDk4MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/10498301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpoldrack", "html_url": "https://github.com/bpoldrack", "followers_url": "https://api.github.com/users/bpoldrack/followers", "following_url": "https://api.github.com/users/bpoldrack/following{/other_user}", "gists_url": "https://api.github.com/users/bpoldrack/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpoldrack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpoldrack/subscriptions", "organizations_url": "https://api.github.com/users/bpoldrack/orgs", "repos_url": "https://api.github.com/users/bpoldrack/repos", "events_url": "https://api.github.com/users/bpoldrack/events{/privacy}", "received_events_url": "https://api.github.com/users/bpoldrack/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5110/timeline", "performed_via_github_app": null}