{"url": "https://api.github.com/repos/datalad/datalad/issues/1676", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/1676/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/1676/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/1676/events", "html_url": "https://github.com/datalad/datalad/issues/1676", "id": 246638257, "node_id": "MDU6SXNzdWUyNDY2MzgyNTc=", "number": 1676, "title": "test_plugins.py:test_plugin_call fails if invoked in source tree outside of git", "user": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-31T03:53:26Z", "updated_at": "2017-08-18T10:27:38Z", "closed_at": "2017-08-18T10:27:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "which caused FTBFS of updated Debian package\r\n\r\n```shell\r\n(git)hopa:~datalad/datalad-master[debian]git\r\n$> mv .git .git_aside\r\n(dev) 2 32811 [2].....................................:Sun 30 Jul 2017 11:41:44 PM EDT:.\r\n(git)hopa:~datalad[master]datalad-master\r\n$> python -m nose -s -v datalad/plugin/tests/test_plugins.py:test_plugin_call\r\ndatalad.plugin.tests.test_plugins.test_plugin_call ... >>>/home/yoh/proj/datalad/datalad-master\r\nERROR\r\nVersions: cmd:annex=6.20170525+gitge1cf095ae-1~ndall+1 cmd:git=2.11.0 cmd:system-git=2.11.0 cmd:system-ssh=7.4p1 git=2.1.1 tqdm=4.11.2\r\n\r\n======================================================================\r\nERROR: datalad.plugin.tests.test_plugins.test_plugin_call\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/nose/case.py\", line 197, in runTest\r\n    self.test(*self.arg)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/tests/utils.py\", line 592, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/tests/utils.py\", line 592, in newfunc\r\n    return t(*(arg + (filename,)), **kw)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/plugin/tests/test_plugins.py\", line 106, in test_plugin_call\r\n    res = list(plugin(['dummy', 'noval=one', 'obscure=some']))\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 731, in eval_func\r\n    return return_func(generator_func)(*args, **kwargs)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 719, in return_func\r\n    results = list(results)\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 676, in generator_func\r\n    result_renderer, result_xfm, _result_filter, **_kwargs):\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/interface/utils.py\", line 743, in _process_results\r\n    for res in results:\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/plugin/__init__.py\", line 245, in __call__\r\n    purpose='handover to plugin')\r\n  File \"/home/yoh/proj/datalad/datalad-master/datalad/distribution/dataset.py\", line 530, in require_dataset\r\n    \"{0}.\".format(dataset.path))\r\nValueError: No installed dataset found at /home/yoh/proj/datalad/datalad-master.\r\n-------------------- >> begin captured logging << --------------------\r\ndatalad.utils: Level 5: Importing datalad.utils\r\ndatalad.utils: Level 5: Done importing datalad.utils\r\ndatalad.cmd: DEBUG: Will use git under '/usr/lib/git-annex.linux' (no adjustments to PATH if empty string)\r\ndatalad.cmd: DEBUG: Running: ['git', 'version']\r\ndatalad.cmd: Level 8: Finished running ['git', 'version'] with status 0\r\ndatalad.cmd: DEBUG: Running: ['git', 'config', '-z', '-l', '--show-origin']\r\ndatalad.cmd: Level 8: Finished running ['git', 'config', '-z', '-l', '--show-origin'] with status 0\r\ndatalad.ui: Level 5: Starting importing ui\r\ndatalad.ui.dialog: Level 5: Starting importing ui.dialog\r\ndatalad.ui.dialog: Level 5: Done importing ui.dialog\r\ndatalad.ui: Level 5: Initiating UI switcher\r\ndatalad.ui: DEBUG: UI set to DialogUI(out=<file>)\r\ndatalad.ui: Level 5: Done importing ui\r\ndatalad.plugin: WARNING: ignoring plugin argument(s) set(['obscure']), not supported by plugin\r\n--------------------- >> end captured logging << ---------------------\r\n```\r\n\r\nI am not quite sure if assumption here is indeed to be within dataset whenever plugin is invoked, and ideally probably some more descriptive message should be thrown describing that plugin must be invoked while under a dataset (or explicitly provided).  For now I will fix up the test to disregard that we are not in an installed dataset", "closed_by": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/1676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/1676/timeline", "performed_via_github_app": null}