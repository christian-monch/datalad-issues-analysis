{"url": "https://api.github.com/repos/datalad/datalad/issues/5087", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/5087/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/5087/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/5087/events", "html_url": "https://github.com/datalad/datalad/issues/5087", "id": 728657212, "node_id": "MDU6SXNzdWU3Mjg2NTcyMTI=", "number": 5087, "title": "`publish` tests broken", "user": {"login": "mih", "id": 136479, "node_id": "MDQ6VXNlcjEzNjQ3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/136479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mih", "html_url": "https://github.com/mih", "followers_url": "https://api.github.com/users/mih/followers", "following_url": "https://api.github.com/users/mih/following{/other_user}", "gists_url": "https://api.github.com/users/mih/gists{/gist_id}", "starred_url": "https://api.github.com/users/mih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mih/subscriptions", "organizations_url": "https://api.github.com/users/mih/orgs", "repos_url": "https://api.github.com/users/mih/repos", "events_url": "https://api.github.com/users/mih/events{/privacy}", "received_events_url": "https://api.github.com/users/mih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 188141023, "node_id": "MDU6TGFiZWwxODgxNDEwMjM=", "url": "https://api.github.com/repos/datalad/datalad/labels/platform-windows", "name": "platform-windows", "color": "0052cc", "default": false, "description": "Issue concerned with Windows"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-10-24T04:33:05Z", "updated_at": "2020-10-24T04:33:05Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Revealed by #5080 \r\n\r\n```\r\n======================================================================\r\n1661ERROR: datalad.distribution.tests.test_publish.test_publish_fetch_do_not_recurse_submodules\r\n1662----------------------------------------------------------------------\r\n1663Traceback (most recent call last):\r\n1664  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\nose\\case.py\", line 198, in runTest\r\n1665    self.test(*self.arg)\r\n1666  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 271, in _wrap_skip_ssh\r\n1667    return func(*args, **kwargs)\r\n1668  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1669    return t(*(arg + (filename,)), **kw)\r\n1670  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\contextlib.py\", line 77, in __exit__\r\n1671    self.gen.throw(type, value, traceback)\r\n1672  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\utils.py\", line 1802, in make_tempfile\r\n1673    yield filename\r\n1674  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1675    return t(*(arg + (filename,)), **kw)\r\n1676  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\distribution\\tests\\test_publish.py\", line 772, in test_publish_fetch_do_not_recurse_submodules\r\n1677    recursive=True)\r\n1678  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\distribution\\dataset.py\", line 503, in apply_func\r\n1679    return f(**kwargs)\r\n1680  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 495, in eval_func\r\n1681    return return_func(generator_func)(*args, **kwargs)\r\n1682  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 483, in return_func\r\n1683    results = list(results)\r\n1684  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 414, in generator_func\r\n1685    allkwargs):\r\n1686  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 562, in _process_results\r\n1687    for res in results:\r\n1688  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\distribution\\create_sibling.py\", line 724, in __call__\r\n1689    .format('remote' if ssh_sibling else 'local'))\r\n1690datalad.support.exceptions.MissingExternalDependency: git-annex is missing. It's required on the remote machine to create a sibling\r\n\r\n======================================================================\r\n1707ERROR: datalad.distribution.tests.test_publish.test_since_empty_and_unsupported\r\n1708----------------------------------------------------------------------\r\n1709Traceback (most recent call last):\r\n1710  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\nose\\case.py\", line 198, in runTest\r\n1711    self.test(*self.arg)\r\n1712  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1713    return t(*(arg + (filename,)), **kw)\r\n1714  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\contextlib.py\", line 77, in __exit__\r\n1715    self.gen.throw(type, value, traceback)\r\n1716  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\utils.py\", line 1802, in make_tempfile\r\n1717    yield filename\r\n1718  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1719    return t(*(arg + (filename,)), **kw)\r\n1720  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1721    return t(*(arg + (filename,)), **kw)\r\n1722  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\contextlib.py\", line 77, in __exit__\r\n1723    self.gen.throw(type, value, traceback)\r\n1724  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\utils.py\", line 1802, in make_tempfile\r\n1725    yield filename\r\n1726  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\tests\\utils.py\", line 750, in _wrap_with_tempfile\r\n1727    return t(*(arg + (filename,)), **kw)\r\n1728  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\distribution\\tests\\test_publish.py\", line 104, in test_since_empty_and_unsupported\r\n1729    source.create_sibling(p2, name='target1')\r\n1730  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\distribution\\dataset.py\", line 503, in apply_func\r\n1731    return f(**kwargs)\r\n1732  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 495, in eval_func\r\n1733    return return_func(generator_func)(*args, **kwargs)\r\n1734  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 483, in return_func\r\n1735    results = list(results)\r\n1736  File \"C:\\Miniconda35\\envs\\test-environment\\lib\\site-packages\\datalad\\interface\\utils.py\", line 470, in generator_func\r\n1737    msg=\"Command did not complete successfully\")\r\n1738datalad.support.exceptions.IncompleteResultsError: Command did not complete successfully. 1 failed:\r\n1739[{'action': 'create_sibling',\r\n1740  'message': ('failed to run post-update hook under remote path %s (%s)',\r\n1741              'C:\\\\Users\\\\appveyor\\\\AppData\\\\Local\\\\Temp\\\\1\\\\datalad_temp_i2m294lb',\r\n1742              \"CommandError: 'cd \"\r\n1743              '\"C:\\\\Users\\\\appveyor\\\\AppData\\\\Local\\\\Temp\\\\1\\\\datalad_temp_i2m294lb\\\\.git\" '\r\n1744              \"&& ( [ -x hooks/post-update ] && hooks/post-update || : )' \"\r\n1745              \"failed with exitcode 1 [err: '':' is not recognized as an \"\r\n1746              'internal or external command,\\r\\n'\r\n1747              \"operable program or batch file.'] [cmd.py:run:962]\"),\r\n1748  'orig_request': 'C:\\\\Users\\\\appveyor\\\\AppData\\\\Local\\\\Temp\\\\1\\\\datalad_temp_6jwwgzrt',\r\n1749  'path': 'C:\\\\Users\\\\appveyor\\\\AppData\\\\Local\\\\Temp\\\\1\\\\datalad_temp_6jwwgzrt',\r\n1750  'raw_input': True,\r\n1751  'refds': 'C:\\\\Users\\\\appveyor\\\\AppData\\\\Local\\\\Temp\\\\1\\\\datalad_temp_6jwwgzrt',\r\n1752  'status': 'error',\r\n1753  'type': 'dataset'}]\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/5087/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/5087/timeline", "performed_via_github_app": null}