{"url": "https://api.github.com/repos/datalad/datalad/issues/3126", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3126/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3126/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3126/events", "html_url": "https://github.com/datalad/datalad/issues/3126", "id": 402336962, "node_id": "MDU6SXNzdWU0MDIzMzY5NjI=", "number": 3126, "title": "Credentials should be tested before being stored", "user": {"login": "effigies", "id": 83442, "node_id": "MDQ6VXNlcjgzNDQy", "avatar_url": "https://avatars.githubusercontent.com/u/83442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/effigies", "html_url": "https://github.com/effigies", "followers_url": "https://api.github.com/users/effigies/followers", "following_url": "https://api.github.com/users/effigies/following{/other_user}", "gists_url": "https://api.github.com/users/effigies/gists{/gist_id}", "starred_url": "https://api.github.com/users/effigies/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/effigies/subscriptions", "organizations_url": "https://api.github.com/users/effigies/orgs", "repos_url": "https://api.github.com/users/effigies/repos", "events_url": "https://api.github.com/users/effigies/events{/privacy}", "received_events_url": "https://api.github.com/users/effigies/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/datalad/datalad/milestones/64", "html_url": "https://github.com/datalad/datalad/milestone/64", "labels_url": "https://api.github.com/repos/datalad/datalad/milestones/64/labels", "id": 4600374, "node_id": "MDk6TWlsZXN0b25lNDYwMDM3NA==", "number": 64, "title": "Release 0.11.8", "description": "", "creator": {"login": "yarikoptic", "id": 39889, "node_id": "MDQ6VXNlcjM5ODg5", "avatar_url": "https://avatars.githubusercontent.com/u/39889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yarikoptic", "html_url": "https://github.com/yarikoptic", "followers_url": "https://api.github.com/users/yarikoptic/followers", "following_url": "https://api.github.com/users/yarikoptic/following{/other_user}", "gists_url": "https://api.github.com/users/yarikoptic/gists{/gist_id}", "starred_url": "https://api.github.com/users/yarikoptic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yarikoptic/subscriptions", "organizations_url": "https://api.github.com/users/yarikoptic/orgs", "repos_url": "https://api.github.com/users/yarikoptic/repos", "events_url": "https://api.github.com/users/yarikoptic/events{/privacy}", "received_events_url": "https://api.github.com/users/yarikoptic/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 0, "state": "closed", "created_at": "2019-08-25T00:38:04Z", "updated_at": "2020-01-12T11:22:33Z", "due_on": null, "closed_at": "2020-01-12T11:22:33Z"}, "comments": 3, "created_at": "2019-01-23T16:58:11Z", "updated_at": "2021-09-13T15:58:18Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### What is the problem?\r\n\r\nWhen creating a sibling on GitHub for the first time, the username and password provided are stored. If someone has 2FA enabled, then they actually need a token, and not their password. However, the username and password are now stored in a keychain. The default behavior on the next round is not to ask again, but to attempt to reuse the bad credentials.\r\n\r\n#### What steps will reproduce the problem?\r\n\r\nStart from a fresh environment with no stored credentials.\r\n\r\n```Shell\r\n$ datalad create newrepo\r\n$ pushd newrepo\r\n$ datalad create-sibling-github <github-url>\r\nYou need to authenticate with 'github' credentials. https://github.com/login provides information on how to gain access\r\nuser: USERNAME\r\n\r\npassword: \r\npassword (repeat): \r\n[ERROR  ] 401 {'message': 'Must specify two-factor authentication OTP code.', 'documentation_url': 'https://developer.github.com/v3/auth#working-with-two-factor-authentication'} [Requester.py:__check:275] (GithubException)\r\n$ datalad create-sibling-github <github-url>\r\n[ERROR  ] 401 {'message': 'Must specify two-factor authentication OTP code.', 'documentation_url': 'https://developer.github.com/v3/auth#working-with-two-factor-authentication'} [Requester.py:__check:275] (GithubException)\r\n```\r\n\r\n#### What version of DataLad are you using (run `datalad --version`)? On what operating system (consider running `datalad wtf`)?\r\n\r\n```\r\n# WTF\r\n- path: /Users/markiewicz/Projects/crn/fitlins-test-ds000003\r\n- type: dataset\r\n## configuration <SENSITIVE, report disabled by configuration>\r\n## datalad \r\n  - full_version: 0.11.1\r\n  - version: 0.11.1\r\n## dataset \r\n  - metadata: <SENSITIVE, report disabled by configuration>\r\n  - path: /Users/markiewicz/Projects/crn/fitlins-test-ds000003\r\n  - repo: AnnexRepo\r\n## dependencies \r\n  - appdirs: 1.4.3\r\n  - boto: 2.49.0\r\n  - cmd:annex: 7.20181212-g2f8c5bd4c\r\n  - cmd:git: 2.18.0\r\n  - cmd:system-git: 2.19.1\r\n  - cmd:system-ssh: 7.9p1\r\n  - git: 2.1.11\r\n  - gitdb: 2.0.5\r\n  - humanize: 0.5.1\r\n  - iso8601: 0.1.12\r\n  - keyring: 17.0.0\r\n  - keyrings.alt: 3.1.1\r\n  - msgpack: 0.6.0\r\n  - requests: 2.21.0\r\n  - six: 1.12.0\r\n  - tqdm: 4.28.1\r\n  - wrapt: 1.10.11\r\n## environment \r\n  - GIT_PYTHON_GIT_EXECUTABLE: /Applications/git-annex.app/Contents/MacOS/git\r\n  - LANG: en_US.UTF-8\r\n  - LC_CTYPE: en_US.UTF-8\r\n  - PATH: /anaconda3/bin:/anaconda3/condabin:/Applications/freesurfer/bin:/Applications/freesurfer/fsfast/bin:/Applications/freesurfer/tktools:/usr/local/fsl/bin:/Applications/freesurfer/mni/bin:/usr/local/fsl/bin:/Users/markiewicz/bin:/usr/local/bin:/Users/markiewicz/abin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin:/Applications/git-annex.app/Contents/MacOS/\r\n## extentions \r\n## git-annex \r\n  - build flags: \r\n    - Assistant\r\n    - Webapp\r\n    - Pairing\r\n    - S3(multipartupload)(storageclasses)\r\n    - WebDAV\r\n    - FsEvents\r\n    - TorrentParser\r\n    - MagicMime\r\n    - Feeds\r\n    - Testsuite\r\n  - dependency versions: \r\n    - aws-0.20\r\n    - bloomfilter-2.0.1.0\r\n    - cryptonite-0.25\r\n    - DAV-1.3.2\r\n    - feed-1.0.1.0\r\n    - ghc-8.4.4\r\n    - http-client-0.5.13.1\r\n    - persistent-sqlite-2.8.2\r\n    - torrent-10000.1.1\r\n    - uuid-1.3.13\r\n    - yesod-1.6.0\r\n  - key/value backends: \r\n    - SHA256E\r\n    - SHA256\r\n    - SHA512E\r\n    - SHA512\r\n    - SHA224E\r\n    - SHA224\r\n    - SHA384E\r\n    - SHA384\r\n    - SHA3_256E\r\n    - SHA3_256\r\n    - SHA3_512E\r\n    - SHA3_512\r\n    - SHA3_224E\r\n    - SHA3_224\r\n    - SHA3_384E\r\n    - SHA3_384\r\n    - SKEIN256E\r\n    - SKEIN256\r\n    - SKEIN512E\r\n    - SKEIN512\r\n    - BLAKE2B256E\r\n    - BLAKE2B256\r\n    - BLAKE2B512E\r\n    - BLAKE2B512\r\n    - BLAKE2B160E\r\n    - BLAKE2B160\r\n    - BLAKE2B224E\r\n    - BLAKE2B224\r\n    - BLAKE2B384E\r\n    - BLAKE2B384\r\n    - BLAKE2S256E\r\n    - BLAKE2S256\r\n    - BLAKE2S160E\r\n    - BLAKE2S160\r\n    - BLAKE2S224E\r\n    - BLAKE2S224\r\n    - BLAKE2SP256E\r\n    - BLAKE2SP256\r\n    - BLAKE2SP224E\r\n    - BLAKE2SP224\r\n    - SHA1E\r\n    - SHA1\r\n    - MD5E\r\n    - MD5\r\n    - WORM\r\n    - URL\r\n  - local repository version: 5\r\n  - operating system: darwin x86_64\r\n  - remote types: \r\n    - git\r\n    - gcrypt\r\n    - p2p\r\n    - S3\r\n    - bup\r\n    - directory\r\n    - rsync\r\n    - web\r\n    - bittorrent\r\n    - webdav\r\n    - adb\r\n    - tahoe\r\n    - glacier\r\n    - ddar\r\n    - hook\r\n    - external\r\n  - supported repository versions: \r\n    - 5\r\n    - 7\r\n  - upgrade supported from repository versions: \r\n    - 0\r\n    - 1\r\n    - 2\r\n    - 3\r\n    - 4\r\n    - 5\r\n    - 6\r\n  - version: 7.20181212-g2f8c5bd4c\r\n## metadata_extractors \r\n  - annex: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.annex\r\n    - version: None\r\n  - audio: \r\n    - load_error: No module named 'mutagen' [audio.py:<module>:17]\r\n    - module: datalad.metadata.extractors.audio\r\n  - datacite: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datacite\r\n    - version: None\r\n  - datalad_core: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_core\r\n    - version: None\r\n  - datalad_rfc822: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.datalad_rfc822\r\n    - version: None\r\n  - exif: \r\n    - load_error: No module named 'exifread' [exif.py:<module>:16]\r\n    - module: datalad.metadata.extractors.exif\r\n  - frictionless_datapackage: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.frictionless_datapackage\r\n    - version: None\r\n  - image: \r\n    - load_error: None\r\n    - module: datalad.metadata.extractors.image\r\n    - version: None\r\n  - xmp: \r\n    - load_error: No module named 'libxmp' [xmp.py:<module>:20]\r\n    - module: datalad.metadata.extractors.xmp\r\n## system \r\n  - distribution:  10.14.2/x86_64\r\n  - encoding: \r\n    - default: utf-8\r\n    - filesystem: utf-8\r\n    - locale.prefered: UTF-8\r\n  - max_path_length: 308\r\n  - name: Darwin\r\n  - release: 18.2.0\r\n  - type: posix\r\n  - version: Darwin Kernel Version 18.2.0: Mon Nov 12 20:24:46 PST 2018; root:xnu-4903.231.4~2/RELEASE_X86_64\r\n```\r\n\r\n#### Is there anything else that would be useful to know in this context?\r\n\r\nI did figure out how to remove the credentials from my keychain. I just don't think I should have had to.\r\n\r\n#### Have you had any success using DataLad before? (to assess your expertise/prior luck.  We would welcome your testimonial additions to https://github.com/datalad/datalad/wiki/Testimonials as well)\r\n\r\nThis is my first attempt to create a dataset on my own.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3126/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3126/timeline", "performed_via_github_app": null}