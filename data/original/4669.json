{"url": "https://api.github.com/repos/datalad/datalad/issues/4669", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/4669/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/4669/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/4669/events", "html_url": "https://github.com/datalad/datalad/pull/4669", "id": 650119803, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQzNjcyOTc1", "number": 4669, "title": "ENH: addurls: Support reading records from stdin", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-02T18:13:54Z", "updated_at": "2020-07-08T21:24:06Z", "closed_at": "2020-07-08T21:23:55Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/4669", "html_url": "https://github.com/datalad/datalad/pull/4669", "diff_url": "https://github.com/datalad/datalad/pull/4669.diff", "patch_url": "https://github.com/datalad/datalad/pull/4669.patch"}, "body": "URL-FILE can be a csv file or a JSON file with an array of records.\r\nTo allow the user to supply records on stdin, avoiding an intermediate\r\nfile in some cases, read from stdin when URL-FILE is \"-\".\r\n\r\nThere are two main options for the JSON input on stdin: JSON lines or\r\na JSON array.  Go with an array, which has the advantage that it\r\nmatches what addurls expects for a JSON file, which is good for both\r\nuser expectations and not introducing divergent code paths.  It also\r\nmakes it clearer that addurls slurps all the records into memory\r\nrather than working with them as they come in. The disadvantage is the\r\nneed for another intermediate reformatting step, though it's trivial\r\nto reformat JSON lines as an array with jq or similar tools.\r\n\r\nThe --input-type default value is \"ext\", which means to infer the\r\ninput type based on the file extension.  For stdin, we could rework\r\nthings to try json.load() and then fall back to processing the input\r\nas a csv.  But for now, assume that stdin should be treated as JSON by\r\ndefault unless --input-type specifies that it is a csv.\r\n\r\nCloses #3557.\r\n\r\n---\r\n\r\nNote: Using this triggers what I think is a mistake (even if deliberate) in our \"is interactive?\" check: the check says \"no\" when feeding stdin even when output streams are still attached to a tty.  I'll have to look more into the history of that and will open a separate PR if I think we can drop the stdin part from `is_interactive`.", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/4669/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/4669/timeline", "performed_via_github_app": null}