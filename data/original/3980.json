{"url": "https://api.github.com/repos/datalad/datalad/issues/3980", "repository_url": "https://api.github.com/repos/datalad/datalad", "labels_url": "https://api.github.com/repos/datalad/datalad/issues/3980/labels{/name}", "comments_url": "https://api.github.com/repos/datalad/datalad/issues/3980/comments", "events_url": "https://api.github.com/repos/datalad/datalad/issues/3980/events", "html_url": "https://github.com/datalad/datalad/pull/3980", "id": 544648157, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU4NzE0ODg4", "number": 3980, "title": "TST: annexrepo: Ignore racy \"is clean?\" failure", "user": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-02T16:26:09Z", "updated_at": "2020-01-03T00:30:01Z", "closed_at": "2020-01-03T00:28:01Z", "author_association": "MEMBER", "active_lock_reason": null, "pull_request": {"url": "https://api.github.com/repos/datalad/datalad/pulls/3980", "html_url": "https://github.com/datalad/datalad/pull/3980", "diff_url": "https://github.com/datalad/datalad/pull/3980.diff", "patch_url": "https://github.com/datalad/datalad/pull/3980.patch"}, "body": "```\r\nAs of git-annex 7.20191024, test_AnnexRepo_dirty has started to\r\nintermittently fail [0] due to the repository being in an unexpectedly\r\ndirty state, with content that was previously tracked by git converted\r\nto annexed content.  The failure happens due to the combination of two\r\nthings:\r\n\r\n 1) Calling `git -c annex.largefiles=anything annex add -- FILES` can\r\n    in some cases result in git running git-annex's clean filter on\r\n    files that are _not_ part of FILES.  Importantly the clean filter\r\n    runs within the `-c annex.largefiles=anything` context.\r\n\r\n 2) As of 7.20191024, git-annex's clean filter remembers the inode for\r\n    annexed content, leading git-annex to conclude that the regular\r\n    git file in the working tree (file1.txt in this test) should be\r\n    annexed, because the content was tagged as such in 1.\r\n\r\nSee the associated git-annex bug report [1] for a more complete\r\ndescription.\r\n\r\ngit-annex 7.20191230, specifically commit ea3cb7d27, works around this\r\nedge case.  For git-annex versions before this fix but after\r\n7.20191024, skip the test if the \"is clean\" assertion fails.\r\n```\r\n\r\n\\[0]: https://github.com/datalad/datalad/issues/3890#issuecomment-565027169\r\n\\[1]: https://git-annex.branchable.com/bugs/A_case_where_file_tracked_by_git_unexpectedly_becomes_annex_pointer_file/\r\n", "closed_by": {"login": "kyleam", "id": 1297788, "node_id": "MDQ6VXNlcjEyOTc3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1297788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyleam", "html_url": "https://github.com/kyleam", "followers_url": "https://api.github.com/users/kyleam/followers", "following_url": "https://api.github.com/users/kyleam/following{/other_user}", "gists_url": "https://api.github.com/users/kyleam/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyleam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyleam/subscriptions", "organizations_url": "https://api.github.com/users/kyleam/orgs", "repos_url": "https://api.github.com/users/kyleam/repos", "events_url": "https://api.github.com/users/kyleam/events{/privacy}", "received_events_url": "https://api.github.com/users/kyleam/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/datalad/datalad/issues/3980/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/datalad/datalad/issues/3980/timeline", "performed_via_github_app": null}